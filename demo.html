<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>

<script>
    // (1)如果目标对象有toJSON方法，那么这个方法负责哪些数据将被序列化
    // 下面toJSON方法中直接返回一个字符串也是可以的
    let obj1 = {
        x: 1,
        y: 2,
        z: 3,
        toJSON: function () {
            return {
                "x": this.x,
                "Z": this.z
            }
        }
    }
    console.log("(1) ", JSON.stringify(obj1)) // (1)  {"x":1,"Z":3}

    // (2) undefined、Function、Symbol不是有效的JSON值，在转换过程中将会被忽略（存在于对象中），或者被设置为null（存在于数组中）
    let obj21 = {
        x: 1,
        y: undefined,
        z: function () {
            return "hello world!"
        },
        m: Symbol("bar")
    }
    let obj22 = [1, undefined, Symbol("foo"), function () {
    }]

    console.log("(2) ", JSON.stringify(obj21))  // (2)  {"x":1}
    console.log("(2) ", JSON.stringify(obj22))  // (2)  [1,null,null,null]

    // (3) 对于undefined的值，如果我们想让他解析为空字符串，那么可以这么做
    let obj31 = [{
        k: 1,
        v: undefined
    }]
    let obj32 = obj31.map((item) => {
        const v = typeof item.v === 'undefined' ? '' : item.v;
        return {...item, v}
    })
    console.log("(3) ", JSON.stringify(obj31))  // (3)  [{"k":1}]
    console.log("(3) ", JSON.stringify(obj32))  // (3)  [{"k":1,"v":""}]

    let obj33 = {k: 2, v: undefined}
    let obj34 = {}
    for (const [k, v] of Object.entries(obj33)) {
        obj34[k] = typeof v === 'undefined' ? '' : v
    }
    console.log("(3) ", JSON.stringify(obj33))  // (3)  {"k":2}
    console.log("(3) ", JSON.stringify(obj34))  // (3)  {"k":2,"v":""}
</script>


</body>
</html>