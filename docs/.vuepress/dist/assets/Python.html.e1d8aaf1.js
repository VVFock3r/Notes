import{_ as o,r as e,o as c,c as l,d as n,a as t,e as s,b as p}from"./app.8347a01d.js";const u={},i=n("h2",{id:"\u4E00\u3001python\u89E3\u91CA\u5668",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#\u4E00\u3001python\u89E3\u91CA\u5668","aria-hidden":"true"},"#"),s(" \u4E00\u3001Python\u89E3\u91CA\u5668")],-1),k=s("\u5B98\u65B9\u6587\u6863\uFF1A"),r={href:"https://docs.python.org/zh-cn/3.9/tutorial/interpreter.html",target:"_blank",rel:"noopener noreferrer"},d=s("https://docs.python.org/zh-cn/3.9/tutorial/interpreter.html"),m=n("h3",{id:"\u89E3\u91CA\u5668\u7684\u591A\u79CD\u5B9E\u73B0",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#\u89E3\u91CA\u5668\u7684\u591A\u79CD\u5B9E\u73B0","aria-hidden":"true"},"#"),s(" \u89E3\u91CA\u5668\u7684\u591A\u79CD\u5B9E\u73B0")],-1),g=s("\u5B98\u65B9\u6587\u6863\uFF1A"),h={href:"https://docs.python.org/zh-cn/3.9/reference/introduction.html#implementations",target:"_blank",rel:"noopener noreferrer"},y=s("https://docs.python.org/zh-cn/3.9/reference/introduction.html#implementations"),_=n("p",null,"CPython",-1),b=n("p",null,"\u8FD9\u662F\u6700\u65E9\u51FA\u73B0\u5E76\u6301\u7EED\u7EF4\u62A4\u7684 Python \u5B9E\u73B0\uFF0C\u4EE5 C \u8BED\u8A00\u7F16\u5199\u3002\u65B0\u7684\u8BED\u8A00\u7279\u6027\u901A\u5E38\u5728\u6B64\u7387\u5148\u6DFB\u52A0\u3002",-1),f=n("p",null,"\u5E73\u5E38\u4F7F\u7528\u7684\u5C31\u662FCPython",-1),w=n("p",null,"Jython",-1),q=s("\u4EE5 Java \u8BED\u8A00\u7F16\u5199\u7684 Python \u5B9E\u73B0\u3002\u6B64\u5B9E\u73B0\u53EF\u4EE5\u4F5C\u4E3A Java \u5E94\u7528\u7684\u4E00\u4E2A\u811A\u672C\u8BED\u8A00\uFF0C\u6216\u8005\u53EF\u4EE5\u7528\u6765\u521B\u5EFA\u9700\u8981 Java \u7C7B\u5E93\u652F\u6301\u7684\u5E94\u7528\u3002\u60F3\u4E86\u89E3\u66F4\u591A\u4FE1\u606F\u53EF\u8BBF\u95EE "),x={href:"http://www.jython.org/",target:"_blank",rel:"noopener noreferrer"},v=s("Jython \u7F51\u7AD9"),T=n("p",null,"Python for .NET",-1),C=s("\u6B64\u5B9E\u73B0\u5B9E\u9645\u4E0A\u4F7F\u7528\u4E86 CPython \u5B9E\u73B0\uFF0C\u4F46\u662F\u5C5E\u4E8E .NET \u6258\u7BA1\u5E94\u7528\u5E76\u4E14\u53EF\u4EE5\u5F15\u5165 .NET \u7C7B\u5E93\u3002\u5B83\u7684\u521B\u9020\u8005\u662F Brian Lloyd\u3002\u60F3\u4E86\u89E3\u8BE6\u60C5\u53EF\u8BBF\u95EE "),P={href:"https://pythonnet.github.io/",target:"_blank",rel:"noopener noreferrer"},F=s("Python for .NET \u4E3B\u9875"),N=n("p",null,"IronPython",-1),E=s("\u53E6\u4E00\u4E2A .NET \u7684 Python \u5B9E\u73B0\uFF0C\u4E0E Python.NET \u4E0D\u540C\u70B9\u5728\u4E8E\u5B83\u662F\u751F\u6210 IL \u7684\u5B8C\u5168 Python \u5B9E\u73B0\uFF0C\u5E76\u4E14\u5C06 Python \u4EE3\u7801\u76F4\u63A5\u7F16\u8BD1\u4E3A .NET \u7A0B\u5E8F\u96C6\u3002\u5B83\u7684\u521B\u9020\u8005\u5C31\u662F\u5F53\u521D\u521B\u9020 Jython \u7684 Jim Hugunin\u3002\u60F3\u4E86\u89E3\u8BE6\u60C5\u53EF\u8BBF\u95EE "),A={href:"http://ironpython.net/",target:"_blank",rel:"noopener noreferrer"},M=s("IronPython \u7F51\u7AD9"),O=n("p",null,"PyPy",-1),j=s("\u5B8C\u5168\u4F7F\u7528 Python \u8BED\u8A00\u7F16\u5199\u7684 Python \u5B9E\u73B0\u3002\u5B83\u652F\u6301\u591A\u4E2A\u5176\u4ED6\u5B9E\u73B0\u6240\u6CA1\u6709\u7684\u9AD8\u7EA7\u7279\u6027\uFF0C\u4F8B\u5982\u975E\u6808\u5F0F\u652F\u6301\u548C JIT \u7F16\u8BD1\u5668\u7B49\u3002\u6B64\u9879\u76EE\u7684\u76EE\u6807\u4E4B\u4E00\u662F\u901A\u8FC7\u5141\u8BB8\u65B9\u4FBF\u5730\u4FEE\u6539\u89E3\u91CA\u5668 (\u56E0\u4E3A\u5B83\u662F\u7528 Python \u7F16\u5199\u7684)\uFF0C\u9F13\u52B1\u8BE5\u5BF9\u8BED\u8A00\u672C\u8EAB\u8FDB\u884C\u8BD5\u9A8C\u3002\u60F3\u4E86\u89E3\u8BE6\u60C5\u53EF\u8BBF\u95EE "),R={href:"http://pypy.org/",target:"_blank",rel:"noopener noreferrer"},z=s("PyPy \u9879\u76EE\u4E3B\u9875"),I=n("p",null,"\u603B\u7ED3",-1),S=n("thead",null,[n("tr",null,[n("th",null,"\u5B9E\u73B0\u8BED\u8A00"),n("th",null,"\u89E3\u91CA\u5668\u540D\u79F0"),n("th",null,"\u5B98\u7F51"),n("th",null,"\u5907\u6CE8")])],-1),B=n("td",null,"C",-1),L=n("td",null,"CPython",-1),D={href:"https://www.python.org/",target:"_blank",rel:"noopener noreferrer"},U=s("https://www.python.org/"),V=n("td",null,"\u5B98\u65B9\u5B9E\u73B0",-1),W=n("td",null,"Python",-1),H=n("td",null,"PyPy",-1),J={href:"https://www.pypy.org/",target:"_blank",rel:"noopener noreferrer"},G=s("https://www.pypy.org/"),Y=n("td",null,"Python\u5B9E\u73B0",-1),K=n("td",null,"Java",-1),Q=n("td",null,"Jython",-1),$={href:"https://www.jython.org/",target:"_blank",rel:"noopener noreferrer"},Z=s("https://www.jython.org/"),X=n("td",null,"Java\u5B9E\u73B0",-1),nn=n("td",null,".Net",-1),sn=n("td",null,"Python for .NET\u548CIronPython",-1),an={href:"https://pythonnet.github.io/",target:"_blank",rel:"noopener noreferrer"},tn=s("https://pythonnet.github.io/"),pn=n("br",null,null,-1),on={href:"https://ironpython.net/",target:"_blank",rel:"noopener noreferrer"},en=s("https://ironpython.net/"),cn=n("td",null,".Net\u76F8\u5173\uFF0C\u4F46\u662F\u5E76\u975E\u5B8C\u5168\u7531.Net\u5B9E\u73B0",-1),ln=n("h3",{id:"\u589E\u5F3A\u7248\u4EA4\u4E92\u5F0F\u89E3\u91CA\u5668-repl",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#\u589E\u5F3A\u7248\u4EA4\u4E92\u5F0F\u89E3\u91CA\u5668-repl","aria-hidden":"true"},"#"),s(" \u589E\u5F3A\u7248\u4EA4\u4E92\u5F0F\u89E3\u91CA\u5668\uFF08REPL\uFF09")],-1),un=n("h4",{id:"ipython",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#ipython","aria-hidden":"true"},"#"),s(" IPython")],-1),kn=s("\u5B98\u7F51\u5730\u5740\uFF1A"),rn={href:"https://ipython.org/",target:"_blank",rel:"noopener noreferrer"},dn=s("https://ipython.org/"),mn=p(`<div class="language-bash ext-sh"><pre class="language-bash"><code><span class="token comment"># \u5B89\u88C5</span>
pip <span class="token function">install</span> ipython

<span class="token comment"># \u542F\u52A8</span>
ipython
</code></pre></div><h4 id="jupyter-notebook" tabindex="-1"><a class="header-anchor" href="#jupyter-notebook" aria-hidden="true">#</a> Jupyter Notebook</h4>`,2),gn=s("\u5B98\u7F51\u5730\u5740\uFF1A"),hn={href:"https://jupyter.org/",target:"_blank",rel:"noopener noreferrer"},yn=s("https://jupyter.org/"),_n=p(`<p>\u5B89\u88C5</p><div class="language-bash ext-sh"><pre class="language-bash"><code><span class="token comment"># \u5B89\u88C5 </span>
pip <span class="token function">install</span> jupyter

<span class="token comment"># \u8BBE\u7F6E\u5BC6\u7801(\u53EF\u9009)</span>
jupyter notebook password

<span class="token comment"># \u542F\u52A8</span>
<span class="token comment"># \u6CE8\u610F\uFF1A--notebook-dir \u6307\u5B9A\u6587\u4EF6\u76EE\u5F55\uFF0C\u9700\u63D0\u524D\u521B\u5EFA\uFF1B--allow-root \u5141\u8BB8root\u7528\u6237\u8FD0\u884C\u6B64\u547D\u4EE4\uFF0C\u9ED8\u8BA4\u4E0D\u5141\u8BB8</span>
jupyter notebook --ip<span class="token operator">=</span><span class="token number">127.0</span>.0.1 --port <span class="token number">8888</span> --notebook-dir<span class="token operator">=</span>%USERPROFILE%/Desktop/jupyter  --allow-root
</code></pre></div><p>\u5FEB\u6377\u952E</p><table><thead><tr><th>\u5FEB\u6377\u952E</th><th>\u8BF4\u660E</th></tr></thead><tbody><tr><td>Enter</td><td>\u8FDB\u5165\u7F16\u8F91\u6A21\u5F0F</td></tr><tr><td>Ctrl + Enter</td><td>\u6267\u884C\u8BED\u53E5\uFF0C\u5E76\u4FDD\u6301\u5728\u5F53\u524DCell\uFF08\u884C\uFF09</td></tr><tr><td>Shift + Enter</td><td>\u6267\u884C\u8BED\u53E5\uFF0C\u5E76\u8FDB\u5165\u4E0B\u4E00\u4E2ACell\uFF08\u884C\uFF09</td></tr><tr><td>\u2191\u2193</td><td>\u4E0A/\u4E0B\u4E00\u4E2ACell\uFF08\u884C\uFF09</td></tr></tbody></table><h3 id="\u7248\u672C\u7BA1\u7406" tabindex="-1"><a class="header-anchor" href="#\u7248\u672C\u7BA1\u7406" aria-hidden="true">#</a> \u7248\u672C\u7BA1\u7406</h3><p>\u4E3B\u8981\u7528\u6765\u518D\u4E0D\u6539\u52A8\u4EE3\u7801\u7684\u60C5\u51B5\u4E0B\uFF0C\u65B9\u4FBF\u4E0D\u540CPython\u7248\u672C\u4E4B\u95F4\u7684\u5207\u6362</p><p>####\u3000Pyenv</p>`,7),bn=s("Pyenv\uFF08\u975EWindows\u7248\u672C\uFF09\u9879\u76EE\u5730\u5740\uFF1A"),fn={href:"https://github.com/pyenv/pyenv",target:"_blank",rel:"noopener noreferrer"},wn=s("https://github.com/pyenv/pyenv"),qn=s("Pyenv-Win(Windows\u7248\u672C) \u9879\u76EE\u5730\u5740\uFF1A"),xn={href:"https://github.com/pyenv-win/pyenv-win",target:"_blank",rel:"noopener noreferrer"},vn=s("https://github.com/pyenv-win/pyenv-win"),Tn=p(`<p>Pyenv\u5B89\u88C5</p><div class="language-bash ext-sh"><pre class="language-bash"><code><span class="token comment"># windows cmd\u547D\u4EE4\u884C\u5B89\u88C5</span>
<span class="token number">1</span>.cmd\u6267\u884C
pip <span class="token function">install</span> pyenv-win --target %USERPROFILE%<span class="token punctuation">\\</span>.pyenv  <span class="token comment"># %USERPROFILE%\u4E3A\u7528\u6237\u914D\u7F6E\u6587\u4EF6\u76EE\u5F55\uFF0C\u4E00\u822C\u60C5\u51B5\u4E0B\u548C\u7528\u6237\u5BB6\u76EE\u5F55\u76F8\u540C</span>

<span class="token number">2</span>.PowerShell\u6267\u884C
<span class="token punctuation">[</span>System.Environment<span class="token punctuation">]</span>::SetEnvironmentVariable<span class="token punctuation">(</span><span class="token string">&#39;PYENV&#39;</span>,<span class="token variable">$env</span>:USERPROFILE + <span class="token string">&quot;\\.pyenv\\pyenv-win<span class="token entity" title="\\&quot;">\\&quot;</span>,&quot;</span>User<span class="token string">&quot;)
[System.Environment]::SetEnvironmentVariable(&#39;PYENV_HOME&#39;,<span class="token variable">$env</span>:USERPROFILE + &quot;</span><span class="token punctuation">\\</span>.pyenv<span class="token punctuation">\\</span>pyenv-win<span class="token punctuation">\\</span>&quot;,<span class="token string">&quot;User&quot;</span><span class="token punctuation">)</span>

<span class="token number">3</span>.PowerShell\u6267\u884C
<span class="token punctuation">[</span>System.Environment<span class="token punctuation">]</span>::SetEnvironmentVariable<span class="token punctuation">(</span><span class="token string">&#39;path&#39;</span>, <span class="token environment constant">$HOME</span> + <span class="token string">&quot;\\.pyenv\\pyenv-win<span class="token entity" title="\\b">\\b</span>in;&quot;</span> + <span class="token environment constant">$HOME</span> + <span class="token string">&quot;\\.pyenv\\pyenv-win\\shims;&quot;</span> + <span class="token variable">$env</span>:Path,<span class="token string">&quot;User&quot;</span><span class="token punctuation">)</span>

<span class="token number">4</span>.\u68C0\u67E5\u662F\u5426\u5B89\u88C5\u6210\u529F
C:<span class="token punctuation">\\</span>Users<span class="token punctuation">\\</span>VVFock3r<span class="token operator">&gt;</span>pyenv --version
pyenv <span class="token number">2.64</span>.3
</code></pre></div><p>Pyenv\u547D\u4EE4</p><div class="language-bash ext-sh"><pre class="language-bash"><code><span class="token comment"># \u67E5\u770B\u6240\u6709\u53EF\u5B89\u88C5\u7248\u672C</span>
pyenv <span class="token function">install</span> --list

<span class="token comment"># \u67E5\u770B\u5F53\u524D\u7248\u672C </span>
<span class="token comment"># \u6CE8\uFF1A</span>
<span class="token comment"># 	linux\u8FD9\u91CC\u4F1A\u663E\u793Asystem\uFF0C\u65B9\u4FBF\u4EE5\u540E\u6211\u4EEC\u5207\u4E86\u7248\u672C\u4E4B\u540E\u60F3\u8981\u518D\u5207\u56DE\u6765</span>
<span class="token comment">#	windows\u4E0D\u77E5\u9053\u662F\u4E0D\u662Fbug\uFF0C\u8FD9\u91CC\u4EC0\u4E48\u4E5F\u4E0D\u663E\u793A\uFF0C\u8FD9\u6837\u5F53\u6211\u4EEC\u4EE5\u540E\u60F3\u5207\u56DE\u7CFB\u7EDF\u7248\u672C\u5C31\u5F88\u4E0D\u597D\u5F04\u4E86</span>
<span class="token comment">#	\u4E34\u65F6\u89E3\u51B3\u529E\u6CD5\u5C31\u662F\uFF1A\u7528\u5B8C\u4E86\u5C31\u5378\u8F7D\u6307\u5B9A\u7248\u672C</span>
pyenv version

<span class="token comment"># \u5B89\u88C5\u6307\u5B9A\u7248\u672C</span>
<span class="token comment"># \u6CE8\uFF1A</span>
<span class="token comment">#	(1) \u5E26-win32\u7684\u4E3A32\u4F4D\u7248\u672C\uFF0C\u4E0D\u5E26\u7684\u4E3A64\u4F4D\u7248\u672C </span>
<span class="token comment">#	(2) \u5982\u679C\u4E0B\u8F7D\u6162\uFF0C\u7528\u8FC5\u96F7\u4E0B\u8F7D\uFF0C\u7136\u540E\u653E\u5230\u6307\u5B9A\u76EE\u5F55\uFF0C\u5B89\u88C5\u65F6\u5404\u76EE\u5F55\u90FD\u6709\u8BF4\u660E</span>
<span class="token comment">#	(3) \u5B89\u88C5\u8FC7\u7A0B\u8F83\u6162\uFF0C\u8BF7\u8010\u5FC3\u7B49\u5F85</span>
C:<span class="token punctuation">\\</span>Users<span class="token punctuation">\\</span>VVFock3r<span class="token operator">&gt;</span>pyenv <span class="token function">install</span> <span class="token number">3.9</span>.0a4
:: <span class="token punctuation">[</span>Info<span class="token punctuation">]</span> ::  Mirror: https://www.python.org/ftp/python
:: <span class="token punctuation">[</span>Downloading<span class="token punctuation">]</span> ::  <span class="token number">3.9</span>.0a4 <span class="token punctuation">..</span>.
:: <span class="token punctuation">[</span>Downloading<span class="token punctuation">]</span> ::  From https://www.python.org/ftp/python/3.9.0/python-3.9.0a4-amd64-webinstall.exe
:: <span class="token punctuation">[</span>Downloading<span class="token punctuation">]</span> ::  To   C:<span class="token punctuation">\\</span>Users<span class="token punctuation">\\</span>VVFock3r<span class="token punctuation">\\</span>.pyenv<span class="token punctuation">\\</span>pyenv-win<span class="token punctuation">\\</span>install_cache<span class="token punctuation">\\</span>python-3.9.0a4-amd64-webinstall.exe
^CTerminate batch job <span class="token punctuation">(</span>Y/N<span class="token punctuation">)</span>? y

C:<span class="token punctuation">\\</span>Users<span class="token punctuation">\\</span>VVFock3r<span class="token operator">&gt;</span>pyenv <span class="token function">install</span> <span class="token number">3.9</span>.0a4
:: <span class="token punctuation">[</span>Info<span class="token punctuation">]</span> ::  Mirror: https://www.python.org/ftp/python
:: <span class="token punctuation">[</span>Installing<span class="token punctuation">]</span> ::  <span class="token number">3.9</span>.0a4 <span class="token punctuation">..</span>.


<span class="token comment"># \u5207\u6362\u5230\u6307\u5B9A\u7248\u672C</span>
pyenv global <span class="token number">3.9</span>.0a4	<span class="token comment"># \u5168\u5C40python\u89E3\u91CA\u5668\u5207\u6362</span>
pyenv <span class="token builtin class-name">local</span>  <span class="token number">3.9</span>.0a4	<span class="token comment"># \u5F53\u524D\u76EE\u5F55\u53CA\u5B50\u76EE\u5F55\u4E0B\u7684python\u89E3\u91CA\u5668\u5207\u6362</span>

<span class="token comment"># \u67E5\u770B\u6240\u6709\u5DF2\u5B89\u88C5\u7248\u672C</span>
pyenv versions

<span class="token comment"># \u5378\u8F7D\u6307\u5B9A\u7248\u672C </span>
pyenv uninstall <span class="token number">3.9</span>.0a4
</code></pre></div><h3 id="\u5168\u5C40\u89E3\u91CA\u5668\u9501gil" tabindex="-1"><a class="header-anchor" href="#\u5168\u5C40\u89E3\u91CA\u5668\u9501gil" aria-hidden="true">#</a> \u5168\u5C40\u89E3\u91CA\u5668\u9501GIL</h3><h4 id="gil\u662F\u4EC0\u4E48" tabindex="-1"><a class="header-anchor" href="#gil\u662F\u4EC0\u4E48" aria-hidden="true">#</a> GIL\u662F\u4EC0\u4E48\uFF1F</h4><p>GIL\uFF0C\u5168\u79F0\u4E3AGlobal Interpreter Lock\uFF0C\u4E2D\u6587\u7FFB\u8BD1\u4E3A\u5168\u5C40\u89E3\u91CA\u5668\u9501\uFF0C\u5C5E\u4E8E\u4E92\u65A5\u9501\uFF0C</p><p>\u7B80\u5355\u6765\u8BF4\u5C31\u662F\u7ED9Python\u89E3\u91CA\u5668\u4E0A\u4E86\u4E00\u628A\u9501\uFF0C\u540C\u4E00\u65F6\u523B\u53EA\u5141\u8BB8\u540C\u65F6\u4E00\u4E2A\u7EBF\u7A0B\u6267\u884C\u4EE3\u7801\uFF0C\u540C\u4E00\u65F6\u523B\u53EA\u80FD\u5229\u7528\u5355\u6838CPU\uFF0C</p><p>\u8FD9\u5C31\u5BFC\u81F4Python\u7684\u591A\u7EBF\u7A0B\u5E76\u975E\u662F\u771F\u6B63\u7684\u591A\u7EBF\u7A0B</p><h4 id="gil\u7684\u4F18\u70B9" tabindex="-1"><a class="header-anchor" href="#gil\u7684\u4F18\u70B9" aria-hidden="true">#</a> GIL\u7684\u4F18\u70B9</h4><p>CPython\u4F7F\u7528\u5F15\u7528\u8BA1\u6570\u4F5C\u4E3A\u5783\u573E\u56DE\u6536\u5668\u7684\u5185\u5B58\u7BA1\u7406\u6280\u672F\uFF0C\u5DE5\u4F5C\u539F\u7406\u5982\u4E0B\uFF1A</p><p>1.\u6BCF\u4E2A\u5BF9\u8C61\u90FD\u6709\u4E00\u4E2A\u5F15\u7528\u8BA1\u6570\uFF0C</p><p>2.\u5F53\u5BF9\u8C61\u88AB\u8D4B\u7ED9\u4E00\u4E2A\u65B0\u7684\u53D8\u91CF\u540D\u6216\u88AB\u6DFB\u52A0\u5230\u4E00\u4E2A\u5BB9\u5668(\u5982\u5143\u7EC4\u3001\u5217\u8868\u7B49)\u65F6\uFF0C\u5F15\u7528\u8BA1\u6570\u4F1A\u589E\u52A0\uFF0C</p><p>\u200B \u540C\u6837\uFF0C\u5F53\u5F15\u7528\u8D85\u51FA\u8303\u56F4\u6216\u8C03\u7528del\u8BED\u53E5\u65F6\uFF0C\u5F15\u7528\u8BA1\u6570\u4E5F\u4F1A\u51CF\u5C11</p><p>3.\u5F53\u4E00\u4E2A\u5BF9\u8C61\u7684\u5F15\u7528\u8BA1\u6570\u8FBE\u52300\u65F6\uFF0C\u5B83\u5C06\u88AB\u5783\u573E\u56DE\u6536\uFF0C\u5206\u914D\u7684\u5185\u5B58\u5C06\u88AB\u91CA\u653E</p><p>\u5728\u591A\u7EBF\u7A0B\u4E0B\u5F15\u7528\u8BA1\u6570\u53D8\u91CF\u9700\u8981\u88AB\u4FDD\u62A4\uFF08\u56E0\u4E3A\u8D4B\u503C\u7B49\u64CD\u4F5C\u662F\u975E\u539F\u5B50\u7684\uFF09\uFF0C\u6B64\u65F6\u6709\u4E24\u79CD\u89E3\u51B3\u529E\u6CD5\uFF1A</p><p>\uFF081\uFF09\u7ED9\u6BCF\u4E2A\u5BF9\u8C61\u6DFB\u52A0\u4E00\u4E2A\u9501\uFF0C\u8FD9\u53EF\u80FD \u589E\u52A0\u6B7B\u9501\u7684\u53EF\u80FD\u6027\uFF0C\u5E76\u4E14\u6027\u80FD\u5F00\u9500\u8F83\u5927</p><p>\uFF082\uFF09\u6DFB\u52A0\u5168\u5C40\u89E3\u91CA\u5668\u9501\uFF0C\u53EA\u6709\u4E00\u628A\u9501\uFF0C\u7BA1\u7406\u7B80\u5355\uFF0C\u4E14\u5F00\u9500\u8F83\u5C0F</p><h4 id="gil\u7684\u7F3A\u70B9" tabindex="-1"><a class="header-anchor" href="#gil\u7684\u7F3A\u70B9" aria-hidden="true">#</a> GIL\u7684\u7F3A\u70B9</h4><p>GIL\u5BFC\u81F4Python\u65E0\u6CD5\u771F\u6B63\u7684\u4F7F\u7528\u591A\u6838CPU\u8D44\u6E90\uFF0C\u65E0\u6CD5\u771F\u6B63\u5E76\u884C</p><p>\u603B\u7ED3</p><p>CPU\u5BC6\u96C6\u578B\u4EFB\u52A1\u4E0D\u9002\u5408\u591A\u7EBF\u7A0B\uFF0C\u76F8\u6BD4\u5355\u7EBF\u7A0B\u53CD\u800C\u4F1A\u964D\u4F4E\u6548\u7387\uFF0C\u6B64\u65F6\u53EF\u4EE5\u4F7F\u7528\u591A\u8FDB\u7A0B\u4EE3\u66FF</p><p>IO\u5BC6\u96C6\u578B\u4EFB\u52A1\u53EF\u4EE5\u4F7F\u7528\u591A\u7EBF\u7A0B</p><p>\u53C2\u8003\u8D44\u6599</p>`,24),Cn=s("\u5B98\u65B9Wiki\uFF1A"),Pn={href:"https://wiki.python.org/moin/GlobalInterpreterLock",target:"_blank",rel:"noopener noreferrer"},Fn=s("https://wiki.python.org/moin/GlobalInterpreterLock"),Nn=n("h3",{id:"\u5E38\u7528\u9009\u9879\u53CA\u73AF\u5883\u53D8\u91CF",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#\u5E38\u7528\u9009\u9879\u53CA\u73AF\u5883\u53D8\u91CF","aria-hidden":"true"},"#"),s(" \u5E38\u7528\u9009\u9879\u53CA\u73AF\u5883\u53D8\u91CF")],-1),En=s("\u5B98\u65B9\u6587\u6863\uFF1A"),An={href:"https://docs.python.org/zh-cn/3.9/using/cmdline.html#using-on-general",target:"_blank",rel:"noopener noreferrer"},Mn=s("https://docs.python.org/zh-cn/3.9/using/cmdline.html#using-on-general"),On=p(`<h4 id="c-command-\u6267\u884Cpython\u4EE3\u7801" tabindex="-1"><a class="header-anchor" href="#c-command-\u6267\u884Cpython\u4EE3\u7801" aria-hidden="true">#</a> -c &lt;command&gt; \u6267\u884CPython\u4EE3\u7801</h4><div class="language-bash ext-sh"><pre class="language-bash"><code>python -c <span class="token string">&quot;import sys;print(&#39;.&#39;.join([str(x) for x in sys.version_info[:3]]))&quot;</span>
<span class="token number">3.9</span>.2
</code></pre></div><h4 id="m-module-name-\u6267\u884C\u6A21\u5757\u4EE3\u7801" tabindex="-1"><a class="header-anchor" href="#m-module-name-\u6267\u884C\u6A21\u5757\u4EE3\u7801" aria-hidden="true">#</a> -m &lt;module-name&gt; \u6267\u884C\u6A21\u5757\u4EE3\u7801</h4><p>\u6267\u884C\u6A21\u5757\u4E2D<code>if __name__ == &#39;__main__&#39;:</code>\u4E0B\u9762\u7684\u5185\u5BB9</p><div class="language-bash ext-sh"><pre class="language-bash"><code><span class="token comment"># \u793A\u4F8B1 - \u5F00\u542Fhttp server</span>
python -m http.server <span class="token number">80</span>
Serving HTTP on :: port <span class="token number">80</span> <span class="token punctuation">(</span>http://<span class="token punctuation">[</span>::<span class="token punctuation">]</span>:80/<span class="token punctuation">)</span> <span class="token punctuation">..</span>.

<span class="token comment"># \u793A\u4F8B2 - \u683C\u5F0F\u5316JSON\u4E32\uFF0C\u975EJSON\u683C\u5F0F\u4F1A\u62A5\u9519</span>
<span class="token builtin class-name">echo</span> <span class="token string">&#39;{&quot;name&quot;:&quot;bob&quot;}&#39;</span> <span class="token operator">|</span> python -m json.tool
<span class="token punctuation">{</span>
    <span class="token string">&quot;name&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;bob&quot;</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="b-\u5728\u5BFC\u5165\u6A21\u5757\u65F6\u4E0D\u751F\u6210-pyc\u6587\u4EF6" tabindex="-1"><a class="header-anchor" href="#b-\u5728\u5BFC\u5165\u6A21\u5757\u65F6\u4E0D\u751F\u6210-pyc\u6587\u4EF6" aria-hidden="true">#</a> -B \u5728\u5BFC\u5165\u6A21\u5757\u65F6\u4E0D\u751F\u6210.pyc\u6587\u4EF6</h4><div class="language-python ext-py"><pre class="language-python"><code><span class="token comment"># pyc_test.py</span>
<span class="token keyword">def</span> <span class="token function">add</span><span class="token punctuation">(</span>x<span class="token punctuation">:</span><span class="token builtin">int</span><span class="token punctuation">,</span> y<span class="token punctuation">:</span><span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">int</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> x <span class="token operator">+</span> y

<span class="token comment"># test.py</span>
<span class="token keyword">import</span> pyc_test

<span class="token comment"># \u6D4B\u8BD5</span>
python    test<span class="token punctuation">.</span>py	<span class="token comment"># \u9ED8\u8BA4\u4F1A\u751F\u6210__pycache__/pyc_test.cpython-39.pyc\u6587\u4EF6</span>
python <span class="token operator">-</span>B test<span class="token punctuation">.</span>py	<span class="token comment"># \u4E0D\u4F1A\u751F\u6210pyc_test.pyc\u6587\u4EF6</span>

<span class="token comment"># \u73AF\u5883\u53D8\u91CF\u53C2\u8003</span>
PYTHONDONTWRITEBYTECODE
\u6B64\u53D8\u91CF\u5982\u679C\u88AB\u8BBE\u4E3A\u4E00\u4E2A\u975E\u7A7A\u5B57\u7B26\u4E32\uFF0CPython \u5C06\u4E0D\u4F1A\u5C1D\u8BD5\u5728\u5BFC\u5165\u6E90\u6A21\u5757\u65F6\u5199\u5165 <span class="token punctuation">.</span>pyc \u6587\u4EF6\u3002 \u8FD9\u76F8\u5F53\u4E8E\u6307\u5B9A <span class="token operator">-</span>B \u9009\u9879\u3002
</code></pre></div><h4 id="u-\u7981\u7528\u7F13\u51B2\u533A" tabindex="-1"><a class="header-anchor" href="#u-\u7981\u7528\u7F13\u51B2\u533A" aria-hidden="true">#</a> -u \u7981\u7528\u7F13\u51B2\u533A</h4><div class="language-python ext-py"><pre class="language-python"><code><span class="token comment"># test.py</span>
<span class="token keyword">import</span> time

<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> end<span class="token operator">=</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span>

<span class="token comment"># \u6D4B\u8BD5-1</span>
python    test<span class="token punctuation">.</span>py	<span class="token comment"># \u8FD9\u5C06\u4E00\u6B21\u6027\u8F93\u51FA\u5185\u5BB9:0123456789</span>
python <span class="token operator">-</span>u test<span class="token punctuation">.</span>py	<span class="token comment"># \u8FD9\u5C06\u5B9E\u65F6\u8F93\u51FA0123456789</span>

<span class="token comment"># \u73AF\u5883\u53D8\u91CF\u53C2\u8003</span>
PYTHONUNBUFFERED
\u6B64\u53D8\u91CF\u5982\u679C\u88AB\u8BBE\u4E3A\u4E00\u4E2A\u975E\u7A7A\u5B57\u7B26\u4E32\uFF0C\u5B83\u5C31\u76F8\u5F53\u4E8E\u6307\u5B9A <span class="token operator">-</span>u \u9009\u9879\u3002

<span class="token comment"># \u603B\u7ED3</span>
\u547D\u4EE4\u884C\u4E2D\u4E00\u822C\u4E3A\u884C\u7F13\u51B2\u533A\uFF0CJenkins\u4E2D\u7ECF\u8FC7\u6D4B\u8BD5\u4E3A\u5168\u7F13\u51B2\u533A\uFF0C\u8981\u8FBE\u5230\u5B9E\u65F6\u8F93\u51FA\uFF0C\u90FD\u53EF\u4EE5\u4F7F\u7528python <span class="token operator">-</span>u\u53C2\u6570\u6765\u8FBE\u5230\u6548\u679C
</code></pre></div><h4 id="w-args-\u8B66\u544A\u63A7\u5236" tabindex="-1"><a class="header-anchor" href="#w-args-\u8B66\u544A\u63A7\u5236" aria-hidden="true">#</a> -w args \u8B66\u544A\u63A7\u5236</h4><div class="language-bash ext-sh"><pre class="language-bash"><code><span class="token comment"># warn_test.py</span>
<span class="token function">import</span> warnings
warnings.warn<span class="token punctuation">(</span><span class="token string">&quot;this is warn message&quot;</span><span class="token punctuation">)</span>

<span class="token comment"># \u6D4B\u8BD5</span>
python warn_test.py				<span class="token comment"># \u8FD9\u4F1A\u8F93\u51FA\u8B66\u544A\u4FE1\u606F</span>
python -Wignore warn_test.py	<span class="token comment"># \u4E0D\u8F93\u51FAwarn\u4FE1\u606F</span>

<span class="token comment"># \u73AF\u5883\u53D8\u91CF\u53C2\u8003 </span>
PYTHONWARNINGS
\u6B64\u53D8\u91CF\u7B49\u4EF7\u4E8E -W \u9009\u9879\u3002 \u5982\u679C\u88AB\u8BBE\u4E3A\u4E00\u4E2A\u4EE5\u9017\u53F7\u5206\u9694\u7684\u5B57\u7B26\u4E32\uFF0C\u5B83\u5C31\u76F8\u5F53\u4E8E\u591A\u6B21\u6307\u5B9A -W\uFF0C\u5217\u8868\u4E2D\u540E\u51FA\u73B0\u7684\u8FC7\u6EE4\u5668\u4F18\u5148\u7EA7\u4F1A\u9AD8\u4E8E\u5217\u8868\u4E2D\u5148\u51FA\u73B0\u7684\u3002

<span class="token comment"># \u8FD8\u53EF\u4EE5\u5728\u4EE3\u7801\u4E2D\u8BBE\u7F6E warnings.filterwarnings(&quot;ignore&quot;)\u6765\u5173\u95ED\u8B66\u544A</span>

\u66F4\u7EC6\u81F4\u7684\u63A7\u5236\u8BF7\u53C2\u8003\u5B98\u65B9\u6587\u6863
</code></pre></div><h4 id="x-\u8DF3\u8FC7\u7B2C\u4E00\u884C\u5185\u5BB9" tabindex="-1"><a class="header-anchor" href="#x-\u8DF3\u8FC7\u7B2C\u4E00\u884C\u5185\u5BB9" aria-hidden="true">#</a> -x \u8DF3\u8FC7\u7B2C\u4E00\u884C\u5185\u5BB9</h4><div class="language-python ext-py"><pre class="language-python"><code><span class="token comment"># test.py</span>
fdafdref3fdfdfdafd
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;hello world!&quot;</span><span class="token punctuation">)</span>

<span class="token comment"># \u6D4B\u8BD5</span>
python    test<span class="token punctuation">.</span>py	<span class="token comment"># \u8FD9\u4F1A\u62A5\u9519</span>
python <span class="token operator">-</span>x test<span class="token punctuation">.</span>py	<span class="token comment"># \u56E0\u4E3A\u8DF3\u8FC7\u7B2C\u4E00\u884C\u4E86\uFF0C\u4E0D\u4F1A\u62A5\u9519</span>
</code></pre></div><h4 id="e-\u5FFD\u7565\u6240\u6709-python-\u73AF\u5883\u53D8\u91CF" tabindex="-1"><a class="header-anchor" href="#e-\u5FFD\u7565\u6240\u6709-python-\u73AF\u5883\u53D8\u91CF" aria-hidden="true">#</a> -E \u5FFD\u7565\u6240\u6709 <code>PYTHON*</code> \u73AF\u5883\u53D8\u91CF</h4><h4 id="q-\u5728\u4EA4\u4E92\u6A21\u5F0F\u4E0B\u4E5F\u4E0D\u663E\u793A\u7248\u6743\u548C\u7248\u672C\u4FE1\u606F" tabindex="-1"><a class="header-anchor" href="#q-\u5728\u4EA4\u4E92\u6A21\u5F0F\u4E0B\u4E5F\u4E0D\u663E\u793A\u7248\u6743\u548C\u7248\u672C\u4FE1\u606F" aria-hidden="true">#</a> -q \u5728\u4EA4\u4E92\u6A21\u5F0F\u4E0B\u4E5F\u4E0D\u663E\u793A\u7248\u6743\u548C\u7248\u672C\u4FE1\u606F</h4><div class="language-bash ext-sh"><pre class="language-bash"><code>C:<span class="token punctuation">\\</span>Users<span class="token punctuation">\\</span>VVFock3r<span class="token operator">&gt;</span>python -q
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> exit<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="" tabindex="-1"><a class="header-anchor" href="#" aria-hidden="true">#</a></h2><h2 id="\u4E8C\u3001\u53D8\u91CF\u548C\u6570\u636E\u7ED3\u6784" tabindex="-1"><a class="header-anchor" href="#\u4E8C\u3001\u53D8\u91CF\u548C\u6570\u636E\u7ED3\u6784" aria-hidden="true">#</a> \u4E8C\u3001\u53D8\u91CF\u548C\u6570\u636E\u7ED3\u6784</h2><h3 id="\u67E5\u770B\u53D8\u91CF" tabindex="-1"><a class="header-anchor" href="#\u67E5\u770B\u53D8\u91CF" aria-hidden="true">#</a> \u67E5\u770B\u53D8\u91CF</h3><table><thead><tr><th>\u5185\u7F6E\u51FD\u6570</th><th>\u8BF4\u660E</th></tr></thead><tbody><tr><td>globals()</td><td>\u8FD4\u56DE\u5168\u5C40\u53D8\u91CF\u7EC4\u6210\u7684\u5B57\u5178</td></tr><tr><td>locals()</td><td>\u8FD4\u56DE\u5F53\u524D\u4F5C\u7528\u57DF\u5185\u53D8\u91CF\u7EC4\u6210\u7684\u5B57\u5178\uFF0C\u5982\u679C\u5F53\u524D\u5728\u5168\u5C40\u5219\u8FD4\u56DE\u5168\u5C40\u53D8\u91CF\u7EC4\u6210\u7684\u5B57\u5178</td></tr><tr><td>vars(obj)</td><td>\u8FD4\u56DEobj\u5BF9\u8C61\u4F5C\u7528\u57DF\u5185\u53D8\u91CF\u7EC4\u6210\u7684\u5B57\u5178\uFF0C<br>\uFF081\uFF09\u5982\u679C\u4E0D\u4F20\u53C2\u6570\uFF0Cvars\u548Clocals\u4F5C\u7528\u4E00\u6837<br>\uFF082\uFF09\u5982\u679C\u4F201\u4E2A\u53C2\u6570\uFF0C\u7B49\u540C\u4E8E<code>obj.__dict__</code></td></tr></tbody></table><p>\u4EE3\u7801\u793A\u4F8B</p><details class="custom-container details"><summary>\u70B9\u51FB\u67E5\u770B\u5B8C\u6574\u4EE3\u7801</summary><div class="language-python ext-py"><pre class="language-python"><code><span class="token comment">#!/usr/bin/env python</span>
<span class="token comment"># -*- coding:utf-8 -*-</span>

<span class="token keyword">import</span> logging

<span class="token comment"># \u521D\u59CB\u5316\u65E5\u5FD7</span>
FORMAT <span class="token operator">=</span> <span class="token string">&#39;%(asctime)-15s\\t [%(threadName)s, %(thread)d] %(message)s&#39;</span>
logging<span class="token punctuation">.</span>basicConfig<span class="token punctuation">(</span><span class="token builtin">format</span><span class="token operator">=</span>FORMAT<span class="token punctuation">)</span>

<span class="token comment"># \u5B9A\u4E49\u5168\u5C40\u53D8\u91CF</span>
x <span class="token operator">=</span> <span class="token number">1</span>

<span class="token comment"># \u6D4B\u8BD51 - \u5168\u5C40\u4F5C\u7528\u57DF</span>
logging<span class="token punctuation">.</span>warning<span class="token punctuation">(</span><span class="token string">&quot;\u6D4B\u8BD51: \u5728\u5168\u5C40\u4F7F\u75283\u4E2A\u51FD\u6570, \u6548\u679C\u662F\u4E00\u6837\u7684&quot;</span><span class="token punctuation">)</span>
logging<span class="token punctuation">.</span>warning<span class="token punctuation">(</span><span class="token builtin">globals</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token builtin">locals</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token builtin">vars</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>


<span class="token comment"># \u6D4B\u8BD52 - \u5C40\u90E8\u4F5C\u7528\u57DF(\u51FD\u6570)</span>
<span class="token keyword">def</span> <span class="token function">test2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    logging<span class="token punctuation">.</span>warning<span class="token punctuation">(</span><span class="token string">&quot;\u6D4B\u8BD52: \u5728\u51FD\u6570\u5185\u90E8, locals()\u548Cvars()\u6548\u679C\u662F\u4E00\u6837\u7684, \u4ED6\u4FE9\u548Cglobal()\u662F\u4E0D\u4E00\u6837\u7684&quot;</span><span class="token punctuation">)</span>
    y <span class="token operator">=</span> <span class="token number">2</span>
    logging<span class="token punctuation">.</span>warning<span class="token punctuation">(</span><span class="token builtin">locals</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token builtin">vars</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    logging<span class="token punctuation">.</span>warning<span class="token punctuation">(</span><span class="token builtin">locals</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token builtin">globals</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>


<span class="token comment"># \u6D4B\u8BD53 - \u5C40\u90E8\u4F5C\u7528\u57DF(\u5BF9\u8C61)</span>
<span class="token keyword">def</span> <span class="token function">test3</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">class</span> <span class="token class-name">MyObj</span><span class="token punctuation">:</span> <span class="token keyword">pass</span>

    logging<span class="token punctuation">.</span>warning<span class="token punctuation">(</span><span class="token string">&quot;\u6D4B\u8BD53: var(obj) == obj.__dict__&quot;</span><span class="token punctuation">)</span>
    logging<span class="token punctuation">.</span>warning<span class="token punctuation">(</span><span class="token builtin">vars</span><span class="token punctuation">(</span>MyObj<span class="token punctuation">)</span> <span class="token operator">==</span> MyObj<span class="token punctuation">.</span>__dict__<span class="token punctuation">)</span>


test2<span class="token punctuation">(</span><span class="token punctuation">)</span>
test3<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div></details><p>\u8F93\u51FA\u7ED3\u679C</p><div class="language-bash ext-sh"><pre class="language-bash"><code><span class="token number">2022</span>-04-05 <span class="token number">10</span>:53:24,984	 <span class="token punctuation">[</span>MainThread, <span class="token number">291696</span><span class="token punctuation">]</span> \u6D4B\u8BD51: \u5728\u5168\u5C40\u4F7F\u75283\u4E2A\u51FD\u6570, \u6548\u679C\u662F\u4E00\u6837\u7684
<span class="token number">2022</span>-04-05 <span class="token number">10</span>:53:24,984	 <span class="token punctuation">[</span>MainThread, <span class="token number">291696</span><span class="token punctuation">]</span> True
<span class="token number">2022</span>-04-05 <span class="token number">10</span>:53:24,984	 <span class="token punctuation">[</span>MainThread, <span class="token number">291696</span><span class="token punctuation">]</span> \u6D4B\u8BD52: \u5728\u51FD\u6570\u5185\u90E8, locals<span class="token punctuation">(</span><span class="token punctuation">)</span>\u548Cvars<span class="token punctuation">(</span><span class="token punctuation">)</span>\u6548\u679C\u662F\u4E00\u6837\u7684, \u4ED6\u4FE9\u548Cglobal<span class="token punctuation">(</span><span class="token punctuation">)</span>\u662F\u4E0D\u4E00\u6837\u7684
<span class="token number">2022</span>-04-05 <span class="token number">10</span>:53:24,984	 <span class="token punctuation">[</span>MainThread, <span class="token number">291696</span><span class="token punctuation">]</span> True
<span class="token number">2022</span>-04-05 <span class="token number">10</span>:53:24,984	 <span class="token punctuation">[</span>MainThread, <span class="token number">291696</span><span class="token punctuation">]</span> False
<span class="token number">2022</span>-04-05 <span class="token number">10</span>:53:24,984	 <span class="token punctuation">[</span>MainThread, <span class="token number">291696</span><span class="token punctuation">]</span> \u6D4B\u8BD53: var<span class="token punctuation">(</span>obj<span class="token punctuation">)</span> <span class="token operator">==</span> obj.__dict__
<span class="token number">2022</span>-04-05 <span class="token number">10</span>:53:24,984	 <span class="token punctuation">[</span>MainThread, <span class="token number">291696</span><span class="token punctuation">]</span> True
</code></pre></div><h3 id="\u5217\u8868-list" tabindex="-1"><a class="header-anchor" href="#\u5217\u8868-list" aria-hidden="true">#</a> \u5217\u8868(list)</h3>`,25),jn=s("\u6587\u6863\uFF1A"),Rn={href:"https://docs.python.org/zh-cn/3/library/stdtypes.html#list",target:"_blank",rel:"noopener noreferrer"},zn=s("https://docs.python.org/zh-cn/3/library/stdtypes.html#list"),In=p(`<p><strong>\u5217\u8868\u63A8\u5BFC\u5F0F</strong></p><div class="language-python ext-py"><pre class="language-python"><code>x <span class="token operator">=</span> <span class="token punctuation">[</span>x <span class="token keyword">for</span> x <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
x <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">{</span><span class="token builtin">chr</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">:</span>x<span class="token punctuation">}</span> <span class="token keyword">for</span> x <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">97</span><span class="token punctuation">,</span> <span class="token number">123</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
x <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>x<span class="token punctuation">:</span>y<span class="token punctuation">}</span> <span class="token keyword">for</span> x <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token keyword">for</span> y <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
</code></pre></div><p><strong>\u5217\u8868\u65B9\u6CD5</strong></p><table><thead><tr><th>\u5206\u7C7B</th><th>\u65B9\u6CD5</th><th>\u8BF4\u660E</th></tr></thead><tbody><tr><td>\u63D2\u5165\u5143\u7D20</td><td><strong><code>append(self, object, /)</code></strong></td><td>\u5728\u5C3E\u90E8\u63D2\u5165\u4E00\u4E2A\u5143\u7D20\uFF0C\u65F6\u95F4\u590D\u6742\u5EA6 O(1)</td></tr><tr><td></td><td><code>insert(self, index, object, /)</code></td><td>\u5728\u6307\u5B9A\u7D22\u5F15\u5904\u63D2\u5165\u4E00\u4E2A\u5143\u7D20\uFF0C\u65F6\u95F4\u590D\u6742\u5EA6 O(n)</td></tr><tr><td></td><td><code>extend(self, list)</code></td><td>\u5217\u8868\u5408\u5E76\uFF08\u4F1A\u6539\u53D8\u539F\u5217\u8868\u5185\u5BB9\uFF09</td></tr><tr><td>\u5220\u9664\u5143\u7D20</td><td><strong><code>pop(self, index=-1, /)</code></strong></td><td>\u9ED8\u8BA4\u4ECE\u7D22\u5F15\u4E3A-1\u7684\u4F4D\u7F6E\u5F39\u51FA\u8BE5\u503C\uFF08\u5F39\u51FA\u540E\u5217\u8868\u5220\u9664\u8BE5\u5143\u7D20\uFF09\uFF0C<br>\u5C3E\u90E8\u5F39\u51FA\u65F6\u95F4\u590D\u6742\u5EA6\u4E3A O(1)\uFF0C\u5176\u4ED6\u4F4D\u7F6E\u5F39\u51FA\u65F6\u95F4\u590D\u6742\u5EA6\u4E3A O(n)\uFF1B<br>\u5982\u679C\u5143\u7D20\u4E0D\u5B58\u5728\uFF0C\u5219\u5F15\u53D1 <code>IndexError</code></td></tr><tr><td></td><td><code>remove(self, value, /)</code></td><td>\u5220\u9664\u7B2C\u4E00\u4E2A\u503C\u4E3Avalue\u7684\u5143\u7D20\uFF0C\u65F6\u95F4\u590D\u6742\u5EA6 O(n) \uFF1B<br>\u5982\u679C\u5143\u7D20\u4E0D\u5B58\u5728\uFF0C\u5219\u5F15\u53D1 ValueError</td></tr><tr><td></td><td><code>clear(self, /)</code></td><td>\u6E05\u7A7A\u5217\u8868\u6240\u6709\u5143\u7D20\uFF0C \u65F6\u95F4\u590D\u6742\u5EA6 O(1)</td></tr><tr><td>\u5217\u8868\u53CD\u8F6C</td><td><code>reverse(self, /)</code></td><td>\u5217\u8868\u53CD\u8F6C\uFF08\u4F1A\u6539\u53D8\u539F\u5217\u8868\u5185\u5BB9\uFF09</td></tr><tr><td></td><td><code>reversed(list)</code></td><td>\u5217\u8868\u53CD\u8F6C\uFF0C\u8FD4\u56DE\u4E00\u4E2A\u8FED\u4EE3\u5668\uFF08\u4E0D\u4F1A\u6539\u53D8\u539F\u5217\u8868\u5185\u5BB9\uFF09</td></tr><tr><td>\u5217\u8868\u6392\u5E8F</td><td><code>sort(self, /, *, key=None, reverse=False)</code></td><td>\u6839\u636Ekey\u6307\u5B9A\u7684\u51FD\u6570\u8FDB\u884C\u6392\u5E8F\uFF0C\u8FD4\u56DE\u503C\u4E3ANone\uFF08\u4F1A\u6539\u53D8\u539F\u5217\u8868\u5185\u5BB9\uFF09</td></tr><tr><td></td><td><code>sorted(iterable, /, *, key=None, reverse=False)</code></td><td>\u6839\u636Ekey\u6307\u5B9A\u7684\u51FD\u6570\u8FDB\u884C\u6392\u5E8F\uFF0C\u8FD4\u56DE\u4E00\u4E2A\u8FED\u4EE3\u5668\uFF08\u4E0D\u4F1A\u6539\u53D8\u539F\u5217\u8868\u5185\u5BB9\uFF09</td></tr><tr><td>\u5217\u8868\u590D\u5236</td><td><code>copy(self, /)</code></td><td>\u8FD4\u56DE\u4E00\u4E2A\u65B0\u5217\u8868\uFF0C\u6D45\u62F7\u8D1D\uFF08shadow copy\uFF09\uFF0C<br>\u6839\u636E\u88AB\u62F7\u8D1D\u5BF9\u8C61\u4E0D\u540C\u800C\u64CD\u4F5C\u4E0D\u540C\uFF1A<br>\uFF081\uFF09\u5982\u679C\u662F\u4E0D\u53EF\u53D8\u7C7B\u578B\uFF0C\u5219\u5206\u914D\u4E00\u5757\u65B0\u5185\u5B58\u5730\u5740\uFF1B<br>\uFF082\uFF09\u5982\u679C\u662F\u53EF\u53D8\u7C7B\u578B\uFF0C\u5219\u76F4\u63A5\u5F15\u7528</td></tr><tr><td></td><td><code>[::]</code></td><td>\u540C<code>copy()</code></td></tr><tr><td></td><td><code>copy.deepcopy(x, memo=None, _nil=[])</code></td><td>\u8FD4\u56DE\u4E00\u4E2A\u65B0\u5217\u8868\uFF0C\u6DF1\u62F7\u8D1D(deep copy)</td></tr><tr><td>\u5217\u8868\u67E5\u627E</td><td><code>index(self, value, start=0, stop=9223372036854775807, /)</code></td><td>\u8FD4\u56DEvalue\u5728\u5217\u8868\u4E2D\u7684\u7D22\u5F15\u53F7\uFF0C\u627E\u4E0D\u5230\u629B\u51FAValueError\u5F02\u5E38</td></tr><tr><td></td><td><code>count(self, value, /)</code></td><td>\u8FD4\u56DEvalue\u5728\u5217\u8868\u4E2D\u51FA\u73B0\u7684\u6B21\u6570</td></tr></tbody></table><p><strong>\u5217\u8868\u5E38\u89C1\u64CD\u4F5C\u6548\u7387\u5BF9\u6BD4</strong></p><details class="custom-container details"><summary>\u70B9\u51FB\u67E5\u770B\u5B8C\u6574\u4EE3\u7801</summary><div class="language-python ext-py"><pre class="language-python"><code><span class="token comment">#!/usr/bin/env python</span>
<span class="token comment"># -*- coding:utf-8 -*-</span>

<span class="token keyword">import</span> timeit
<span class="token keyword">import</span> logging

<span class="token comment"># \u521D\u59CB\u5316\u65E5\u5FD7</span>
FORMAT <span class="token operator">=</span> <span class="token string">&#39;%(asctime)-15s\\t [%(threadName)s, %(thread)d] %(message)s&#39;</span>
logging<span class="token punctuation">.</span>basicConfig<span class="token punctuation">(</span><span class="token builtin">format</span><span class="token operator">=</span>FORMAT<span class="token punctuation">)</span>


<span class="token keyword">def</span> <span class="token function">test1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    logging<span class="token punctuation">.</span>warning<span class="token punctuation">(</span><span class="token string">&quot;[]\u548Clist()\u6548\u7387\u5BF9\u6BD4(\u8FD0\u884C100\u4E07\u6B21\u65F6\u95F4\u603B\u548C)&quot;</span><span class="token punctuation">)</span>
    logging<span class="token punctuation">.</span>warning<span class="token punctuation">(</span><span class="token string">&quot;         []: {}\u79D2&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>timeit<span class="token punctuation">.</span>timeit<span class="token punctuation">(</span>stmt<span class="token operator">=</span><span class="token string">&quot;[]&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    logging<span class="token punctuation">.</span>warning<span class="token punctuation">(</span><span class="token string">&quot;     list(): {}\u79D2&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>timeit<span class="token punctuation">.</span>timeit<span class="token punctuation">(</span>stmt<span class="token operator">=</span><span class="token string">&quot;list()&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>


<span class="token keyword">def</span> <span class="token function">test2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">t1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        x <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">100000</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            x<span class="token punctuation">.</span>append<span class="token punctuation">(</span>i<span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">t2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        x <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">100000</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            x<span class="token punctuation">.</span>insert<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> i<span class="token punctuation">)</span>

    logging<span class="token punctuation">.</span>warning<span class="token punctuation">(</span><span class="token string">&quot;append\u4E0Einsert\u6548\u7387\u5BF9\u6BD4(\u5217\u8868\u63D2\u516510\u4E07\u4E2A\u6570\u636E,\u8FD0\u884C10\u6B21\u7684\u65F6\u95F4\u603B\u548C)&quot;</span><span class="token punctuation">)</span>
    logging<span class="token punctuation">.</span>warning<span class="token punctuation">(</span><span class="token string">&quot;     append: {}\u79D2&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>timeit<span class="token punctuation">.</span>timeit<span class="token punctuation">(</span>stmt<span class="token operator">=</span>t1<span class="token punctuation">,</span> number<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    logging<span class="token punctuation">.</span>warning<span class="token punctuation">(</span><span class="token string">&quot;     insert: {}\u79D2&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>timeit<span class="token punctuation">.</span>timeit<span class="token punctuation">(</span>stmt<span class="token operator">=</span>t2<span class="token punctuation">,</span> number<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>


test1<span class="token punctuation">(</span><span class="token punctuation">)</span>
test2<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div></details><p>\u8F93\u51FA\u7ED3\u679C</p><div class="language-bash ext-sh"><pre class="language-bash"><code><span class="token number">2022</span>-04-05 <span class="token number">11</span>:34:28,170	 <span class="token punctuation">[</span>MainThread, <span class="token number">295460</span><span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>\u548Clist<span class="token punctuation">(</span><span class="token punctuation">)</span>\u6548\u7387\u5BF9\u6BD4<span class="token punctuation">(</span>\u8FD0\u884C100\u4E07\u6B21\u65F6\u95F4\u603B\u548C<span class="token punctuation">)</span>
<span class="token number">2022</span>-04-05 <span class="token number">11</span>:34:28,185	 <span class="token punctuation">[</span>MainThread, <span class="token number">295460</span><span class="token punctuation">]</span>          <span class="token punctuation">[</span><span class="token punctuation">]</span>: <span class="token number">0.0168023</span>\u79D2
<span class="token number">2022</span>-04-05 <span class="token number">11</span>:34:28,248	 <span class="token punctuation">[</span>MainThread, <span class="token number">295460</span><span class="token punctuation">]</span>      list<span class="token punctuation">(</span><span class="token punctuation">)</span>: <span class="token number">0.0661798</span>\u79D2
<span class="token number">2022</span>-04-05 <span class="token number">11</span>:34:28,248	 <span class="token punctuation">[</span>MainThread, <span class="token number">295460</span><span class="token punctuation">]</span> append\u4E0Einsert\u6548\u7387\u5BF9\u6BD4<span class="token punctuation">(</span>\u5217\u8868\u63D2\u516510\u4E07\u4E2A\u6570\u636E,\u8FD0\u884C10\u6B21\u7684\u65F6\u95F4\u603B\u548C<span class="token punctuation">)</span>
<span class="token number">2022</span>-04-05 <span class="token number">11</span>:34:28,310	 <span class="token punctuation">[</span>MainThread, <span class="token number">295460</span><span class="token punctuation">]</span>      append: <span class="token number">0.06255819999999998</span>\u79D2
<span class="token number">2022</span>-04-05 <span class="token number">11</span>:34:47,223	 <span class="token punctuation">[</span>MainThread, <span class="token number">295460</span><span class="token punctuation">]</span>      insert: <span class="token number">18.904270200000003</span>\u79D2
</code></pre></div><h3 id="\u5143\u7EC4-tuple" tabindex="-1"><a class="header-anchor" href="#\u5143\u7EC4-tuple" aria-hidden="true">#</a> \u5143\u7EC4(tuple)</h3>`,9),Sn=s("\u6587\u6863\uFF1A"),Bn={href:"https://docs.python.org/zh-cn/3/library/stdtypes.html#tuple",target:"_blank",rel:"noopener noreferrer"},Ln=s("https://docs.python.org/zh-cn/3/library/stdtypes.html#tuple"),Dn=p(`<p><strong>\u5143\u7956\u65B9\u6CD5</strong></p><table><thead><tr><th>\u5206\u7C7B</th><th>\u65B9\u6CD5</th><th>\u8BF4\u660E</th></tr></thead><tbody><tr><td>\u67E5\u627E</td><td><code>index(value, start=0, stop=9223372036854775807, /)</code></td><td>\u8FD4\u56DEvalue\u5728\u5143\u7EC4\u4E2D\u7B2C\u4E00\u6B21\u51FA\u73B0\u7684\u7D22\u5F15\u53F7\uFF0C\u627E\u4E0D\u5230\u629B\u51FAValueError\u5F02\u5E38</td></tr><tr><td></td><td><code>count(value, /)</code></td><td>\u8FD4\u56DEvalue\u5728\u5143\u7EC4\u4E2D\u51FA\u73B0\u7684\u6B21\u6570</td></tr></tbody></table><p><strong>\u9AD8\u7EA7\u6570\u636E\u7ED3\u6784\uFF1A\u547D\u540D\u5143\u7EC4</strong></p><p>\u547D\u540D\u5143\u7EC4\u51FD\u6570\u7B7E\u540D</p><div class="language-python ext-py"><pre class="language-python"><code>namedtuple<span class="token punctuation">(</span>typename<span class="token punctuation">,</span> field_names<span class="token punctuation">,</span> <span class="token operator">*</span><span class="token punctuation">,</span> rename<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> defaults<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> module<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span>
</code></pre></div><p>\u547D\u540D\u5143\u7EC4\u793A\u4F8B</p><details class="custom-container details"><summary>\u70B9\u51FB\u67E5\u770B\u5B8C\u6574\u4EE3\u7801</summary><div class="language-python ext-py"><pre class="language-python"><code><span class="token comment">#!/usr/bin/env python</span>
<span class="token comment"># -*- coding:utf-8 -*-</span>

<span class="token keyword">from</span> collections <span class="token keyword">import</span> namedtuple


<span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># \u547D\u540D\u5143\u7EC4 - \u57FA\u672C\u4F7F\u7528</span>
    Person <span class="token operator">=</span> namedtuple<span class="token punctuation">(</span><span class="token string">&quot;Person&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;sex&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;age&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    user <span class="token operator">=</span> Person<span class="token punctuation">(</span><span class="token string">&quot;\u5C0F\u660E&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;\u7537&quot;</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;</span><span class="token interpolation"><span class="token punctuation">{</span>user<span class="token punctuation">.</span>name<span class="token punctuation">}</span></span><span class="token string"> | </span><span class="token interpolation"><span class="token punctuation">{</span>user<span class="token punctuation">.</span>sex<span class="token punctuation">}</span></span><span class="token string"> | </span><span class="token interpolation"><span class="token punctuation">{</span>user<span class="token punctuation">.</span>age<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>  <span class="token comment"># \u547D\u540D\u5143\u7EC4\u4F7F\u7528\u65B9\u6CD5</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;</span><span class="token interpolation"><span class="token punctuation">{</span>user<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span><span class="token string"> | </span><span class="token interpolation"><span class="token punctuation">{</span>user<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span><span class="token string"> | </span><span class="token interpolation"><span class="token punctuation">{</span>user<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>  <span class="token comment"># \u4E5F\u53EF\u4EE5\u50CF\u666E\u901A\u5143\u7EC4\u4E00\u6837\u4F7F\u7528</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;</span><span class="token interpolation"><span class="token punctuation">{</span>user<span class="token punctuation">.</span>_fields<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>  <span class="token comment"># \u67E5\u770B\u6240\u6709\u7684\u5C5E\u6027</span>

    <span class="token comment"># \u547D\u540D\u5143\u7EC4 - \u5B89\u5168\u6A21\u5F0F</span>
    <span class="token comment">#   \u5982\u679C\u5C5E\u6027\u4E0Epython\u5173\u952E\u5B57\u65F6(\u6BD4\u5982def)\u91CD\u53E0\u65F6\uFF0C\u4EE3\u7801\u4F1A\u62A5\u9519\uFF0C</span>
    <span class="token comment">#   \u4F7F\u7528rename=True\u53EF\u4EE5\u907F\u514D\u8FD9\u4E2A\u9519\u8BEF\uFF0C\u4F1A\u5C06\u540D\u5B57\u66FF\u6362\u4E3A _\u7D22\u5F15</span>
    Product <span class="token operator">=</span> namedtuple<span class="token punctuation">(</span><span class="token string">&quot;Product&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;def&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;color&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;price&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;class&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> rename<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    product <span class="token operator">=</span> Product<span class="token punctuation">(</span><span class="token string">&quot;\u51B0\u7CD6\u96EA\u68A8&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;\u9EC4\u8272&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;3\u5143&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>product<span class="token punctuation">.</span>_fields<span class="token punctuation">)</span>  <span class="token comment"># (&#39;name&#39;, &#39;_1&#39;, &#39;color&#39;, &#39;price&#39;, &#39;_4&#39;), \u53EF\u4EE5\u770B\u5230\u5DF2\u7ECF\u8FDB\u884C\u4E86\u66FF\u6362</span>

    <span class="token comment"># \u547D\u540D\u5143\u7EC4 - \u7528\u7684\u4E0D\u662F\u5F88\u591A\uFF0C\u5176\u4ED6\u7684\u5185\u5BB9\u5C31\u4E00\u5E76\u5E26\u8FC7\u4E86</span>
    <span class="token comment">#   \u9ED8\u8BA4\u53C2\u6570</span>
    <span class="token comment">#   _replace(**kwargs)\u66FF\u6362\u751F\u6210\u65B0\u7684\u547D\u540D\u5143\u7EC4\u5E76\u8FD4\u56DE</span>
    <span class="token comment">#   _make()\u6279\u91CF\u7ED9\u547D\u540D\u5143\u7EC4\u8D4B\u503C</span>


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">&#39;__main__&#39;</span><span class="token punctuation">:</span>
    main<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div></details><h3 id="\u5B57\u7B26\u4E32-str" tabindex="-1"><a class="header-anchor" href="#\u5B57\u7B26\u4E32-str" aria-hidden="true">#</a> \u5B57\u7B26\u4E32(str)</h3>`,8),Un=s("\u6587\u6863\uFF1A"),Vn={href:"https://docs.python.org/3/library/stdtypes.html#str",target:"_blank",rel:"noopener noreferrer"},Wn=s("https://docs.python.org/3/library/stdtypes.html#str"),Hn=p(`<p><strong>\uFF081\uFF09\u5B57\u7B26\u4E32\u7C7B\u7B7E\u540D</strong></p><div class="language-python ext-py"><pre class="language-python"><code><span class="token keyword">class</span> <span class="token class-name">str</span><span class="token punctuation">(</span><span class="token builtin">object</span><span class="token operator">=</span><span class="token string">b&#39;&#39;</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">&#39;utf-8&#39;</span><span class="token punctuation">,</span> errors<span class="token operator">=</span><span class="token string">&#39;strict&#39;</span><span class="token punctuation">)</span>
</code></pre></div><p>\u6839\u636E\u4F20\u5165\u7684\u5BF9\u8C61\u521B\u5EFA\u4E00\u4E2A\u65B0\u5B57\u7B26\u4E32</p><ul><li><p>\u5982\u679C<code>encoding</code>\u548C<code>errors</code>\u90FD\u6CA1\u6709\u6307\u5B9A\u503C\uFF0C\u90A3\u4E48\u4F1A\u8C03\u7528<code>object.__str__()</code>\uFF0C\u5982\u679C\u5BF9\u8C61\u6CA1\u6709<code>__str__()</code>\u65B9\u6CD5\uFF0C\u90A3\u4E48\u4F1A\u8C03\u7528<code>repr(object)</code></p></li><li><p>\u5982\u679Cencoding\u548Cerrors\u81F3\u5C11\u6307\u5B9A\u4E00\u4E2A\u503C\uFF0C\u90A3\u4E48\u8BE5\u8F93\u5165\u5BF9\u8C61\u5E94\u8BE5\u662F\u4E00\u4E2A bytes-like\u5BF9\u8C61\uFF0C</p><p>\u6B64\u65F6\u5C31\u76F8\u5F53\u4E8E<code>str(bytes, encoding, errors)</code> == <code>bytes.decode(encoding, errors)</code></p></li><li><p>encoding\u9ED8\u8BA4\u503C\u4ECE<code>sys.getdefaultencoding()</code>\u4E2D\u83B7\u53D6</p></li></ul><div class="language-python ext-py"><pre class="language-python"><code><span class="token comment">#!/usr/bin/env python</span>
<span class="token comment"># -*- coding:utf-8 -*-</span>

<span class="token keyword">import</span> sys

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span><span class="token string">b&#39;abc&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># b&#39;abc&#39;\uFF0C\u8FD9\u91CC\u662F\u5B57\u8282\u7C7B\u578B</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span><span class="token string">b&#39;abc&#39;</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">&quot;utf-8&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># abc\uFF0C\u8FD9\u91CC\u662F\u5B57\u7B26\u4E32\u7C7B\u578B</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>sys<span class="token punctuation">.</span>getdefaultencoding<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># utf-8</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span><span class="token string">b&#39;abc&#39;</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">&quot;utf-8&quot;</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token builtin">bytes</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">b&#39;abc&#39;</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">&quot;utf-8&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># True</span>
</code></pre></div><p><strong>\uFF082\uFF09\u683C\u5F0F\u5316\u8F93\u51FA\u7684\u51E0\u79CD\u65B9\u6CD5</strong></p><p>\u2460 \u4F7F\u7528%\uFF08\u5DF2\u7ECF\u4E0D\u63A8\u8350\u4F7F\u7528\uFF0C\u4EC5\u4F5C\u4E86\u89E3\uFF09</p><div class="language-python ext-py"><pre class="language-python"><code><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;I am %d years old, and i has %d friends&quot;</span> <span class="token operator">%</span> <span class="token punctuation">(</span><span class="token number">27</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&#39;%(language)s has %(number)03d quote types.&#39;</span> <span class="token operator">%</span> <span class="token punctuation">{</span><span class="token string">&#39;language&#39;</span><span class="token punctuation">:</span> <span class="token string">&quot;Python&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;number&quot;</span><span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">)</span>  

<span class="token comment"># I am 27 years old, and i has 3 friends</span>
<span class="token comment"># Python has 002 quote types.</span>
</code></pre></div><p>\u2461 \u4F7F\u7528format\uFF08\u63A8\u8350\uFF09</p><div class="language-python ext-py"><pre class="language-python"><code><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Hello {name1}, hello {name2}&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>name1<span class="token operator">=</span><span class="token string">&quot;python&quot;</span><span class="token punctuation">,</span> name2<span class="token operator">=</span><span class="token string">&quot;world&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Hello {name1}, hello {name2}&quot;</span><span class="token punctuation">.</span>format_map<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&quot;name1&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;python&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;name2&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;world&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># Hello python, hello world</span>
<span class="token comment"># Hello python, hello world</span>
</code></pre></div><p>\u2462 \u4F7F\u7528f-string\uFF08\u63A8\u8350\uFF09</p><div class="language-python ext-py"><pre class="language-python"><code>name1 <span class="token operator">=</span> <span class="token string">&quot;python&quot;</span>
name2 <span class="token operator">=</span> <span class="token string">&quot;world&quot;</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;Hello </span><span class="token interpolation"><span class="token punctuation">{</span>name1<span class="token punctuation">}</span></span><span class="token string">, hello </span><span class="token interpolation"><span class="token punctuation">{</span>name2<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>

<span class="token comment"># Hello python, hello world</span>
</code></pre></div><p>\u8F93\u51FA\u65B9\u6CD5\u603B\u7ED3</p><div class="language-python ext-py"><pre class="language-python"><code><span class="token comment">#!/usr/bin/env python</span>
<span class="token comment"># -*- coding:utf-8 -*-</span>

<span class="token comment"># \u7B2C1\u79CD\u65B9\u6CD5</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;I am %s years old&quot;</span> <span class="token operator">%</span> <span class="token string">&quot;18&quot;</span><span class="token punctuation">)</span>

<span class="token comment"># \u7B2C2\u79CD\u65B9\u6CD5</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;I am %(year)d years old&quot;</span> <span class="token operator">%</span> <span class="token punctuation">{</span><span class="token string">&quot;year&quot;</span><span class="token punctuation">:</span> <span class="token number">18</span><span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment"># \u7B2C3\u79CD\u65B9\u6CD5</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;I am {year} years old&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>year<span class="token operator">=</span><span class="token number">18</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># \u7B2C4\u79CD\u65B9\u6CD5</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;I am {} years old&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token number">18</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># \u7B2C5\u79CD\u65B9\u6CD5</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;I am {year} years old&quot;</span><span class="token punctuation">.</span>format_map<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&quot;year&quot;</span><span class="token punctuation">:</span> <span class="token number">18</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># \u7B2C6\u79CD\u65B9\u6CD5</span>
year <span class="token operator">=</span> <span class="token number">18</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;I am </span><span class="token interpolation"><span class="token punctuation">{</span>year<span class="token punctuation">}</span></span><span class="token string"> years old&quot;</span></span><span class="token punctuation">)</span>
</code></pre></div><p><strong>\uFF083\uFF09\u683C\u5F0F\u5316\u8F93\u4FEE\u9970\u7B26</strong></p><table><thead><tr><th>\u4FEE\u9970\u7B26</th><th>\u8BF4\u660E</th></tr></thead><tbody><tr><td><code>^</code></td><td>\u5267\u4E2D</td></tr><tr><td><code>&lt;</code></td><td>\u5DE6\u5BF9\u9F50</td></tr><tr><td><code>&gt;</code></td><td>\u53F3\u5BF9\u9F50</td></tr><tr><td><code>,</code></td><td>\u9017\u53F7\uFF0C\u53EF\u4EE5\u505A\u5343\u4F4D\u5206\u9694\u7B26</td></tr><tr><td><code>{:n}</code></td><td>\u7528\u7A7A\u767D\u8865\u5145\u8BE5\u53D8\u91CF\u7684\u957F\u5EA6\u5230n(\u5728\u4E24\u8FB9\u8865\u5145)</td></tr><tr><td><code>{:#^n}</code></td><td>\u7528#\u53F7\u8865\u5145\u8BE5\u53D8\u91CF\u7684\u957F\u5EA6\u5230n(\u5728\u4E24\u8FB9\u8865\u5145)\uFF0C\u5E76\u8BBE\u7F6E\u4E3A\u5267\u4E2D\u5BF9\u9F50\uFF1B\u683C\u5F0F\u4E3A\uFF1A<code>\u8865\u5145-\u5BF9\u9F50-\u5BBD\u5EA6-\u5C0F\u6570\u70B9\u4FDD\u7559\u4F4D\u6570</code></td></tr></tbody></table><p>\u683C\u5F0F\u5316\u4FEE\u9970\u7B26\u6F14\u793A</p><details class="custom-container details"><summary>\u70B9\u51FB\u67E5\u770B\u5B8C\u6574\u4EE3\u7801</summary><div class="language-python ext-py"><pre class="language-python"><code><span class="token comment">#!/usr/bin/env python</span>
<span class="token comment"># -*- coding:utf-8 -*-</span>

<span class="token comment"># \uFF081\uFF09\u4FDD\u7559\u4E24\u4F4D\u5C0F\u6570</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&#39;\\n(1) \u9ED8\u8BA4\u60C5\u51B5\u4E0B: 5/3 = </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token number">5</span> <span class="token operator">/</span> <span class="token number">3</span><span class="token punctuation">}</span></span><span class="token string"> | \u4FDD\u7559\u4E24\u4F4D\u5C0F\u6570: 5/3 = </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token number">5</span> <span class="token operator">/</span> <span class="token number">3</span><span class="token punctuation">:</span><span class="token format-spec">.2f</span><span class="token punctuation">}</span></span><span class="token string">\\n&#39;</span></span><span class="token punctuation">)</span>

<span class="token comment"># (2) \u5343\u4F4D\u5206\u9694\u7B26</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&#39;(2) \u5343\u4F4D\u5206\u9694\u7B26: {:,}\\n&#39;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token number">123456789</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># \uFF083\uFF09\u5B57\u7B26\u4E32\u957F\u5EA6\u4E3A20,\u5C06\u5B57\u7B26\u4E32\u5C45\u4E2D\uFF0C\u4E24\u4FA7\u6DFB\u52A0_</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;(3) \u6837\u5F0F\u8BBE\u7F6E: {:_^20}\\n&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token string">&quot;Hello World!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>


<span class="token comment"># (4) \u4E2D\u6587\u5BF9\u9F50\u95EE\u9898\uFF08\u547D\u4EE4\u884C\u6709\u6548\uFF0CPycharm\u4E2D\u6C49\u5B57\u548C\u82F1\u6587\u5BBD\u5EA6\u6BD4\u4F8B\u6709\u95EE\u9898\uFF09</span>
<span class="token comment">#     \u4E00\u4E2A\u4E2D\u6587\u5360\u636E2\u4E2AASCII\u7801\u7684\u5BBD\u5EA6</span>
<span class="token comment">#     \u4E00\u4E2AASCII\u7801\u53601\u4E2A\u5B57\u8282\u5927\u5C0F\uFF0C\u4E00\u4E2A\u4E2D\u6587\u53603\u4E2A\u5B57\u8282\u5927\u5C0F</span>

<span class="token keyword">def</span> <span class="token function">is_chinese</span><span class="token punctuation">(</span>uchar<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">&#39;&#39;&#39;\u68C0\u6D4B\u662F\u5426\u662F\u4E2D\u6587&#39;&#39;&#39;</span>

    <span class="token comment"># \u9488\u5BF9\u4E2D\u6587\u6807\u70B9\u7B26\u53F7\uFF0C\u6839\u636E\u5B9E\u9645\u60C5\u51B5\u7EE7\u7EED\u6DFB\u52A0</span>
    symbols <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&quot;\u3001&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;\u3002&quot;</span><span class="token punctuation">]</span>
    <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">filter</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> x <span class="token keyword">in</span> symbols<span class="token punctuation">,</span> uchar<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token boolean">True</span>

    <span class="token comment"># \u4E2D\u6587\u68C0\u6D4B</span>
    <span class="token keyword">if</span> uchar <span class="token operator">&gt;=</span> <span class="token string">u&#39;\\u4e00&#39;</span> <span class="token keyword">and</span> uchar <span class="token operator">&lt;=</span> <span class="token string">u&#39;\\u9fa5&#39;</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token boolean">True</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token boolean">False</span>


<span class="token keyword">def</span> <span class="token function">chinese_number</span><span class="token punctuation">(</span>ustr<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">&#39;&#39;&#39;\u8FD4\u56DE\u4E2D\u6587\u5B57\u7B26\u7684\u6570\u91CF&#39;&#39;&#39;</span>
    c_n <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> ustr<span class="token punctuation">:</span>
        <span class="token keyword">if</span> is_chinese<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">:</span>
            c_n <span class="token operator">+=</span> <span class="token number">1</span>
    <span class="token keyword">return</span> c_n


<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;(4) \u4E2D\u6587\u5BF9\u9F50\u95EE\u9898(CMD\u4E0B\u751F\u6548,Pycharm\u4E2D\u6709\u95EE\u9898)&quot;</span><span class="token punctuation">)</span>
msg1 <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token string">&quot;\u8C03\u7528\u8BE5\u65B9\u6CD5\u7684\u5B57\u7B26\u4E32\u5C06\u4F5C\u4E3A\u5143\u7D20\u4E4B\u95F4\u7684\u5206\u9694&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;\u6B64\u9759\u6001\u65B9\u6CD5\u8FD4\u56DE\u4E00\u4E2A\u53EF\u4F9B str.translate() \u4F7F\u7528\u7684\u8F6C\u6362\u5BF9\u7167\u8868\u3002&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&#39;\u5373\u90A3\u4E9B\u5177\u6709&quot;Lm&quot;\u3001&quot;Lt&quot;\u3001&quot;Lu&quot;\u3001&quot;Ll&quot; \u6216 &quot;Lo&quot; \u4E4B\u4E00\u7684\u901A\u7528\u7C7B\u522B\u5C5E\u6027\u7684\u5B57\u7B26&#39;</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span>
msg2 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&quot;\u5360\u4F4D\u7B26&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;\u5360\u4F4D\u7B26&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;\u5360\u4F4D\u7B26&quot;</span><span class="token punctuation">]</span>
fmt <span class="token operator">=</span> <span class="token string">&#39;[ |{name:{width}}| |{years:&lt;20}| ]&#39;</span>
<span class="token keyword">for</span> name<span class="token punctuation">,</span> years <span class="token keyword">in</span> <span class="token builtin">zip</span><span class="token punctuation">(</span>msg1<span class="token punctuation">,</span> msg2<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>fmt<span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>name<span class="token operator">=</span>name<span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">100</span> <span class="token operator">-</span> chinese_number<span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> years<span class="token operator">=</span>years<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div></details><p>\u8F93\u51FA\u7ED3\u679C</p><p><img src="https://tuchuang-1257805459.cos.ap-shanghai.myqcloud.com/image-20220405164801876.png" alt="image-20220405164801876"></p><p><strong>\uFF084\uFF09\u5B57\u7B26\u4E32\u5E38\u7528\u65B9\u6CD5</strong></p><table><thead><tr><th>\u5206\u7C7B</th><th>\u65B9\u6CD5</th><th>\u8BF4\u660E</th></tr></thead><tbody><tr><td>\u5927\u5C0F\u5199\u8F6C\u6362</td><td>str.casefold()</td><td>\u8FD4\u56DE\u4E00\u4E2A\u65B0\u5B57\u7B26\u4E32\uFF0C\u628A\u6240\u6709\u5927\u5199\u5B57\u6BCD\u6539\u4E3A\u5C0F\u5199\uFF08\u9664\u4E86\u82F1\u6587\uFF0C\u5BF9\u4E8E\u5176\u4ED6\u8BED\u8A00\u540C\u6837\u6709\u6548\uFF09</td></tr><tr><td></td><td>str.lower()</td><td>\u8FD4\u56DE\u4E00\u4E2A\u65B0\u5B57\u7B26\u4E32\uFF0C\u628A\u6240\u6709\u5927\u5199\u5B57\u6BCD\u6539\u4E3A\u5C0F\u5199\uFF08\u9488\u5BF9A-Z\uFF09</td></tr><tr><td></td><td>str.upper()</td><td>\u8FD4\u56DE\u4E00\u4E2A\u65B0\u5B57\u7B26\u4E32\uFF0C\u628A\u6240\u6709\u5C0F\u5199\u5B57\u6BCD\u6539\u4E3A\u5927\u5199\uFF08\u9488\u5BF9A-Z\uFF09</td></tr><tr><td></td><td>str.swapcase()</td><td>\u7FFB\u8F6C\u5B57\u7B26\u4E32\uFF0C\u5927\u5199\u53D8\u5C0F\u5199\uFF0C\u5C0F\u5199\u53D8\u5927\u5199</td></tr><tr><td>\u641C\u7D22</td><td>str.count(<em>sub</em>[, <em>start</em>[, <em>end</em>]])</td><td>\u8FD4\u56DEsub\u5728\u5B57\u7B26\u4E32\u51FA\u73B0\u7684\u6B21\u6570\uFF0Cstart\u548Cend\u8868\u793A\u8D77\u59CB\u8303\u56F4\uFF08\u53EF\u9009\uFF09</td></tr><tr><td></td><td>str.find(<em>sub</em>[, <em>start</em>[, <em>end</em>]])</td><td>\u68C0\u67E5\u5B57\u7B26\u4E32sub\u662F\u5426\u5305\u542B\u5728\u5B57\u7B26\u4E32\u4E2D\uFF0C\u5982\u679C\u6709\u5219\u8FD4\u56DE\u7D22\u5F15\u503C\uFF0C\u6CA1\u6709\u5219\u8FD4\u56DE-1<br>\u53EA\u6709\u5F53\u4F60\u660E\u786E\u786E\u5B9A\u4F4D\u7F6E\u6216\u9700\u8981\u5F97\u5230\u7D22\u5F15\u503C\u65F6\uFF0C\u624D\u5E94\u8BE5\u4F7F\u7528find\u65B9\u6CD5\uFF0C\u5426\u5219\u5E94\u8BE5\u4F7F\u7528in<br>\u7C7B\u4F3C\u7684\u8FD8\u6709<code>str.rfind</code>\uFF0C\u4ECE\u53F3\u5411\u5DE6\u5F00\u59CB\u67E5\u627E</td></tr><tr><td></td><td>str.index(<em>sub</em>[, <em>start</em>[, <em>end</em>]])</td><td>\u4E0Efind\u7C7B\u578B\uFF0C\u5F53sub\u627E\u4E0D\u5230\u7684\u65F6\u5019\u4F1A\u5F15\u53D1<code>ValueError\u5F02\u5E38</code><br>\u7C7B\u4F3C\u7684\u8FD8\u6709rindex\uFF0C\u4ECE\u53F3\u5411\u5DE6\u5F00\u59CB\u67E5\u627E</td></tr><tr><td>\u5206\u5272\u548C\u5408\u5E76</td><td>str.split(<em>sep=None</em>, <em>maxsplit=-1</em>)</td><td>\u4EE5\\n,\\r\u548C\\r\\n\u548C\u7A7A\u767D\u4E3A\u5206\u9694\u7B26\u5206\u5272\u5B57\u7B26\u4E32\uFF0C\u8FD4\u56DE\u4E00\u4E2A\u5217\u8868\uFF0Csep\u6307\u5B9A\u5206\u9694\u7B26\uFF0Cmaxsplit\u6307\u5B9A\u5206\u5272\u6B21\u6570<br>\u7C7B\u4F3C\u7684\u6709str.rsplit\uFF0C\u4ECE\u53F3\u5411\u5DE6\u5F00\u59CB\u5206\u5272</td></tr><tr><td></td><td>str.splitlines([<em>keepends</em>])</td><td>\u4EE5\\n,\\r\u548C\\r\\n\u4E3A\u5206\u9694\u7B26\uFF0C\u8FD4\u56DE\u4E00\u4E2A\u5217\u8868;\u5982\u679Ckeepends\u4E3ATrue,\u5219\u5206\u9694\u7B26\u4FDD\u7559\uFF0C\u5426\u5219\u4E22\u5F03</td></tr><tr><td></td><td>str.join(<em>iterable</em>)</td><td>\u5B57\u7B26\u4E32\u8FDE\u63A5<br>join\u91CC\u7684\u53C2\u6570\u7684\u6240\u6709\u5143\u7D20\u5FC5\u987B\u662F\u5B57\u7B26\u4E32\u7C7B\u578B\uFF0C\u5426\u5219\u4F1A\u62A5\u9519,\u89E3\u51B3\u65B9\u6CD5\u53EF\u4EE5\u8FD9\u6837\uFF1A<br><code>&#39;-&#39;.join([str(x) for x in range(10)])</code></td></tr><tr><td>\u66FF\u6362</td><td>str.replace(<em>old</em>, <em>new</em>[, <em>count</em>])</td><td>\u5C06\u5B57\u7B26\u4E32\u4E2D\u7684old\u66FF\u6362\u4E3Anew\uFF0Ccount\u6307\u5B9A\u66FF\u6362\u6B21\u6570\uFF0C\u53EF\u9009\uFF0C\u9ED8\u8BA4\u5168\u90E8\u66FF\u6362</td></tr><tr><td>\u5220\u9664\u5DE6\u53F3\u7A7A\u767D</td><td>str.strip([<em>chars</em>])</td><td>\u5220\u9664\u5B57\u7B26\u4E32\u4E24\u4FA7\u7684\u5B57\u7B26\uFF0C\u9ED8\u8BA4\u4E3A\u7A7A\u767D\uFF0C<br>\u7C7B\u4F3C\u7684\u8FD8\u6709lstrip\uFF08\u53EA\u5220\u9664\u5DE6\u8FB9\u7684\u5B57\u7B26\uFF09\u3001rstrip\uFF08\u53EA\u5220\u9664\u53F3\u8FB9\u7684\u5B57\u7B26\uFF09</td></tr><tr><td>\u5F00\u5934\u3001\u7ED3\u5C3E\u5339\u914D</td><td>str.startswith(<em>prefix</em>[, <em>start</em>[, <em>end</em>]])</td><td>\u68C0\u67E5\u5B57\u7B26\u4E32\u662F\u5426\u4EE5prefix\u5B50\u5B57\u7B26\u4E32\u5F00\u5934\uFF0Cstart\u548Cend\u8868\u793A\u5339\u914D\u7684\u8D77\u59CB\u8303\u56F4\uFF08\u53EF\u9009\uFF09</td></tr><tr><td></td><td>str.endswith(<em>suffix</em>[, <em>start</em>[, <em>end</em>]])</td><td>\u540C\u4E0A</td></tr><tr><td>\u5236\u8868\u7B26</td><td>str.expandtabs(<em>tabsize=8</em>)</td><td>\u8FD4\u56DE\u4E00\u4E2A\u65B0\u5B57\u7B26\u4E32\uFF0C\u628A\u5B57\u7B26\u4E32\u4E2D\u7684\u5236\u8868\u7B26(\\t)\u66FF\u6362\u6210tabsize\u4E2A\u7A7A\u683C\uFF0Ctabsize\u9ED8\u8BA4\u662F8</td></tr><tr><td>\u7C7B\u578B\u5224\u65AD</td><td>str.isdigit()</td><td>\u5982\u679C\u5B57\u7B26\u4E32\u53EA\u5305\u542B\u6570\u5B57\u5219\u8FD4\u56DETrue\uFF0C\u5426\u5219\u8FD4\u56DEFalse</td></tr><tr><td></td><td>str.isdecimal()</td><td>\u5982\u679C\u5B57\u7B26\u4E32\u53EA\u5305\u542B\u5341\u8FDB\u5236\u6570\u5219\u8FD4\u56DETrue\uFF0C\u5426\u5219\u8FD4\u56DEFalse</td></tr><tr><td></td><td>str.isnumeric()</td><td>\u5982\u679C\u5B57\u7B26\u4E32\u53EA\u5305\u542B\u6570\u5B57\u5B57\u7B26\u5219\u8FD4\u56DETrue\uFF0C\u5426\u5219\u8FD4\u56DEFalse</td></tr><tr><td></td><td>str.isalpha()</td><td>\u5982\u679C\u5B57\u7B26\u4E32\u81F3\u5C11\u6709\u4E00\u4E2A\u5B57\u7B26\u5E76\u4E14\u6240\u6709\u5B57\u7B26\u90FD\u662F\u5B57\u6BCD\u5219\u8FD4\u56DETrule,\u5426\u5219\u8FD4\u56DEFalse</td></tr><tr><td></td><td>str.isalnum()</td><td>\u5982\u679C\u5B57\u7B26\u4E32\u81F3\u5C11\u6709\u4E00\u4E2A\u5B57\u7B26\u5E76\u4E14\u6240\u6709\u5B57\u7B26\u90FD\u662F\u6570\u5B57\u6216\u8005\u5B57\u6BCD\u5219\u8FD4\u56DETrule,\u5426\u5219\u8FD4\u56DEFalse</td></tr><tr><td></td><td>str.isascii()</td><td>\u5982\u679C\u5B57\u7B26\u4E32\u4E3A\u7A7A\u6216\u8005\u4E3AASCII\u7801\u8FD4\u56DETrue\uFF0C\u5426\u5219\u8FD4\u56DEFalse</td></tr><tr><td></td><td>\u66F4\u591A\u7C7B\u578B\u5224\u65AD...</td><td></td></tr></tbody></table><p><strong>\uFF085\uFF09str\u548Cbyte\u8F6C\u6362</strong></p><div class="language-python ext-py"><pre class="language-python"><code><span class="token comment">#!/usr/bin/env python</span>
<span class="token comment"># -*- coding:utf-8 -*-</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&#39;\u4E2D&#39;</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span>encoding<span class="token operator">=</span><span class="token string">&quot;utf-8&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># b&#39;\\xe4\\xb8\\xad&#39;</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">b&#39;\\xe4\\xb8\\xad&#39;</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">&quot;utf-8&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># \u4E2D</span>
</code></pre></div><h3 id="\u5B57\u5178-dict" tabindex="-1"><a class="header-anchor" href="#\u5B57\u5178-dict" aria-hidden="true">#</a> \u5B57\u5178(dict)</h3>`,25),Jn=s("\u6587\u6863\uFF1A"),Gn={href:"https://docs.python.org/zh-cn/3/library/stdtypes.html#dict",target:"_blank",rel:"noopener noreferrer"},Yn=s("https://docs.python.org/zh-cn/3/library/stdtypes.html#dict"),Kn=p(`<p><strong>\u5B57\u5178\u521B\u5EFA</strong></p><details class="custom-container details"><summary>\u70B9\u51FB\u67E5\u770B\u5B8C\u6574\u4EE3\u7801</summary><div class="language-python ext-py"><pre class="language-python"><code><span class="token comment">#!/usr/bin/env python</span>
<span class="token comment"># -*- coding:utf-8 -*-</span>

<span class="token comment"># (1) \u666E\u901A\u65B9\u6CD5\u521B\u5EFA\u5B57\u5178</span>
a <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span>one<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> two<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> three<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">)</span>
b <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">&#39;one&#39;</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">&#39;two&#39;</span><span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">&#39;three&#39;</span><span class="token punctuation">:</span> <span class="token number">3</span><span class="token punctuation">}</span>
c <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span><span class="token builtin">zip</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&#39;one&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;two&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;three&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
d <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token string">&#39;two&#39;</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">&#39;one&#39;</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">&#39;three&#39;</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
e <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&#39;three&#39;</span><span class="token punctuation">:</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">&#39;one&#39;</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">&#39;two&#39;</span><span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;(1) \u666E\u901A\u65B9\u5F0F\u521B\u5EFA\u7684\u5B57\u5178: </span><span class="token interpolation"><span class="token punctuation">{</span>a <span class="token operator">==</span> b <span class="token operator">==</span> c <span class="token operator">==</span> d <span class="token operator">==</span> e<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>

<span class="token comment"># (2) \u901A\u8FC7fromkeys\u521B\u5EFA\u5B57\u5178</span>
a <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
b <span class="token operator">=</span> a<span class="token punctuation">.</span>fromkeys<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">&quot;a&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;b&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;c&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;(2) \u901A\u8FC7fromkeys\u521B\u5EFA\u5B57\u5178: </span><span class="token interpolation"><span class="token punctuation">{</span>b<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>

<span class="token comment"># (3) \u5B57\u5178\u63A8\u5BFC\u5F0F</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;(3) \u5B57\u5178\u63A8\u5BFC\u5F0F&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;    {}&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token punctuation">{</span>x<span class="token punctuation">:</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token keyword">for</span> x <span class="token keyword">in</span> <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">65</span><span class="token punctuation">,</span> <span class="token number">68</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;    {}&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token punctuation">{</span>i<span class="token punctuation">:</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">65</span><span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div></details><p>\u8F93\u51FA\u7ED3\u679C</p><div class="language-bash ext-sh"><pre class="language-bash"><code><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> \u666E\u901A\u65B9\u5F0F\u521B\u5EFA\u7684\u5B57\u5178: True
<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> \u901A\u8FC7fromkeys\u521B\u5EFA\u5B57\u5178: <span class="token punctuation">{</span><span class="token number">1</span>: <span class="token punctuation">[</span><span class="token string">&#39;a&#39;</span>, <span class="token string">&#39;b&#39;</span>, <span class="token string">&#39;c&#39;</span><span class="token punctuation">]</span>, <span class="token number">2</span>: <span class="token punctuation">[</span><span class="token string">&#39;a&#39;</span>, <span class="token string">&#39;b&#39;</span>, <span class="token string">&#39;c&#39;</span><span class="token punctuation">]</span><span class="token punctuation">}</span>
<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span> \u5B57\u5178\u63A8\u5BFC\u5F0F
    <span class="token punctuation">{</span><span class="token number">65</span>: <span class="token string">&#39;A&#39;</span>, <span class="token number">66</span>: <span class="token string">&#39;B&#39;</span>, <span class="token number">67</span>: <span class="token string">&#39;C&#39;</span><span class="token punctuation">}</span>
    <span class="token punctuation">{</span><span class="token number">0</span>: <span class="token string">&#39;A&#39;</span>, <span class="token number">1</span>: <span class="token string">&#39;B&#39;</span>, <span class="token number">2</span>: <span class="token string">&#39;C&#39;</span><span class="token punctuation">}</span>
</code></pre></div><p><strong>\u5B57\u5178\u65B9\u6CD5</strong></p><table><thead><tr><th>\u5206\u7C7B</th><th>\u65B9\u6CD5</th><th>\u8BF4\u660E</th></tr></thead><tbody><tr><td>\u6DFB\u52A0</td><td>dict[key] = value</td><td>\u76F4\u63A5\u8D4B\u503C\uFF0C\u6CA1\u6709\u5373\u65B0\u589E\uFF0C\u6709\u7684\u8BDD\u4E3A\u8986\u76D6</td></tr><tr><td></td><td>dict.update(dict)</td><td>\u5B57\u5178\u5408\u5E76</td></tr><tr><td></td><td>dict.setdefault(k, [value])</td><td>k\u5B58\u5728\u5219\u8FD4\u56DEv\u7684\u503C\uFF0C\u5426\u5219\u8BBE\u7F6Edict[k] = value\uFF0C\u5E76\u8FD4\u56DEvalue\u7684\u503C</td></tr><tr><td>\u5220\u9664</td><td>del dict[key]</td><td>\u76F4\u63A5\u5220\u9664</td></tr><tr><td></td><td>dict.pop(key)</td><td>\u5F39\u51FAvalue\u503C\uFF0C\u5982\u679Ckey\u672A\u627E\u5230\u5219\u629B\u51FAKeyError</td></tr><tr><td></td><td>dict.popitem ()</td><td>\u968F\u673A\u5F39\u51FA\u952E\u503C\u5BF9</td></tr><tr><td></td><td>dict.clear()</td><td>\u5220\u9664\u5B57\u5178\u6240\u6709\u5143\u7D20</td></tr><tr><td>\u67E5\u627E</td><td>dict[key]</td><td>\u8FD4\u56DEvalue\u503C\uFF0C\u5982\u679Ckey\u4E0D\u5B58\u5728\uFF0C\u5219\u629B\u51FAKeyError</td></tr><tr><td></td><td>dict.get(key, [default])</td><td>\u8FD4\u56DEvalue\u503C\uFF0C\u5982\u679Ckey\u4E0D\u5B58\u5728\uFF0C\u5219\u8FD4\u56DEdefault\u503C\u6216None</td></tr><tr><td>\u62F7\u8D1D</td><td>dict.copy()</td><td>\u6D45\u62F7\u8D1D</td></tr><tr><td></td><td>copy.deepcopy(dict)</td><td>\u6DF1\u62F7\u8D1D</td></tr><tr><td>\u904D\u5386</td><td>dict.keys()</td><td>\u8FD4\u56DE\u6240\u6709\u7684key</td></tr><tr><td></td><td>dict.values()</td><td>\u8FD4\u56DE\u6240\u6709\u7684value</td></tr><tr><td></td><td>dict.items()</td><td>\u8FD4\u56DEk\u548Cv</td></tr></tbody></table><h3 id="\u53EF\u53D8\u96C6\u5408-set" tabindex="-1"><a class="header-anchor" href="#\u53EF\u53D8\u96C6\u5408-set" aria-hidden="true">#</a> \u53EF\u53D8\u96C6\u5408(set)</h3>`,7),Qn=s("\u6587\u6863\uFF1A"),$n={href:"https://docs.python.org/zh-cn/3/library/stdtypes.html#set",target:"_blank",rel:"noopener noreferrer"},Zn=s("https://docs.python.org/zh-cn/3/library/stdtypes.html#set"),Xn=p(`<p><strong>\u521B\u5EFA\u96C6\u5408</strong></p><div class="language-python ext-py"><pre class="language-python"><code><span class="token comment">#!/usr/bin/env python</span>
<span class="token comment"># -*- coding:utf-8 -*-</span>


a <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">}</span>
b <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">&quot;B&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
c <span class="token operator">=</span> <span class="token builtin">set</span><span class="token punctuation">(</span><span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span>
</code></pre></div><p>\u8F93\u51FA\u7ED3\u679C</p><div class="language-bash ext-sh"><pre class="language-bash"><code><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token number">2</span>, <span class="token punctuation">(</span><span class="token number">1</span>, <span class="token number">2</span>, <span class="token number">3</span><span class="token punctuation">)</span>, <span class="token string">&#39;B&#39;</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token number">0</span>, <span class="token number">1</span>, <span class="token number">2</span>, <span class="token number">3</span>, <span class="token number">4</span><span class="token punctuation">}</span>
</code></pre></div><p><strong>\u96C6\u5408\u65B9\u6CD5</strong></p><table><thead><tr><th>\u5206\u7C7B</th><th>\u65B9\u6CD5</th><th>\u8BF4\u660E</th></tr></thead><tbody><tr><td>\u6DFB\u52A0\u5143\u7D20</td><td>.add(value)</td><td>\u6DFB\u52A0\u5143\u7D20</td></tr><tr><td></td><td>.update(set)</td><td>\u96C6\u5408\u5408\u5E76</td></tr><tr><td>\u5220\u9664\u5143\u7D20</td><td>.remove(value)</td><td>\u5220\u9664\u5143\u7D20\uFF0C\u5982\u679C\u5143\u7D20\u4E0D\u5B58\u5728\u5219\u629B\u51FAKeyError\u9519\u8BEF</td></tr><tr><td></td><td>.clear()</td><td>\u5220\u9664\u6240\u6709\u5143\u7D20</td></tr><tr><td></td><td>.pop()</td><td>\u4ECE\u4E0B\u68070\u5F00\u59CB\u5F39\u51FA\u5143\u7D20</td></tr><tr><td>\u62F7\u8D1D</td><td>.copy()</td><td>\u6D45\u62F7\u8D1D</td></tr><tr><td>\u96C6\u5408\u64CD\u4F5C</td><td>.union(set)</td><td>\u8FD4\u56DE\u4E00\u4E2A\u65B0\u96C6\u5408\uFF0C\u662F\u4E24\u4E2A\u96C6\u5408\u7684\u5E76\u96C6</td></tr><tr><td></td><td>.intersection(set)</td><td>\u8FD4\u56DE\u4E00\u4E2A\u65B0\u96C6\u5408\uFF0C\u662F\u4E24\u4E2A\u96C6\u5408\u7684\u4EA4\u96C6</td></tr><tr><td></td><td>.intersection_update(set)</td><td><strong>\u5C31\u5730\u4FEE\u6539\u539F\u96C6\u5408\uFF0C\u662F\u4E24\u4E2A\u96C6\u5408\u7684\u4EA4\u96C6</strong></td></tr><tr><td></td><td>.difference(set)</td><td>\u8FD4\u56DE\u4E00\u4E2A\u65B0\u96C6\u5408\uFF0C\u662F\u539F\u96C6\u5408\u72EC\u6709\u7684\u5143\u7D20</td></tr><tr><td></td><td>.difference_update(set)</td><td><strong>\u5C31\u5730\u4FEE\u6539\u539F\u96C6\u5408\uFF0C\u662F\u539F\u96C6\u5408\u72EC\u6709\u7684\u5143\u7D20</strong></td></tr><tr><td></td><td>.issubset(set)</td><td>\u8FD4\u56DE\u4E00\u4E2A\u5E03\u5C14\u503C\uFF0C\u5224\u65AD\u539F\u96C6\u5408\u662F\u5426\u662F\u65B0\u96C6\u5408\u7684\u5B50\u96C6</td></tr><tr><td></td><td>.issuperset(set)</td><td>\u8FD4\u56DE\u4E00\u4E2A\u5E03\u5C14\u503C\uFF0C\u5224\u65AD\u539F\u96C6\u5408\u662F\u5426\u662F\u65B0\u96C6\u5408\u7684\u7236\u96C6</td></tr><tr><td></td><td>.isdisjoint(set)</td><td>\u8FD4\u56DE\u4E00\u4E2A\u5E03\u5C14\u503C\uFF0C\u5224\u65AD\u4E24\u4E2A\u96C6\u5408\u662F\u5426\u3010\u6CA1\u6709\u4EA4\u96C6\u3011</td></tr><tr><td></td><td>.symmetric_difference(set)</td><td>\u8FD4\u56DE\u4E00\u4E2A\u65B0\u96C6\u5408\uFF0C\u53D6\u4E24\u4E2A\u96C6\u5408\u4E0D\u4E00\u6837\u7684\u6240\u6709\u5143\u7D20</td></tr><tr><td></td><td>.symmetric_difference_update(set)</td><td><strong>\u5C31\u5730\u4FEE\u6539\u539F\u96C6\u5408\uFF0C\u53D6\u4E24\u4E2A\u96C6\u5408\u4E0D\u4E00\u6837\u7684\u6240\u6709\u5143\u7D20</strong></td></tr></tbody></table><h3 id="\u4E0D\u53EF\u53D8\u96C6\u5408-frozenset" tabindex="-1"><a class="header-anchor" href="#\u4E0D\u53EF\u53D8\u96C6\u5408-frozenset" aria-hidden="true">#</a> \u4E0D\u53EF\u53D8\u96C6\u5408(frozenset)</h3>`,7),ns=s("\u6587\u6863\uFF1A"),ss={href:"https://docs.python.org/zh-cn/3/library/stdtypes.html#frozenset",target:"_blank",rel:"noopener noreferrer"},as=s("https://docs.python.org/zh-cn/3/library/stdtypes.html#frozenset"),ts=p(`<p>\u548C<code>set</code>\u7C7B\u4F3C\uFF0C\u53EA\u662F\u5C11\u4E86\u8BB8\u591A\u65B9\u6CD5\uFF0C\u7528\u6CD5\u90FD\u662F\u4E00\u6837\u7684</p><div class="language-python ext-py"><pre class="language-python"><code><span class="token comment">#!/usr/bin/env python</span>
<span class="token comment"># -*- coding:utf-8 -*-</span>


a <span class="token operator">=</span> <span class="token builtin">frozenset</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">dir</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># frozenset({1, 2, 3})</span>
<span class="token comment"># [&#39;copy&#39;, &#39;difference&#39;, &#39;intersection&#39;, &#39;isdisjoint&#39;, &#39;issubset&#39;, &#39;issuperset&#39;, &#39;symmetric_difference&#39;, &#39;union&#39;]</span>
</code></pre></div><h3 id="\u53EF\u53D8\u5BF9\u8C61\u548C\u4E0D\u53EF\u53D8\u5BF9\u8C61" tabindex="-1"><a class="header-anchor" href="#\u53EF\u53D8\u5BF9\u8C61\u548C\u4E0D\u53EF\u53D8\u5BF9\u8C61" aria-hidden="true">#</a> \u53EF\u53D8\u5BF9\u8C61\u548C\u4E0D\u53EF\u53D8\u5BF9\u8C61</h3><p><strong>\u5F15\u7528\u8BA1\u6570\u6A21\u578B</strong></p><p><img src="https://tuchuang-1257805459.cos.ap-shanghai.myqcloud.com/698051107556314373.png" alt="698051107556314373"></p><p>\u4EE3\u7801\u793A\u4F8B</p><details class="custom-container details"><summary>\u70B9\u51FB\u67E5\u770B\u5B8C\u6574\u4EE3\u7801\u548C\u8F93\u51FA\u7ED3\u679C</summary><div class="language-python ext-py"><pre class="language-python"><code><span class="token comment">#!/usr/bin/env python</span>
<span class="token comment"># -*- coding:utf-8 -*-</span>

<span class="token keyword">import</span> sys

<span class="token comment"># \u4F7F\u7528sys.getrefcount(obj)\u53EF\u4EE5\u67E5\u770B\u4E00\u4E2A\u5BF9\u8C61\u7684\u5F15\u7528\u8BA1\u6570\uFF0C\u56E0\u4E3A\u8FD9\u4E2AAPI\u4E5F\u4F1A\u4F7F\u5BF9\u8C61\u589E\u52A0\u4E00\u4E2A\u4E34\u65F6\u5F15\u7528\uFF0C\u6240\u4EE5\u771F\u5B9E\u7684\u5F15\u7528\u8BA1\u6570\u5E94\u8BE5\u518D\u51CF\u53BB1</span>


<span class="token comment"># \u521D\u59CB\u5316\u53D8\u91CF</span>
a <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;\u4EE3\u7801: a = </span><span class="token interpolation"><span class="token punctuation">{</span>a<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;\u8BF4\u660E: \u5F15\u7528\u8BA1\u6570(a):</span><span class="token interpolation"><span class="token punctuation">{</span>sys<span class="token punctuation">.</span>getrefcount<span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">}</span></span><span class="token string">, \u5185\u5B58\u5730\u5740:</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token builtin">hex</span><span class="token punctuation">(</span><span class="token builtin">id</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">\\n&quot;</span></span><span class="token punctuation">)</span>

<span class="token comment"># b = a</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;\u4EE3\u7801: b = a&quot;</span><span class="token punctuation">)</span>
b <span class="token operator">=</span> a
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;\u8BF4\u660E: &quot;</span></span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;     \u5F15\u7528\u8BA1\u6570(a): </span><span class="token interpolation"><span class="token punctuation">{</span>sys<span class="token punctuation">.</span>getrefcount<span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">}</span></span><span class="token string">, \u5185\u5B58\u5730\u5740:</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token builtin">hex</span><span class="token punctuation">(</span><span class="token builtin">id</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;     \u5F15\u7528\u8BA1\u6570(b): </span><span class="token interpolation"><span class="token punctuation">{</span>sys<span class="token punctuation">.</span>getrefcount<span class="token punctuation">(</span>b<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">}</span></span><span class="token string">, \u5185\u5B58\u5730\u5740:</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token builtin">hex</span><span class="token punctuation">(</span><span class="token builtin">id</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">\\n&quot;</span></span><span class="token punctuation">)</span>

<span class="token comment"># \u5220\u9664\u53D8\u91CF</span>
<span class="token keyword">del</span> a
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;\u4EE3\u7801: del a&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;\u8BF4\u660E: \u5F15\u7528\u8BA1\u6570(b): </span><span class="token interpolation"><span class="token punctuation">{</span>sys<span class="token punctuation">.</span>getrefcount<span class="token punctuation">(</span>b<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">}</span></span><span class="token string">, \u5185\u5B58\u5730\u5740:</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token builtin">hex</span><span class="token punctuation">(</span><span class="token builtin">id</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">\\n&quot;</span></span><span class="token punctuation">)</span>

c <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;\u4EE3\u7801: c = </span><span class="token interpolation"><span class="token punctuation">{</span>c<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;     \u5F15\u7528\u8BA1\u6570(b): </span><span class="token interpolation"><span class="token punctuation">{</span>sys<span class="token punctuation">.</span>getrefcount<span class="token punctuation">(</span>b<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">}</span></span><span class="token string">, \u5185\u5B58\u5730\u5740:</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token builtin">hex</span><span class="token punctuation">(</span><span class="token builtin">id</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;     \u5F15\u7528\u8BA1\u6570(c): </span><span class="token interpolation"><span class="token punctuation">{</span>sys<span class="token punctuation">.</span>getrefcount<span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">}</span></span><span class="token string">, \u5185\u5B58\u5730\u5740:</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token builtin">hex</span><span class="token punctuation">(</span><span class="token builtin">id</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">\\n&quot;</span></span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;-------------------------------------------------------------------&quot;</span><span class="token punctuation">)</span>

<span class="token comment"># \u521D\u59CB\u5316\u53D8\u91CF</span>
a <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;\u4EE3\u7801: a = </span><span class="token interpolation"><span class="token punctuation">{</span>a<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;\u8BF4\u660E: \u5F15\u7528\u8BA1\u6570(a):</span><span class="token interpolation"><span class="token punctuation">{</span>sys<span class="token punctuation">.</span>getrefcount<span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">}</span></span><span class="token string">, \u5185\u5B58\u5730\u5740:</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token builtin">hex</span><span class="token punctuation">(</span><span class="token builtin">id</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">\\n&quot;</span></span><span class="token punctuation">)</span>

<span class="token comment"># b = a</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;\u4EE3\u7801: b = a&quot;</span><span class="token punctuation">)</span>
b <span class="token operator">=</span> a
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;\u8BF4\u660E: &quot;</span></span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;     \u5F15\u7528\u8BA1\u6570(a): </span><span class="token interpolation"><span class="token punctuation">{</span>sys<span class="token punctuation">.</span>getrefcount<span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">}</span></span><span class="token string">, \u5185\u5B58\u5730\u5740:</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token builtin">hex</span><span class="token punctuation">(</span><span class="token builtin">id</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;     \u5F15\u7528\u8BA1\u6570(b): </span><span class="token interpolation"><span class="token punctuation">{</span>sys<span class="token punctuation">.</span>getrefcount<span class="token punctuation">(</span>b<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">}</span></span><span class="token string">, \u5185\u5B58\u5730\u5740:</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token builtin">hex</span><span class="token punctuation">(</span><span class="token builtin">id</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">\\n&quot;</span></span><span class="token punctuation">)</span>

<span class="token comment"># \u5220\u9664\u53D8\u91CF</span>
<span class="token keyword">del</span> a
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;\u4EE3\u7801: del a&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;\u8BF4\u660E: \u5F15\u7528\u8BA1\u6570(b): </span><span class="token interpolation"><span class="token punctuation">{</span>sys<span class="token punctuation">.</span>getrefcount<span class="token punctuation">(</span>b<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">}</span></span><span class="token string">, \u5185\u5B58\u5730\u5740:</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token builtin">hex</span><span class="token punctuation">(</span><span class="token builtin">id</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">\\n&quot;</span></span><span class="token punctuation">)</span>

c <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;\u4EE3\u7801: c = </span><span class="token interpolation"><span class="token punctuation">{</span>c<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;     \u5F15\u7528\u8BA1\u6570(b): </span><span class="token interpolation"><span class="token punctuation">{</span>sys<span class="token punctuation">.</span>getrefcount<span class="token punctuation">(</span>b<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">}</span></span><span class="token string">, \u5185\u5B58\u5730\u5740:</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token builtin">hex</span><span class="token punctuation">(</span><span class="token builtin">id</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;     \u5F15\u7528\u8BA1\u6570(c): </span><span class="token interpolation"><span class="token punctuation">{</span>sys<span class="token punctuation">.</span>getrefcount<span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">}</span></span><span class="token string">, \u5185\u5B58\u5730\u5740:</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token builtin">hex</span><span class="token punctuation">(</span><span class="token builtin">id</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">\\n&quot;</span></span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;-&quot;</span> <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">)</span>
</code></pre></div><p>\u8F93\u51FA\u7ED3\u679C</p><div class="language-bash ext-sh"><pre class="language-bash"><code>\u4EE3\u7801: a <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span>, <span class="token number">2</span>, <span class="token number">3</span><span class="token punctuation">]</span>
\u8BF4\u660E: \u5F15\u7528\u8BA1\u6570<span class="token punctuation">(</span>a<span class="token punctuation">)</span>:1, \u5185\u5B58\u5730\u5740:0x1e465c15208

\u4EE3\u7801: b <span class="token operator">=</span> a
\u8BF4\u660E: 
     \u5F15\u7528\u8BA1\u6570<span class="token punctuation">(</span>a<span class="token punctuation">)</span>: <span class="token number">2</span>, \u5185\u5B58\u5730\u5740:0x1e465c15208
     \u5F15\u7528\u8BA1\u6570<span class="token punctuation">(</span>b<span class="token punctuation">)</span>: <span class="token number">2</span>, \u5185\u5B58\u5730\u5740:0x1e465c15208

\u4EE3\u7801: del a
\u8BF4\u660E: \u5F15\u7528\u8BA1\u6570<span class="token punctuation">(</span>b<span class="token punctuation">)</span>: <span class="token number">1</span>, \u5185\u5B58\u5730\u5740:0x1e465c15208

\u4EE3\u7801: c <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span>, <span class="token number">2</span>, <span class="token number">3</span><span class="token punctuation">]</span>
     \u5F15\u7528\u8BA1\u6570<span class="token punctuation">(</span>b<span class="token punctuation">)</span>: <span class="token number">1</span>, \u5185\u5B58\u5730\u5740:0x1e465c15208			<span class="token operator">=</span><span class="token operator">&gt;</span> 
     \u5F15\u7528\u8BA1\u6570<span class="token punctuation">(</span>c<span class="token punctuation">)</span>: <span class="token number">1</span>, \u5185\u5B58\u5730\u5740:0x1e465c15408			<span class="token operator">=</span><span class="token operator">&gt;</span> \u5907\u6CE8: \u5F15\u7528\u8BA1\u6570\u4E3A1\uFF0C\u4E14\u5185\u5B58\u5730\u5740\u4E0D\u4E00\u6837

-------------------------------------------------------------------
\u4EE3\u7801: a <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">1</span>, <span class="token number">2</span>, <span class="token number">3</span><span class="token punctuation">)</span>
\u8BF4\u660E: \u5F15\u7528\u8BA1\u6570<span class="token punctuation">(</span>a<span class="token punctuation">)</span>:3, \u5185\u5B58\u5730\u5740:0x1e46616cf48

\u4EE3\u7801: b <span class="token operator">=</span> a
\u8BF4\u660E: 
     \u5F15\u7528\u8BA1\u6570<span class="token punctuation">(</span>a<span class="token punctuation">)</span>: <span class="token number">4</span>, \u5185\u5B58\u5730\u5740:0x1e46616cf48
     \u5F15\u7528\u8BA1\u6570<span class="token punctuation">(</span>b<span class="token punctuation">)</span>: <span class="token number">4</span>, \u5185\u5B58\u5730\u5740:0x1e46616cf48

\u4EE3\u7801: del a
\u8BF4\u660E: \u5F15\u7528\u8BA1\u6570<span class="token punctuation">(</span>b<span class="token punctuation">)</span>: <span class="token number">3</span>, \u5185\u5B58\u5730\u5740:0x1e46616cf48

\u4EE3\u7801: c <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">1</span>, <span class="token number">2</span>, <span class="token number">3</span><span class="token punctuation">)</span>
     \u5F15\u7528\u8BA1\u6570<span class="token punctuation">(</span>b<span class="token punctuation">)</span>: <span class="token number">4</span>, \u5185\u5B58\u5730\u5740:0x1e46616cf48			<span class="token operator">=</span><span class="token operator">&gt;</span>
     \u5F15\u7528\u8BA1\u6570<span class="token punctuation">(</span>c<span class="token punctuation">)</span>: <span class="token number">4</span>, \u5185\u5B58\u5730\u5740:0x1e46616cf48			<span class="token operator">=</span><span class="token operator">&gt;</span> \u5907\u6CE8: \u5F15\u7528\u8BA1\u6570\u4E3A\u4E0D\u4E3A1\uFF0C\u4E14\u5185\u5B58\u5730\u5740\u4E00\u6837
</code></pre></div></details><p>\u{1F4A1} \u4E0D\u540CPython\u7248\u672C\u5BF9\u4E8E\u4E00\u4E9B\u7EC6\u8282\u5904\u7406\u5E76\u4E0D\u4E00\u81F4\uFF0C\u4E86\u89E3\u5373\u53EF</p><div class="language-python ext-py"><pre class="language-python"><code><span class="token comment">#!/usr/bin/env python</span>
<span class="token comment"># -*- coding:utf-8 -*-</span>

<span class="token keyword">import</span> sys

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Python version: {}&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token string">&#39;.&#39;</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token keyword">for</span> x <span class="token keyword">in</span> sys<span class="token punctuation">.</span>version_info<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># \u8FD9\u91CC\u4F7F\u75283.7.9\u6D4B\u8BD5</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&#39;----------------------------------------------------------------------------------------------------&#39;</span><span class="token punctuation">)</span>

<span class="token comment"># \u6D4B\u8BD51: -5 ~ 256\u8303\u6587\u5185\u7684\u6570\u5B57\u4F1A\u63D0\u524D\u52A0\u8F7D\u5230\u5185\u5B58\u4E2D,\u8FDB\u884C\u7F13\u5B58</span>
a<span class="token punctuation">,</span> b <span class="token operator">=</span> <span class="token number">1000</span><span class="token punctuation">,</span> <span class="token number">1000</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>a <span class="token keyword">is</span> b<span class="token punctuation">)</span>  <span class="token comment"># b\u521B\u5EFA\u4E4B\u524Da\u5C1A\u672A\u521B\u5EFA,\u6240\u4EE5a\u548Cb\u5206\u914D\u5230\u4E86\u4E24\u5757\u4E0D\u540C\u7684\u5185\u5B58\u5730\u5740,\u6240\u4EE5\u8F93\u51FAFalse</span>

a<span class="token punctuation">,</span> b <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>a <span class="token keyword">is</span> b<span class="token punctuation">)</span>  <span class="token comment"># b\u521B\u5EFA\u4E4B\u524Da\u5C1A\u672A\u521B\u5EFA, \u4F46\u662F-5~256\u8303\u56F4\u5185\u7684\u6570\u5B57\u5DF2\u7ECF\u63D0\u524D\u52A0\u8F7D\u5230\u4E86\u5185\u5B58\u4E2D, a\u548Cb\u62FF\u5230\u4E86\u76F8\u540C\u7684\u5185\u5B58\u5730\u5740,\u6240\u4EE5\u8F93\u51FATrue</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&#39;----------------------------------------------------------------------------------------------------&#39;</span><span class="token punctuation">)</span>
</code></pre></div>`,9),ps=s("\u5173\u4E8EPython\u66F4\u591A\u201C\u795E\u5947\u201D\u7684\u64CD\u4F5C\uFF0C\u53EF\u4EE5\u53C2\u8003 "),os={href:"https://github.com/robertparley/wtfpython-cn",target:"_blank",rel:"noopener noreferrer"},es=s("https://github.com/robertparley/wtfpython-cn"),cs=p(`<p><strong>\u5D4C\u5957\u95EE\u9898</strong></p><div class="language-python ext-py"><pre class="language-python"><code><span class="token comment">#!/usr/bin/env python</span>
<span class="token comment"># -*- coding:utf-8 -*-</span>

<span class="token comment"># a\u662F\u4E00\u4E2A\u5143\u7EC4, \u4E0D\u53EF\u53D8\u5BF9\u8C61</span>
a <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">hex</span><span class="token punctuation">(</span><span class="token builtin">id</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 0x2d731accf48</span>

<span class="token comment"># \u4F46\u662F\u5E76\u4E0D\u610F\u5473\u7740 a\u7684\u503C\u6C38\u8FDC\u5C31\u4E0D\u80FD\u53D8</span>
a<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">hex</span><span class="token punctuation">(</span><span class="token builtin">id</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 0x2d731accf48</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span>  <span class="token comment"># (1, 2, [3, 4])</span>
</code></pre></div><p><strong>\u5173\u4E8E\u54C8\u5E0C</strong></p><ul><li>\u53EF\u54C8\u5E0C == \u4E0D\u53EF\u53D8\u5BF9\u8C61</li><li>\u4E0D\u53EF\u54C8\u5E0C == \u53EF\u53D8\u5BF9\u8C61</li></ul><div class="language-python ext-py"><pre class="language-python"><code><span class="token comment">#!/usr/bin/env python</span>
<span class="token comment"># -*- coding:utf-8 -*-</span>

<span class="token comment"># \u6D4B\u8BD5</span>
d <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
d<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&quot;Python&quot;</span>
d<span class="token punctuation">[</span><span class="token number">5.0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&quot;Go&quot;</span>
d<span class="token punctuation">[</span><span class="token number">5.1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&quot;Java&quot;</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span>

<span class="token comment"># \u8F93\u51FA\u7ED3\u679C: {5: &#39;Go&#39;, 5.1: &#39;Java&#39;}</span>
<span class="token comment"># \u53D1\u73B0\u95EE\u9898: 5.0\u7684key\u600E\u4E48\u6CA1\u4E86?</span>
<span class="token comment"># \u5206\u6790\u539F\u56E0:</span>
<span class="token comment">#   (1) \u5B57\u5178\u7684key\u4E0D\u5141\u8BB8\u91CD\u590D,\u91CD\u590D\u7684\u8BDD\u4F1A\u8986\u76D6\u524D\u9762\u7684value</span>
<span class="token comment">#   (2) \u5B57\u5178\u5982\u4F55\u5224\u65ADkey\u662F\u5426\u91CD\u590D\u5462? \u4F7F\u7528hash(key)\u68C0\u67E5\u54C8\u5E0C\u503C\u662F\u5426\u91CD\u590D\u6765\u5224\u65AD(\u6269\u5C55: \u53EF\u53D8\u5BF9\u8C61==\u4E0D\u53EF\u54C8\u5E0C\uFF0C\u6240\u4EE5\u4E0D\u80FD\u7528\u6765\u505A\u5B57\u5178\u7684key)</span>
<span class="token comment"># \u786E\u8BA4\u539F\u56E0(\u770B\u5982\u4E0B\u4EE3\u7801)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">hash</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token builtin">hash</span><span class="token punctuation">(</span><span class="token number">5.0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># True</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">hash</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token builtin">hash</span><span class="token punctuation">(</span><span class="token number">5.1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># False</span>

<span class="token comment"># set\u548C frozenset\u4E5F\u662F\u4F7F\u7528\u54C8\u5E0C\u503C\u5B58\u7684,\u6211\u4EEC\u6765\u6D4B\u8BD5\u4EE5\u4E0B</span>
s <span class="token operator">=</span> <span class="token builtin">set</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
s<span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>
s<span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token number">5.0</span><span class="token punctuation">)</span>
s<span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token number">5.1</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span>  <span class="token comment"># {5.1, 5}</span>
</code></pre></div><p><strong>\u6DF1\u6D45\u62F7\u8D1D</strong></p><p>\u6D45\u62F7\u8D1D</p><p>\u8BF4\u660E\uFF1A\u62F7\u8D1D\u540E\u4EC5\u4EC5\u662F\u6700\u9876\u5C42\u5F00\u8F9F\u4E86\u65B0\u7684\u7A7A\u95F4\uFF0C\u91CC\u5C42\u7684\u5143\u7D20\u5185\u5B58\u5730\u5740\u8FD8\u662F\u4E00\u6837\u7684</p><p>\u65B9\u6CD5\uFF1A\u5404\u7C7B\u5BF9\u8C61(list<code>/dict</code>)\u7B49\u7684copy\u65B9\u6CD5\u3001\u5BF9\u8C61[::]\u3001copy.copy\u65B9\u6CD5</p><p>\u6DF1\u62F7\u8D1D</p><p>\u8BF4\u660E\uFF1A\u9664\u4E86\u9876\u5C42\u62F7\u8D1D\u8FD8\u5BF9\u5B50\u5143\u7D20\u4E5F\u8FDB\u884C\u4E86\u62F7\u8D1D\uFF08\u672C\u8D28\u4E0A\u9012\u5F52\u6D45\u62F7\u8D1D\uFF09\uFF0C\u4E24\u4E2A\u5143\u7D20\u771F\u6B63\u610F\u4E49\u4E0A\u7684\u4E92\u4E0D\u5F71\u54CD</p><p>\u65B9\u6CD5\uFF1Acopy.deepcopy()</p><h3 id="\u57FA\u672C\u6570\u636E\u7C7B\u578B\u5BF9\u6BD4" tabindex="-1"><a class="header-anchor" href="#\u57FA\u672C\u6570\u636E\u7C7B\u578B\u5BF9\u6BD4" aria-hidden="true">#</a> <strong>\u57FA\u672C\u6570\u636E\u7C7B\u578B\u5BF9\u6BD4</strong></h3><table><thead><tr><th>\u6570\u636E\u7C7B\u578B</th><th>(\u5BB9\u5668\u5185\u7684)\u5143\u7D20\u662F\u5426\u6709\u987A\u5E8F</th><th>\u662F\u5426\u662F\u53EF\u53D8\u5BF9\u8C61</th><th>\u503C\u6216KEY\u662F\u5426\u5141\u8BB8\u91CD\u590D</th></tr></thead><tbody><tr><td>\u6570\u5B57</td><td>\u2714</td><td>\u274C</td><td>\u2714</td></tr><tr><td>\u5E03\u5C14\u503C</td><td>\u2714</td><td>\u274C</td><td>\u2714</td></tr><tr><td>\u5217\u8868</td><td>\u2714</td><td>\u2714</td><td>\u2714</td></tr><tr><td>\u5143\u7956</td><td>\u2714</td><td>\u274C</td><td>\u2714</td></tr><tr><td>\u5B57\u7B26\u4E32</td><td>\u2714</td><td>\u274C</td><td>\u2714</td></tr><tr><td>\u5B57\u8282\u5E8F\u5217(bytes)</td><td>\u2714</td><td>\u274C</td><td>\u2714</td></tr><tr><td>\u5B57\u8282\u6570\u7EC4(bytesarray)</td><td>\u2714</td><td>\u2714</td><td>\u2714</td></tr><tr><td>\u5B57\u5178</td><td>\u2714</td><td>\u2714</td><td>\u274C</td></tr><tr><td>\u96C6\u5408</td><td>\u274C</td><td>\u2714</td><td>\u274C</td></tr><tr><td>\u4E0D\u53EF\u53D8\u96C6\u5408</td><td>\u274C</td><td>\u274C</td><td>\u274C</td></tr></tbody></table><h2 id="-1" tabindex="-1"><a class="header-anchor" href="#-1" aria-hidden="true">#</a></h2><h2 id="\u4E09\u3001\u51FD\u6570" tabindex="-1"><a class="header-anchor" href="#\u4E09\u3001\u51FD\u6570" aria-hidden="true">#</a> \u4E09\u3001\u51FD\u6570</h2><h3 id="\u51FD\u6570\u8BF4\u660E" tabindex="-1"><a class="header-anchor" href="#\u51FD\u6570\u8BF4\u660E" aria-hidden="true">#</a> \u51FD\u6570\u8BF4\u660E</h3><p>\u4F7F\u7528<code>def</code>\u5B9A\u4E49\u51FD\u6570\uFF0C<code>return</code>\u6307\u5B9A\u8FD4\u56DE\u503C\uFF0C\u82E5\u6CA1\u6709\u6307\u5B9A\u8FD4\u56DE\u503C\uFF0C\u4F1A\u9690\u5F0F\u8FD4\u56DE<code>return None</code>\uFF0C\u4E3E\u4F8B\u8BF4\u660E</p><div class="language-python ext-py"><pre class="language-python"><code><span class="token comment">#!/usr/bin/env python</span>
<span class="token comment"># --*-- coding:utf-8 --*--</span>

<span class="token keyword">def</span> <span class="token function">add</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> x <span class="token operator">+</span> y

<span class="token keyword">print</span><span class="token punctuation">(</span>add<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 3</span>
</code></pre></div><h3 id="\u51FD\u6570\u53C2\u6570" tabindex="-1"><a class="header-anchor" href="#\u51FD\u6570\u53C2\u6570" aria-hidden="true">#</a> \u51FD\u6570\u53C2\u6570</h3><h4 id="\u5E38\u89C1\u5F62\u5F0F\u548C\u5751" tabindex="-1"><a class="header-anchor" href="#\u5E38\u89C1\u5F62\u5F0F\u548C\u5751" aria-hidden="true">#</a> \u5E38\u89C1\u5F62\u5F0F\u548C\u5751</h4><div class="language-python ext-py"><pre class="language-python"><code><span class="token comment">#!/usr/bin/env python</span>
<span class="token comment"># --*-- coding:utf-8 --*--</span>

<span class="token comment"># \u5B9A\u4E49\u4E00\u4E2A\u65E0\u53C2\u51FD\u6570</span>
<span class="token keyword">def</span> <span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> <span class="token string">&quot;hello world!&quot;</span>
<span class="token comment"># ----------------------------------------------</span>
<span class="token comment"># \u6309\u4F4D\u7F6E\u4F20\u53C2\u548C\u6309\u5173\u952E\u5B57\u4F20\u53C2</span>

<span class="token comment"># \u5B9A\u4E49\u4E00\u4E2A\u666E\u901A\u51FD\u6570</span>
<span class="token keyword">def</span> <span class="token function">add</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> x <span class="token operator">+</span> y

<span class="token comment"># \u6309\u4F4D\u7F6E\u4F20\u53C2,1\u5BF9\u5E94\u5F62\u53C2x\uFF0C2\u5BF9\u5E94\u5F62\u53C2y\uFF1B\u4F4D\u7F6E\u5FC5\u987B\u4E00\u4E00\u5BF9\u5E94</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>add<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># \u6309\u5173\u952E\u5B57\u4F20\u53C2,\u5F62\u53C2\u4F20\u9012\u4F4D\u7F6E\u53EF\u4EE5\u4EFB\u610F\u8C03\u6362</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>add<span class="token punctuation">(</span>y<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span> x<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># ----------------------------------------------</span>
<span class="token comment"># \u9ED8\u8BA4\u53C2\u6570\uFF0C\u8C03\u7528\u65F6\u5982\u679C\u8BE5\u53C2\u6570\u6CA1\u6709\u4F20\u5219\u4F7F\u7528\u9ED8\u8BA4\u503C,\u6709\u9ED8\u8BA4\u503C\u5F97\u53C2\u6570\u4E00\u5B9A\u662F\u653E\u5230\u53C2\u6570\u6700\u540E\u9762\u7684\uFF0C\u5426\u5219\u4F1A\u62A5\u9519</span>
<span class="token keyword">def</span> <span class="token function">add</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> x <span class="token operator">+</span> y

<span class="token comment"># \u6CE8\u610F\uFF1A\u6CE8\u610F\u9ED8\u8BA4\u53C2\u6570\u503C\u4E0D\u8981\u7528 \u5F15\u7528\u7C7B\u578B\uFF0C\u6BD4\u5982\u4E0B\u9762\u8FD9\u79CD\u53EF\u80FD\u4E0E\u4F60\u7684\u9884\u671F\u5E76\u4E0D\u4E00\u81F4:</span>
<span class="token keyword">def</span> <span class="token function">add</span><span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
	x<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span>
	<span class="token keyword">return</span> x
        
<span class="token keyword">print</span><span class="token punctuation">(</span>add<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token comment"># [100]</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>add<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token comment"># [100, 100]</span>

<span class="token comment"># \u8FD9\u91CC\u6D89\u53CA\u5230\u4E24\u4E2A\u77E5\u8BC6\u70B9</span>
<span class="token comment"># (1) \u51FD\u6570\u7684\u9ED8\u8BA4\u53C2\u6570\u5B58\u50A8\u5728 .__defaults__\u5C5E\u6027\u4E2D\uFF0C\u5B83\u662F\u4E00\u4E2A\u5143\u7956</span>
<span class="token comment">#	  \u4E3A\u4EC0\u4E48\u662F\u5143\u7956\u5462\uFF1F\u56E0\u4E3A\u4ED6\u76F8\u5BF9\u5217\u8868\u548C\u5B57\u5178\u4F1A\u66F4\u8282\u7701\u5185\u5B58\u3002</span>
<span class="token comment"># 	  \u4E3A\u4EC0\u4E48\u4F1A\u66F4\u8282\u7701\u5185\u5B58\u5462\uFF1F</span>
<span class="token comment">#     \u56E0\u4E3A\u5143\u7956\u662F\u4E0D\u53EF\u53D8\u5BF9\u8C61\uFF0C\u5217\u8868\u548C\u5B57\u5178\u662F\u53EF\u53D8\u5BF9\u8C61\uFF0CPython\u521B\u5EFA\u5217\u8868\u7684\u65F6\u5019\u4F1A\u591A\u5206\u914D\u4E00\u4E9B\u5185\u5B58\uFF0C\u7528\u4E8E\u4EE5\u540E\u5FEB\u901F\u6269\u5145\uFF0C\u800C\u5143\u7956\u5728\u5B9A\u4E49\u65F6\u5C31\u786E\u5B9A\u5185\u5B58\u5927\u5C0F\u4E86</span>
<span class="token comment">#</span>
<span class="token comment"># (2) \u53EF\u53D8\u5BF9\u8C61\u548C\u4E0D\u53EF\u53D8\u5BF9\u8C61\u7684\u533A\u522B</span>
<span class="token comment">#	  \u5BF9\u4E00\u4E2A\u4E0D\u53EF\u53D8\u5BF9\u8C61\u53D8\u91CF\u6709\u4FEE\u6539\u64CD\u4F5C\u65F6\uFF0C\u4F1A\u91CD\u65B0\u5F00\u8F9F\u5185\u5B58\u7A7A\u95F4\uFF0C\u590D\u5236\u53D8\u91CF\u503C\u7136\u540E\u518D\u64CD\u4F5C</span>
<span class="token comment">#	  \u5BF9\u4E00\u4E2A\u53EF\u53D8\u5BF9\u8C61\u53D8\u91CF\u6709\u4FEE\u6539\u64CD\u4F5C\u65F6\uFF0C\u76F4\u63A5\u5728\u5BF9\u8C61\u6240\u5728\u5185\u5B58\u64CD\u4F5C</span>
<span class="token comment">#</span>
<span class="token comment"># \u6240\u4EE5\u8BF4\uFF0C\u51FD\u6570\u9ED8\u8BA4\u53C2\u6570\u4E3A\u4E0D\u53EF\u53D8\u5BF9\u8C61\u65F6\uFF0C\u51FD\u6570\u5185\u90E8\u5BF9\u9ED8\u8BA4\u53C2\u6570\u64CD\u4F5C\u4E0D\u4F1A\u5F71\u54CD\u5230.__defaults__\u4E2D\u7684\u503C\uFF0C\u4F46\u662F\u5982\u679C\u662F\u53EF\u53D8\u5BF9\u8C61\u6070\u6070\u76F8\u53CD\uFF0C</span>
<span class="token comment"># \u6240\u4EE5\u5C31\u6709\u4E0A\u9762\u7684\u7ED3\u679C\u4E86</span>
<span class="token comment">#</span>
<span class="token comment"># \u5E38\u89C4\u7684\u89E3\u51B3\u529E\u6CD5\uFF1A</span>
<span class="token keyword">def</span> <span class="token function">add1</span><span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> x <span class="token keyword">is</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
        x <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">100</span><span class="token punctuation">]</span>
    <span class="token keyword">return</span> x
<span class="token keyword">print</span><span class="token punctuation">(</span>add1<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># [100]</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>add1<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># [100]</span>

<span class="token comment"># \u53E6\u4E00\u79CD\u601D\u8DEF\u89E3\u51B3\u529E\u6CD5(\u8FD9\u79CD\u65B9\u5F0F\u6709bug\uFF0C\u675C\u7EDD\u4F7F\u7528\uFF0C\u4EC5\u5B66\u4E60\u6D4B\u8BD5)</span>
<span class="token keyword">def</span> <span class="token function">add2</span><span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># \u91CD\u65B0\u62F7\u8D1D\u4E00\u4EFD\uFF0C\u4E0D\u7136\u4F1A\u5BFC\u81F4\u5916\u8FB9\u7684\u53D8\u91CF\u53D1\u751F\u53D8\u5316</span>
    <span class="token comment"># \u56E0\u4E3A\u4F20\u9012\u7684\u662F\u53EF\u53D8\u5BF9\u8C61\uFF0C\u4FEE\u6539\u7684\u662F\u540C\u4E00\u4EFD\u5185\u5B58</span>
    x <span class="token operator">=</span> x<span class="token punctuation">.</span>copy<span class="token punctuation">(</span><span class="token punctuation">)</span>
    x<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span>
    add2<span class="token punctuation">.</span>__defaults__ <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">)</span>  <span class="token comment"># \u91CD\u65B0\u521D\u59CB\u5316\u9ED8\u8BA4\u53C2\u6570</span>
    <span class="token keyword">return</span> x
<span class="token keyword">print</span><span class="token punctuation">(</span>add2<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># [100]</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>add2<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># [100]</span>

<span class="token comment"># \u5F53\u7136\u4E86\uFF0C\u4E5F\u4E0D\u4E00\u5B9A\u975E\u8981\u53BB\u89E3\u51B3\uFF0C\u8FD9\u79CD\u5F62\u5F0F\u4F1A\u8BA9\u51FD\u6570\u53D8\u5F97\u6709\u72B6\u6001\uFF0C\u5FC5\u8981\u7684\u65F6\u5019\u4E5F\u53EF\u4EE5\u5229\u7528\u4E00\u4E0B\uFF0C</span>
<span class="token comment"># \u4F46\u662F\u80FD\u4E0D\u7528\u5C3D\u91CF\u4E0D\u7528\u8FD9\u79CD\u5F62\u5F0F\uFF0C\u5F88\u5BB9\u6613\u51FA\u9519</span>
<span class="token comment"># \u8BA9\u51FD\u6570\u53D8\u5F97\u6709\u72B6\u6001\u4E5F\u4E0D\u662F\u53EA\u6709\u8FD9\u4E00\u79CD\u5F62\u5F0F\uFF0C\u8FD8\u53EF\u4EE5\u5229\u7528\u95ED\u5305\uFF0C\u540E\u9762\u4F1A\u8BB2\u5230</span>
</code></pre></div><h4 id="\u53EF\u53D8\u53C2\u6570\u548C\u4E0D\u53EF\u53D8\u53C2\u6570" tabindex="-1"><a class="header-anchor" href="#\u53EF\u53D8\u53C2\u6570\u548C\u4E0D\u53EF\u53D8\u53C2\u6570" aria-hidden="true">#</a> \u53EF\u53D8\u53C2\u6570\u548C\u4E0D\u53EF\u53D8\u53C2\u6570</h4><p><code>*args</code>\u548C<code>**kwargs</code>\u8868\u793A\u53EF\u53D8\u53C2\u6570\uFF0C\u5728\u51FD\u6570\u5185\u90E8args\u662F\u4E00\u4E2A\u5143\u7956\uFF0Ckwargs\u662F\u4E00\u4E2A\u5B57\u5178</p><p>\u8FD9\u4E24\u4E2A\u53C2\u6570\u4E0D\u4F20\u9012\u7684\u8BDD\u5C31\u4F7F\u7528\u9ED8\u8BA4\u503C\uFF0C\u5373\u7A7A\u5143\u7956\u548C\u7A7A\u5B57\u5178</p><div class="language-python ext-py"><pre class="language-python"><code><span class="token comment">#!/usr/bin/env python</span>
<span class="token comment"># --*-- coding:utf-8 --*--</span>

<span class="token keyword">def</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>args<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>kwargs<span class="token punctuation">)</span>

add<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>  <span class="token comment"># args = (1,2,3,4)</span>
add<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># \u5982\u679C\u662F\u76F4\u63A5\u4F20\u9012\u4E00\u4E2A\u5143\u7956/\u5217\u8868\u7B49\uFF0C\u9700\u8981\u4F7F\u7528*\u89E3\u6784\uFF0C\u5C31\u7B49\u540C\u4E8E\u4E0A\u9762\u4F20\u9012\u7684\u5F62\u5F0F</span>

add<span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">&quot;VVFock3r&quot;</span><span class="token punctuation">,</span> language<span class="token operator">=</span><span class="token string">&quot;Python&quot;</span><span class="token punctuation">)</span>  <span class="token comment"># {&#39;name&#39;: &#39;VVFock3r&#39;, &#39;language&#39;: &#39;Python&#39;}</span>
add<span class="token punctuation">(</span><span class="token operator">**</span><span class="token punctuation">{</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;VVFock3r&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;language&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;Python&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span>  <span class="token comment"># \u540C\u7406\uFF0C\u5982\u679C\u76F4\u63A5\u4F20\u9012\u4E00\u4E2A\u5B57\u6BB5\uFF0C\u4F7F\u7528**\u89E3\u6784</span>
</code></pre></div><h4 id="\u4EC5\u9650\u4F4D\u7F6E\u5F62\u53C2-positional-only-\u548C\u4EC5\u9650\u5173\u952E\u5B57\u5F62\u53C2-keyword-only" tabindex="-1"><a class="header-anchor" href="#\u4EC5\u9650\u4F4D\u7F6E\u5F62\u53C2-positional-only-\u548C\u4EC5\u9650\u5173\u952E\u5B57\u5F62\u53C2-keyword-only" aria-hidden="true">#</a> \u4EC5\u9650\u4F4D\u7F6E\u5F62\u53C2(positional-only)\u548C\u4EC5\u9650\u5173\u952E\u5B57\u5F62\u53C2(keyword-only)</h4><p>\u4EC5\u9650\u4F4D\u7F6E\u5F62\u53C2\u5C31\u662F\u8BF4\u53EA\u80FD\u4F7F\u7528<code>add(1,2)</code>\u8FD9\u79CD\u5F62\u5F0F\u6765\u4F20\u9012\u53C2\u6570\uFF0C</p><p>\u4EC5\u9650\u5173\u952E\u5B57\u5F62\u53C2\u5C31\u662F\u53EA\u80FD\u4F7F\u7528<code>add(x=1, y=2)</code>\u6765\u8C03\u7528\u53C2\u6570\uFF08\u987A\u5E8F\u53EF\u4EFB\u610F\u8C03\u6574\uFF09</p><div class="language-python ext-py"><pre class="language-python"><code><span class="token comment">#!/usr/bin/env python</span>
<span class="token comment"># --*-- coding:utf-8 --*--</span>

<span class="token comment"># \u5728/\u524D\u9762\u7684\u90FD\u662F\u4EC5\u9650\u4F4D\u7F6E\u5F62\u53C2\uFF0Cpositional-only</span>
<span class="token keyword">def</span> <span class="token function">add1</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> <span class="token operator">/</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> x <span class="token operator">+</span> y

<span class="token keyword">print</span><span class="token punctuation">(</span>add1<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># \u7B26\u5408\u8BED\u6CD5\u8981\u6C42\uFF0C\u8F93\u51FA3</span>
<span class="token comment"># print(add1(x=1, 2))  # \u4E0D\u7B26\u5408\u8BED\u6CD5\u8981\u6C42\uFF0C\u62A5\u9519 SyntaxError: positional argument follows keyword argument</span>


<span class="token comment"># \u5728*\u540E\u9762\u7684\u90FD\u662F\u4EC5\u9650\u5173\u952E\u5B57\u5F62\u53C2\uFF0Ckeyword-only</span>
<span class="token keyword">def</span> <span class="token function">add2</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> x <span class="token operator">+</span> y

<span class="token keyword">print</span><span class="token punctuation">(</span>add2<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># \u7B26\u5408\u8BED\u6CD5\u8981\u6C42\uFF0C\u8F93\u51FA3</span>
<span class="token comment"># print(add2(1, 2))  # \u4E0D\u7B26\u5408\u8BED\u6CD5\u8981\u6C42\uFF0C\u62A5\u9519TypeError: add2() takes 0 positional arguments but 2 were given</span>
</code></pre></div><h4 id="\u770B\u4E00\u4E2A\u6BD4\u8F83\u590D\u6742\u7684\u51FD\u6570\u5B9A\u4E49" tabindex="-1"><a class="header-anchor" href="#\u770B\u4E00\u4E2A\u6BD4\u8F83\u590D\u6742\u7684\u51FD\u6570\u5B9A\u4E49" aria-hidden="true">#</a> \u770B\u4E00\u4E2A\u6BD4\u8F83\u590D\u6742\u7684\u51FD\u6570\u5B9A\u4E49</h4><div class="language-python ext-py"><pre class="language-python"><code><span class="token comment">#!/usr/bin/env python</span>
<span class="token comment"># --*-- coding:utf-8 --*--</span>

<span class="token comment"># \u4F60\u80FD\u4E00\u773C\u770B\u660E\u767D\u5982\u4F55\u8C03\u7528\u5417\uFF1F</span>
<span class="token keyword">def</span> <span class="token function">login</span><span class="token punctuation">(</span>host<span class="token punctuation">,</span> user<span class="token punctuation">,</span> password<span class="token punctuation">,</span> <span class="token operator">/</span><span class="token punctuation">,</span> <span class="token operator">*</span><span class="token punctuation">,</span> ssl<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;host=&quot;</span><span class="token punctuation">,</span> host<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;user=&quot;</span><span class="token punctuation">,</span> user<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;password=&quot;</span><span class="token punctuation">,</span> password<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;ssl=&quot;</span><span class="token punctuation">,</span> ssl<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;kwargs=&quot;</span><span class="token punctuation">,</span> kwargs<span class="token punctuation">)</span>
  

login<span class="token punctuation">(</span><span class="token string">&quot;127.0.0.1&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;root&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;123456&quot;</span><span class="token punctuation">,</span> ssl<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> port<span class="token operator">=</span><span class="token number">12345</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="\u51FD\u6570\u4F5C\u7528\u57DF\u548Clegb" tabindex="-1"><a class="header-anchor" href="#\u51FD\u6570\u4F5C\u7528\u57DF\u548Clegb" aria-hidden="true">#</a> \u51FD\u6570\u4F5C\u7528\u57DF\u548C<code>LEGB</code></h3><h4 id="\u4F5C\u7528\u57DF" tabindex="-1"><a class="header-anchor" href="#\u4F5C\u7528\u57DF" aria-hidden="true">#</a> \u4F5C\u7528\u57DF</h4><ul><li><p>\u51FD\u6570\u5185\u90E8\u5B9A\u4E49\u7684\u53D8\u91CF\u4E3A \u5C40\u90E8\u53D8\u91CF\uFF0C\u5728\u51FD\u6570\u5916\u90E8\u4E0D\u80FD\u76F4\u63A5\u4F7F\u7528</p></li><li><p>\u51FD\u6570\u5185\u90E8\u53EF\u4EE5\u4F7F\u7528 \u5168\u5C40\u53D8\u91CF\uFF0C\u4F46\u662F\u5177\u6709\u53EA\u8BFB\u5C5E\u6027\uFF0C\u5982\u679C\u9700\u8981\u4FEE\u6539 \u9700\u8981\u5148\u4F7F\u7528<code>global \u53D8\u91CF\u540D</code>\uFF0C\u5426\u5219\u4F1A\u62A5\u9519</p><p><code>UnboundLocalError: local variable &#39;x&#39; referenced before assignment</code></p></li><li><p>\u5982\u679C\u51FD\u6570<code>fn1</code>\u5185\u5B9A\u4E49\u4E00\u4E2A\u51FD\u6570<code>fn2</code>\uFF0C\u90A3\u4E48</p><ul><li><code>fn2</code>\u5BF9\u5168\u5C40\u53D8\u91CF\u548C<code>fn1</code>\u4E2D\u7684\u53D8\u91CF\u5177\u6709\u53EA\u8BFB\u5C5E\u6027</li><li><code>f2</code>\u8981\u4FEE\u6539\u5168\u5C40\u53D8\u91CF\u4F7F\u7528<code>global \u53D8\u91CF\u540D</code></li><li><code>f2</code>\u8981\u4FEE\u6539<code>f1</code>\u53D8\u91CF\u8981\u4F7F\u7528<code>nonlocal \u53D8\u91CF\u540D</code></li><li>\u5982\u679C<code>f2</code>\u4E2D\u7EE7\u7EED\u5D4C\u5957\u51FD\u6570\uFF0C\u90A3\u4E48\u89C4\u5219\u4E0E\u4E0A\u8FF0\u7C7B\u4F3C</li></ul></li></ul><div class="language-python ext-py"><pre class="language-python"><code><span class="token comment">#!/usr/bin/env python</span>
<span class="token comment"># --*-- coding:utf-8 --*--</span>

<span class="token comment"># \u5B9A\u4E49\u5168\u5C40\u53D8\u91CF</span>
x <span class="token operator">=</span> <span class="token number">100</span>


<span class="token comment"># \u5B9A\u4E49\u5916\u5C42\u51FD\u6570</span>
<span class="token keyword">def</span> <span class="token function">outer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># \u76F4\u63A5\u5B9A\u4E49\u7684\u8BDD\u6CA1\u95EE\u9898\uFF0C\u8FD9\u548C\u5168\u5C40\u53D8\u91CFx\u6CA1\u5173\u7CFB</span>
    <span class="token comment"># x = 1</span>

    <span class="token comment"># \u5982\u679C\u4E0A\u9762\u4EE3\u7801\u6CE8\u91CA\uFF0C\u51FD\u6570\u5185\u90E8\u6CA1\u6709\u5B9A\u4E49x\uFF0C\u76F4\u63A5\u4FEE\u6539\u5168\u5C40\u53D8\u91CFx\u4F1A\u62A5\u9519\uFF0C\u9700\u8981\u5148global x</span>
    <span class="token comment"># global x</span>
    <span class="token comment"># x = x + 100</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;outer: x=&quot;</span><span class="token punctuation">,</span> x<span class="token punctuation">)</span>

    a <span class="token operator">=</span> <span class="token number">1</span>

    <span class="token comment"># \u5B9A\u4E49\u5185\u5C42\u51FD\u6570</span>
    <span class="token keyword">def</span> <span class="token function">inner</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># \u4FEE\u6539\u5168\u5C40\u53D8\u91CF</span>
        <span class="token comment"># global x</span>
        <span class="token comment"># x = x + 200</span>

        <span class="token comment"># \u8BFB\u53D6\u5168\u5C40\u53D8\u91CF</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;inner: x=&quot;</span><span class="token punctuation">,</span> x<span class="token punctuation">)</span>

        <span class="token comment"># --------------------</span>

        <span class="token comment"># \u4FEE\u6539\u4E0A\u5C42\u51FD\u6570\u7684\u53D8\u91CF</span>
        <span class="token comment"># nonlocal a</span>
        <span class="token comment"># a = a + 1</span>

        <span class="token comment"># \u8BFB\u53D6\u4E0A\u5C42\u51FD\u6570\u7684\u53D8\u91CF</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;inner: a=&quot;</span><span class="token punctuation">,</span> a<span class="token punctuation">)</span>

    inner<span class="token punctuation">(</span><span class="token punctuation">)</span>


outer<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p>\u5982\u679C\u4E0A\u9762\u51FD\u6570\u90FD\u770B\u61C2\u4E86\u7684\u8BDD\uFF0C\u8FD8\u6709\u4E00\u4E2A\u95EE\u9898\u9700\u8981\u7279\u522B\u6CE8\u610F\uFF0C\u4E3A\u4E86\u65B9\u4FBF\u8D77\u89C1\u5199\u4E86\u4E00\u4E2A\u6700\u7B80\u5355\u7684\u5F62\u5F0F\uFF0C\u8BF7\u770B\u5982\u4E0B\u4EE3\u7801</p><div class="language-python ext-py"><pre class="language-python"><code><span class="token comment">#!/usr/bin/env python</span>
<span class="token comment"># --*-- coding:utf-8 --*--</span>

<span class="token comment"># \u5B9A\u4E49\u5168\u5C40\u53D8\u91CF</span>
x <span class="token operator">=</span> <span class="token number">100</span>

<span class="token keyword">def</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span>
    x <span class="token operator">=</span> <span class="token number">100</span>

test<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p>\u4E0A\u9762\u4EE3\u7801\u4F1A\u62A5\u9519<code>UnboundLocalError: local variable &#39;x&#39; referenced before assignment</code>\uFF0C\u8FD9\u662F\u4EC0\u4E48\u9B3C\u5462\uFF1F</p><p>\u56E0\u4E3A\u51FD\u6570\u5728\u5B9A\u4E49\u4E4B\u540E\uFF0C\u672A\u8C03\u7528\u4E4B\u524D\uFF0CPython\u89E3\u91CA\u5668\u5C31\u77E5\u9053\u4E86<code>print(x)</code>\u4E2Dx\u7528\u7684\u662F\u51FD\u6570\u5185\u90E8\u7684x\uFF0C\u56E0\u4E3A\u7B2C\u4E8C\u884C\u5B9A\u4E49\u4E86<code>x=100</code>\uFF0C</p><p>\u4F46\u662F\u7531\u4E8E\u662F\u5148\u4F7F\u7528\u540E\u5B9A\u4E49\uFF0C\u90A3\u5C31\u80AF\u5B9A\u4F1A\u62A5\u9519\u4E86\uFF0C\u6240\u4EE5\u6211\u4EEC\u9700\u8981\u6CE8\u610F\uFF0C\u5982\u679C\u51FD\u6570\u5185\u90E8\u8981\u5B9A\u4E49\u53D8\u91CF\u7684\u8BDD\uFF0C\u4E00\u5B9A\u8981\u5148\u5B9A\u4E49\u518D\u4F7F\u7528\uFF0C\u5F53\u7136\u4E86\uFF0C\u51FD\u6570\u5916\u90E8\u4E5F\u662F\u5148\u5B9A\u4E49\u518D\u4F7F\u7528</p><h4 id="\u601D\u8003\u9898-\u52A0\u6DF1\u7406\u89E3" tabindex="-1"><a class="header-anchor" href="#\u601D\u8003\u9898-\u52A0\u6DF1\u7406\u89E3" aria-hidden="true">#</a> \u601D\u8003\u9898-\u52A0\u6DF1\u7406\u89E3</h4><p>\u8BF7\u601D\u8003\u8FD9\u4E2A\u662F\u4E3A\u4EC0\u4E48\uFF1F\uFF0C\u5982\u679C\u4E0D\u660E\u767D\u53EF\u4EE5\u968F\u65F6\u8054\u7CFB\u6211</p><div class="language-python ext-py"><pre class="language-python"><code><span class="token comment">#!/usr/bin/env python</span>
<span class="token comment"># --*-- coding:utf-8 --*--</span>

<span class="token keyword">def</span> <span class="token function">outer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    c <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">100</span><span class="token punctuation">]</span>

    <span class="token keyword">def</span> <span class="token function">inner</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        c<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">100</span>  <span class="token comment"># \u53EF\u4EE5</span>
        <span class="token comment">#c.extend([1,2,3])  # \u53EF\u4EE5</span>
        <span class="token comment"># c = c + [1,2,3]    # \u4E0D\u53EF\u4EE5</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span>

    inner<span class="token punctuation">(</span><span class="token punctuation">)</span>

outer<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p>\u4F7F\u7528\u5D4C\u5957\u51FD\u6570\u540C\u6837\u53EF\u4EE5\u4FDD\u5B58\u51FD\u6570\u7684\u72B6\u6001\uFF0C\u81F3\u6B64\u5DF2\u7ECF\u6709\u4E24\u79CD\u65B9\u5F0F\u53EF\u4EE5\u4FDD\u5B58\u51FD\u6570\u72B6\u6001\uFF0C\u8BF7\u770B\u5982\u4E0B\u4EE3\u7801</p><div class="language-python ext-py"><pre class="language-python"><code><span class="token comment">#!/usr/bin/env python</span>
<span class="token comment"># --*-- coding:utf-8 --*--</span>

<span class="token comment"># \u65B9\u5F0F\u4E00</span>
<span class="token keyword">def</span> <span class="token function">fn</span><span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    x<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token operator">&gt;=</span> <span class="token number">2</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&#39;\u51FD\u6570\u5DF2\u7ECF\u8C03\u7528\u8FC7\u4E86&#39;</span><span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&#39;\u51FD\u6570\u7B2C\u4E00\u6B21\u8C03\u7528&#39;</span><span class="token punctuation">)</span>

fn<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># \u51FD\u6570\u7B2C\u4E00\u6B21\u8C03\u7528</span>
fn<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># \u51FD\u6570\u5DF2\u7ECF\u8C03\u7528\u8FC7\u4E86</span>
fn<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># \u51FD\u6570\u5DF2\u7ECF\u8C03\u7528\u8FC7\u4E86</span>

<span class="token comment"># \u65B9\u5F0F\u4E8C(\u63A8\u8350)</span>
<span class="token keyword">def</span> <span class="token function">fn1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    lock <span class="token operator">=</span> <span class="token boolean">False</span>

    <span class="token keyword">def</span> <span class="token function">fn2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">nonlocal</span> lock
        <span class="token keyword">if</span> lock <span class="token keyword">is</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&#39;\u51FD\u6570\u5DF2\u7ECF\u8C03\u7528\u8FC7\u4E86&#39;</span><span class="token punctuation">)</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            lock <span class="token operator">=</span> <span class="token boolean">True</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&#39;\u51FD\u6570\u7B2C\u4E00\u6B21\u8C03\u7528&#39;</span><span class="token punctuation">)</span>

    <span class="token keyword">return</span> fn2


fn2 <span class="token operator">=</span> fn1<span class="token punctuation">(</span><span class="token punctuation">)</span>
fn2<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># \u51FD\u6570\u7B2C\u4E00\u6B21\u8C03\u7528</span>
fn2<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># \u51FD\u6570\u5DF2\u7ECF\u8C03\u7528\u8FC7\u4E86</span>
fn2<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># \u51FD\u6570\u5DF2\u7ECF\u8C03\u7528\u8FC7\u4E86</span>
fn2<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># \u51FD\u6570\u5DF2\u7ECF\u8C03\u7528\u8FC7\u4E86</span>
</code></pre></div><h4 id="\u53D8\u91CF\u641C\u7D22\u987A\u5E8Flegb" tabindex="-1"><a class="header-anchor" href="#\u53D8\u91CF\u641C\u7D22\u987A\u5E8Flegb" aria-hidden="true">#</a> \u53D8\u91CF\u641C\u7D22\u987A\u5E8F<code>LEGB</code></h4><ul><li><code>Local</code> \u672C\u5730\u4F5C\u7528\u57DF</li><li><code>Enclosing</code> \u5D4C\u5957\u51FD\u6570\u7684\u5916\u90E8\u51FD\u6570\u7684\u547D\u540D\u7A7A\u95F4</li><li><code>Global</code> \u5168\u5C40\u4F5C\u7528\u57DF</li><li><code>Build-in</code> \u5185\u7F6E\u6A21\u5757\u547D\u540D\u7A7A\u95F4</li></ul><div class="language-python ext-py"><pre class="language-python"><code><span class="token comment">#!/usr/bin/env python</span>
<span class="token comment"># --*-- coding:utf-8 --*--</span>
<span class="token keyword">import</span> builtins

c <span class="token operator">=</span> <span class="token number">3</span>

<span class="token keyword">def</span> <span class="token function">fn1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    b <span class="token operator">=</span> <span class="token number">2</span>
    <span class="token keyword">def</span> <span class="token function">fn2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        a <span class="token operator">=</span> <span class="token number">1</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;\u672C\u5730\u4F5C\u7528\u57DF    a=&quot;</span><span class="token punctuation">,</span> a<span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;\u4E0A\u5C42\u51FD\u6570\u4F5C\u7528\u57DF b=&quot;</span><span class="token punctuation">,</span> b<span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;\u5168\u5C40\u4F5C\u7528\u57DF    c=&quot;</span><span class="token punctuation">,</span> c<span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;\u5185\u7F6E\u6A21\u5757\u547D\u540D\u7A7A\u95F4 builtins.dir == dir --&gt; &quot;</span><span class="token punctuation">,</span> builtins<span class="token punctuation">.</span><span class="token builtin">dir</span> <span class="token operator">==</span> <span class="token builtin">dir</span><span class="token punctuation">)</span>
    fn2<span class="token punctuation">(</span><span class="token punctuation">)</span>

fn1<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token triple-quoted-string string">&#39;&#39;&#39;
\u8F93\u51FA\u7ED3\u679C

\u672C\u5730\u4F5C\u7528\u57DF    a= 1
\u4E0A\u5C42\u51FD\u6570\u4F5C\u7528\u57DF b= 2
\u5168\u5C40\u4F5C\u7528\u57DF    c= 3
\u5185\u7F6E\u6A21\u5757\u547D\u540D\u7A7A\u95F4 builtins.dir == dir --&gt;  True
&#39;&#39;&#39;</span>
</code></pre></div><h3 id="\u7C7B\u578B\u6CE8\u89E3" tabindex="-1"><a class="header-anchor" href="#\u7C7B\u578B\u6CE8\u89E3" aria-hidden="true">#</a> \u7C7B\u578B\u6CE8\u89E3</h3><p>\u7C7B\u578B\u6CE8\u89E3\uFF0C\u7528\u6765\u8BF4\u660E\u53C2\u6570\u662F\u4F55\u79CD\u7C7B\u578B\u7684\u5BF9\u8C61\uFF0C\u8FD9\u53EA\u662F\u8BF4\u660E\uFF0C\u76EE\u7684\u662F\u65B9\u4FBF\u5F00\u53D1\u4EBA\u5458\uFF0C\u5E76\u4E0D\u662F\u5F3A\u5236\u4E00\u5B9A\u8981\u4F20\u5165\u6307\u5B9A\u7C7B\u578B\u7684\u5BF9\u8C61</p><p>\u51FD\u6570\u6CE8\u89E3\u4FE1\u606F\u4FDD\u5B58\u5728<code>__annotations__</code>\u5B57\u5178\u4E2D</p><div class="language-python ext-py"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">add</span><span class="token punctuation">(</span>x<span class="token punctuation">:</span><span class="token builtin">int</span><span class="token punctuation">,</span> y<span class="token punctuation">:</span><span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">int</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> x <span class="token operator">+</span> y

<span class="token keyword">print</span><span class="token punctuation">(</span>add<span class="token punctuation">.</span>__annotations__<span class="token punctuation">)</span>  <span class="token comment">#{&#39;x&#39;: &lt;class &#39;int&#39;&gt;, &#39;y&#39;: &lt;class &#39;int&#39;&gt;, &#39;return&#39;: &lt;class &#39;int&#39;&gt;}</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>add<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>     <span class="token comment"># \u6839\u636E\u6CE8\u89E3\u4F20\u5165\u5BF9\u5E94\u7C7B\u578B\u7684\u53C2\u6570\uFF0C3</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>add<span class="token punctuation">(</span><span class="token string">&#39;1&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;2&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># \u4F20\u5165\u4E0D\u540C\u7C7B\u578B\u53C2\u6570\u4E5F\u662F\u53EF\u4EE5\u7684\uFF0C\u975E\u5F3A\u5236\uFF0C12</span>
</code></pre></div><h3 id="\u51FD\u6570\u7B7E\u540D" tabindex="-1"><a class="header-anchor" href="#\u51FD\u6570\u7B7E\u540D" aria-hidden="true">#</a> \u51FD\u6570\u7B7E\u540D</h3><p>\u51FD\u6570\u7B7E\u540D\uFF0C\u8BF4\u767D\u4E86\u5C31\u662F\u63CF\u8FF0\u51FD\u6570\u53C2\u6570\u7684\u4E1C\u897F\uFF0C\u9664\u4E86\u5199\u6846\u67B6\u3001\u8C03\u8BD5\u5668\u7B49\uFF0C\u57FA\u672C\u4E0A\u6211\u4EEC\u4E5F\u7528\u4E0D\u5230</p><div class="language-python ext-py"><pre class="language-python"><code><span class="token comment">#!/usr/bin/env python</span>
<span class="token comment"># --*-- coding:utf-8 --*--</span>

<span class="token keyword">from</span> inspect <span class="token keyword">import</span> signature


<span class="token keyword">def</span> <span class="token function">login</span><span class="token punctuation">(</span>host<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">,</span> user<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">,</span> pwd<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">,</span> <span class="token operator">*</span><span class="token punctuation">,</span> port<span class="token operator">=</span><span class="token number">3306</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">str</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">&quot;&quot;&quot;\u6D4B\u8BD5\u51FD\u6570&quot;&quot;&quot;</span>
    <span class="token keyword">return</span> <span class="token string">&quot;ok&quot;</span>


sig <span class="token operator">=</span> signature<span class="token punctuation">(</span>login<span class="token punctuation">)</span>

<span class="token keyword">for</span> index<span class="token punctuation">,</span> item <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>sig<span class="token punctuation">.</span>parameters<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    name<span class="token punctuation">,</span> param <span class="token operator">=</span> item
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;\u53C2\u6570\u540D\u79F0: {}&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>param<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;\u9ED8\u8BA4\u53C2\u6570: {}&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token boolean">None</span> <span class="token keyword">if</span> param<span class="token punctuation">.</span>default <span class="token keyword">is</span> param<span class="token punctuation">.</span>empty <span class="token keyword">else</span> <span class="token builtin">str</span><span class="token punctuation">(</span>param<span class="token punctuation">.</span>default<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;\u53C2\u6570\u7C7B\u578B: {}&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>param<span class="token punctuation">.</span>kind<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;\u53C2\u6570\u6CE8\u89E3: {}&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token boolean">None</span> <span class="token keyword">if</span> param<span class="token punctuation">.</span>annotation <span class="token keyword">is</span> param<span class="token punctuation">.</span>empty <span class="token keyword">else</span> <span class="token builtin">str</span><span class="token punctuation">(</span>param<span class="token punctuation">.</span>annotation<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    
<span class="token triple-quoted-string string">&#39;&#39;&#39;
\u53C2\u6570\u540D\u79F0: host
\u9ED8\u8BA4\u53C2\u6570: None
\u53C2\u6570\u7C7B\u578B: POSITIONAL_OR_KEYWORD
\u53C2\u6570\u6CE8\u89E3: &lt;class &#39;str&#39;&gt;

\u53C2\u6570\u540D\u79F0: user
\u9ED8\u8BA4\u53C2\u6570: None
\u53C2\u6570\u7C7B\u578B: POSITIONAL_OR_KEYWORD
\u53C2\u6570\u6CE8\u89E3: &lt;class &#39;str&#39;&gt;

\u53C2\u6570\u540D\u79F0: pwd
\u9ED8\u8BA4\u53C2\u6570: None
\u53C2\u6570\u7C7B\u578B: POSITIONAL_OR_KEYWORD
\u53C2\u6570\u6CE8\u89E3: &lt;class &#39;str&#39;&gt;

\u53C2\u6570\u540D\u79F0: port
\u9ED8\u8BA4\u53C2\u6570: 3306
\u53C2\u6570\u7C7B\u578B: KEYWORD_ONLY
\u53C2\u6570\u6CE8\u89E3: None
&#39;&#39;&#39;</span>    
</code></pre></div><h3 id="\u533F\u540D\u51FD\u6570" tabindex="-1"><a class="header-anchor" href="#\u533F\u540D\u51FD\u6570" aria-hidden="true">#</a> \u533F\u540D\u51FD\u6570</h3><p>\u533F\u540D\u51FD\u6570\uFF0C\u987E\u540D\u601D\u4E49\uFF0C\u5C31\u662F\u6CA1\u6709\u540D\u5B57\u7684\u51FD\u6570\uFF0C\u4F7F\u7528<code>lambda</code>\u5B9A\u4E49</p><p>\u533F\u540D\u51FD\u6570\u901A\u5E38\u548C<code>filter</code>\u3001<code>map</code>\u3001<code>sorted</code>\u7B49\u9AD8\u9636\u51FD\u6570\u914D\u5408\u4F7F\u7528</p><p>\u533F\u540D\u51FD\u6570\u4E3E\u4F8B</p><div class="language-python ext-py"><pre class="language-python"><code><span class="token comment">#!/usr/bin/env python</span>
<span class="token comment"># --*-- coding:utf-8 --*--</span>

x <span class="token operator">=</span> <span class="token keyword">lambda</span> x<span class="token punctuation">:</span> x <span class="token operator">*</span> <span class="token number">2</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>x<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># 20</span>
</code></pre></div><p>\u533F\u540D\u51FD\u6570\u6CE8\u610F\u4E8B\u9879</p><div class="language-python ext-py"><pre class="language-python"><code><span class="token comment">#!/usr/bin/env python</span>
<span class="token comment"># --*-- coding:utf-8 --*--</span>

<span class="token comment"># \u6CE8\u610F\u53EF\u80FD\u4F1A\u9047\u5230\u7684\u95EE\u9898</span>
x <span class="token operator">=</span> <span class="token number">10</span>
a <span class="token operator">=</span> <span class="token keyword">lambda</span> y<span class="token punctuation">:</span> x <span class="token operator">+</span> y
x <span class="token operator">=</span> <span class="token number">20</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>a<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 20\uFF0C\u56E0\u4E3Alambda\u4E2D\u7684x\u4E3A\u81EA\u6709\u53D8\u91CF\uFF0C\u5728\u8FD0\u884C\u65F6\u624D\u4F1A\u8FDB\u884C\u7ED1\u5B9A</span>

<span class="token comment"># \u5982\u679C\u5E0C\u671B\u5728\u5B9A\u4E49\u7684\u65F6\u5019\u7ED1\u5B9A\uFF0C\u90A3\u4E48\u53EF\u4EE5\u8FD9\u6837\u505A</span>
z <span class="token operator">=</span> <span class="token number">10</span>
b <span class="token operator">=</span> <span class="token keyword">lambda</span> y<span class="token punctuation">,</span> z<span class="token operator">=</span>z<span class="token punctuation">:</span> z <span class="token operator">+</span> y
z <span class="token operator">=</span> <span class="token number">20</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>b<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 10</span>
</code></pre></div><h3 id="\u5185\u7F6E\u51FD\u6570" tabindex="-1"><a class="header-anchor" href="#\u5185\u7F6E\u51FD\u6570" aria-hidden="true">#</a> \u5185\u7F6E\u51FD\u6570</h3>`,64),ls=s("\u53C2\u8003 "),us={href:"https://docs.python.org/zh-cn/3/library/functions.html",target:"_blank",rel:"noopener noreferrer"},is=s("https:"),ks=n("code",null,"//docs",-1),rs=s(".python.org"),ds=n("code",null,"/zh-cn/3/library/functions",-1),ms=s(".html"),gs=p(`<h3 id="\u5185\u7F6E\u51FD\u6570\u5E93-functools" tabindex="-1"><a class="header-anchor" href="#\u5185\u7F6E\u51FD\u6570\u5E93-functools" aria-hidden="true">#</a> \u5185\u7F6E\u51FD\u6570\u5E93 <code>functools</code></h3><h4 id="reduce" tabindex="-1"><a class="header-anchor" href="#reduce" aria-hidden="true">#</a> reduce</h4><p>\u7528\u4F20\u7ED9 reduce \u4E2D\u7684\u51FD\u6570 function\uFF08\u6709\u4E24\u4E2A\u53C2\u6570\uFF09\u5148\u5BF9\u96C6\u5408\u4E2D\u7684\u7B2C 1\u30012 \u4E2A\u5143\u7D20\u8FDB\u884C\u64CD\u4F5C\uFF0C</p><p>\u5F97\u5230\u7684\u7ED3\u679C\u518D\u4E0E\u7B2C\u4E09\u4E2A\u6570\u636E\u7528 function \u51FD\u6570\u8FD0\u7B97\uFF0C\u6700\u540E\u5F97\u5230\u4E00\u4E2A\u7ED3\u679C</p><div class="language-python ext-py"><pre class="language-python"><code><span class="token comment">#!/usr/bin/env python</span>
<span class="token comment"># --*-- coding:utf-8 --*--</span>

<span class="token keyword">from</span> functools <span class="token keyword">import</span> <span class="token builtin">reduce</span>

<span class="token keyword">def</span> <span class="token function">add</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> x <span class="token operator">+</span> y

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">reduce</span><span class="token punctuation">(</span>add<span class="token punctuation">,</span> <span class="token punctuation">[</span>x <span class="token keyword">for</span> x <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">101</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># 5050</span>
</code></pre></div><h4 id="partial" tabindex="-1"><a class="header-anchor" href="#partial" aria-hidden="true">#</a> partial</h4><div class="language-python ext-py"><pre class="language-python"><code><span class="token comment">#!/usr/bin/env python</span>
<span class="token comment"># --*-- coding:utf-8 --*--</span>

<span class="token keyword">from</span> functools <span class="token keyword">import</span> partial


<span class="token comment"># @functools.wraps()              # \u53C2\u8003\u88C5\u9970\u5668\u90E8\u5206</span>
<span class="token comment"># functools.update_wrapper()      # \u53C2\u8003\u88C5\u9970\u5668\u90E8\u5206</span>

<span class="token comment"># partial \u504F\u51FD\u6570\uFF0C\u8F93\u5165\u4E00\u4E2A\u51FD\u6570\u548C\u8BE5\u51FD\u6570\u7684\u53C2\u6570\uFF0C\u5E76\u56FA\u5B9A\u4E0B\u6765\u8FD4\u56DE\u4E00\u4E2A\u65B0\u51FD\u6570; \u548C\u67EF\u91CC\u5316\u5F88\u76F8\u4F3C\uFF0C\u662F\u4E0D\u662F</span>

<span class="token keyword">def</span> <span class="token function">add</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> x <span class="token operator">+</span> y


new1 <span class="token operator">=</span> partial<span class="token punctuation">(</span>add<span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>  <span class="token comment"># \u8FD4\u56DE\u4E00\u4E2A\u65B0\u51FD\u6570</span>
new2 <span class="token operator">=</span> partial<span class="token punctuation">(</span>add<span class="token punctuation">,</span> x<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>  <span class="token comment"># \u8FD4\u56DE\u4E00\u4E2A\u65B0\u51FD\u6570</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>new1<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 3</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>new2<span class="token punctuation">(</span>y<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 3</span>
</code></pre></div><h4 id="partialmethod" tabindex="-1"><a class="header-anchor" href="#partialmethod" aria-hidden="true">#</a> partialmethod</h4><p>\u548Cpartial\u7C7B\u4F3C\uFF0Cpartial\u7528\u4E8E\u666E\u901A\u51FD\u6570\uFF0C<code>partialmethod</code>\u7528\u4E8E\u7C7B\u65B9\u6CD5</p><h4 id="cached-property" tabindex="-1"><a class="header-anchor" href="#cached-property" aria-hidden="true">#</a> cached_property</h4><p>\u8BA1\u7B97\u8FC7\u540E\u4FBF\u88AB\u7F13\u5B58</p><div class="language-python ext-py"><pre class="language-python"><code><span class="token comment">#!/usr/bin/env python</span>
<span class="token comment"># --*-- coding:utf-8 --*--</span>

<span class="token keyword">from</span> functools <span class="token keyword">import</span> cached_property
<span class="token keyword">import</span> random


<span class="token keyword">class</span> <span class="token class-name">Test</span><span class="token punctuation">:</span>

    <span class="token decorator annotation punctuation">@cached_property</span>
    <span class="token comment"># @property</span>
    <span class="token keyword">def</span> <span class="token function">test</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> random<span class="token punctuation">.</span>random<span class="token punctuation">(</span><span class="token punctuation">)</span>


t <span class="token operator">=</span> Test<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>t<span class="token punctuation">.</span>test<span class="token punctuation">)</span>  <span class="token comment"># 0.0832563719467786</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>t<span class="token punctuation">.</span>test<span class="token punctuation">)</span>  <span class="token comment"># 0.0832563719467786</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>t<span class="token punctuation">.</span>test <span class="token operator">==</span> t<span class="token punctuation">.</span>test<span class="token punctuation">)</span>  <span class="token comment"># True</span>
</code></pre></div><h4 id="lru-cache" tabindex="-1"><a class="header-anchor" href="#lru-cache" aria-hidden="true">#</a> lru_cache</h4><ul><li>lru\u662F\u4EC0\u4E48\uFF1FLRU\u662FLeast Recently Used\u7684\u7F29\u5199\uFF0C\u5373\u6700\u8FD1\u6700\u5C11\u4F7F\u7528\uFF0C\u662F\u4E00\u79CD\u5E38\u7528\u7684\u9875\u9762\u7F6E\u6362\u7B97\u6CD5</li><li>\u51FD\u6570\u7B7E\u540D\uFF1Alru_cache(maxsize=128, typed=False)</li><li>maxsize\u4EE3\u8868\u6700\u5927\u53EF\u4EE5\u7F13\u5B58128\u4E2A\uFF0C\u5982\u679C\u8BBE\u7F6E\u4E3ANone\u4EE3\u8868\u7981\u7528LRU\u529F\u80FD\uFF0C\u5E76\u4E14\u7F13\u5B58\u53EF\u4EE5\u65E0\u9650\u589E\u957F\uFF0C\u8BBE\u7F6E\u4E3A2\u7684\u5E42\u65F6\u6027\u80FD\u6700\u597D</li><li>typed \u5982\u679C\u8BBE\u7F6E\u4E3ATrue\uFF0C\u5219\u4E0D\u540C\u7C7B\u578B\u7684\u51FD\u6570\u53C2\u6570\u5C06\u5355\u72EC\u7F13\u5B58\uFF0C\u6BD4\u5982f(3)\u548Cf(3.0)\u5C06\u88AB\u5206\u522B\u7F13\u5B58</li></ul><div class="language-python ext-py"><pre class="language-python"><code><span class="token comment">#!/usr/bin/env python</span>
<span class="token comment"># --*-- coding:utf-8 --*--</span>

<span class="token keyword">from</span> functools <span class="token keyword">import</span> lru_cache

<span class="token decorator annotation punctuation">@lru_cache</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">fib</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> <span class="token number">1</span> <span class="token keyword">if</span> n <span class="token operator">&lt;</span> <span class="token number">2</span> <span class="token keyword">else</span> fib<span class="token punctuation">(</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> fib<span class="token punctuation">(</span>n <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>fib<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="cmp-to-key" tabindex="-1"><a class="header-anchor" href="#cmp-to-key" aria-hidden="true">#</a> cmp_to_key</h4><p>\u6BD4\u8F83\u51FD\u6570\uFF0C\u9700\u4F20\u5165\u4E24\u4E2A\u503Cx\uFF0Cy\uFF0C\u5F53x &gt; y\u65F6\u8FD4\u56DE1\uFF0C\u7B49\u4E8E\u65F6\u8FD4\u56DE0\uFF0C\u5426\u5219\u8FD4\u56DE-1</p><div class="language-python ext-py"><pre class="language-python"><code><span class="token comment">#!/usr/bin/env python</span>
<span class="token comment"># --*-- coding:utf-8 --*--</span>

<span class="token keyword">from</span> functools <span class="token keyword">import</span> cmp_to_key

nums <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">34</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">]</span>
new_nums <span class="token operator">=</span> <span class="token builtin">sorted</span><span class="token punctuation">(</span>nums<span class="token punctuation">,</span> key<span class="token operator">=</span>cmp_to_key<span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">,</span> y<span class="token punctuation">:</span> y <span class="token operator">-</span> x<span class="token punctuation">)</span><span class="token punctuation">)</span>
new_nums2 <span class="token operator">=</span> <span class="token builtin">sorted</span><span class="token punctuation">(</span>nums<span class="token punctuation">,</span> key<span class="token operator">=</span>cmp_to_key<span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">,</span> y<span class="token punctuation">:</span> x <span class="token operator">-</span> y<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>new_nums<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>new_nums2<span class="token punctuation">)</span>
<span class="token comment"># \u7ED3\u679C:</span>
<span class="token comment"># [34, 30, 9, 5, 3]</span>
<span class="token comment"># [3, 5, 9, 30, 34]</span>
</code></pre></div><h4 id="total-ordering" tabindex="-1"><a class="header-anchor" href="#total-ordering" aria-hidden="true">#</a> total_ordering</h4><p>\u7C7B\u88C5\u9970\u5668\uFF0C\u5B9E\u73B0\u5176\u4E2D\u4E00\u4E2A\uFF1A <code>__lt__()</code>, <code>__le__()</code>, <code>__gt__()</code>, <code>__ge__()</code>\uFF0C\u81EA\u52A8\u5B9E\u73B0\u5269\u4F59\u65B9\u6CD5</p><p>\u8981\u6C42\u6B64\u7C7B\u9700\u8981\u5B9E\u73B0<code>__eq__</code></p><div class="language-python ext-py"><pre class="language-python"><code><span class="token comment">#!/usr/bin/env python</span>
<span class="token comment"># --*-- coding:utf-8 --*--</span>

<span class="token keyword">from</span> functools <span class="token keyword">import</span> total_ordering


<span class="token decorator annotation punctuation">@total_ordering</span>
<span class="token keyword">class</span> <span class="token class-name">Point</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>x <span class="token operator">=</span> x
        self<span class="token punctuation">.</span>y <span class="token operator">=</span> y

    <span class="token keyword">def</span> <span class="token function">__eq__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> other<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> self<span class="token punctuation">.</span>x <span class="token operator">==</span> other<span class="token punctuation">.</span>x <span class="token keyword">and</span> self<span class="token punctuation">.</span>y <span class="token operator">==</span> other<span class="token punctuation">.</span>y

    <span class="token keyword">def</span> <span class="token function">__lt__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> other<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span>self<span class="token punctuation">.</span>x<span class="token punctuation">,</span> self<span class="token punctuation">.</span>y<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token punctuation">(</span>other<span class="token punctuation">.</span>x<span class="token punctuation">,</span> other<span class="token punctuation">.</span>y<span class="token punctuation">)</span>

a <span class="token operator">=</span> Point<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
b <span class="token operator">=</span> Point<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
c <span class="token operator">=</span> Point<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>a <span class="token operator">&lt;</span> b<span class="token punctuation">)</span>  <span class="token comment"># True</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>b <span class="token operator">&gt;</span> c<span class="token punctuation">)</span>  <span class="token comment"># True</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>c <span class="token operator">==</span> a<span class="token punctuation">)</span>  <span class="token comment"># True</span>
</code></pre></div><h3 id="\u9012\u5F52\u51FD\u6570" tabindex="-1"><a class="header-anchor" href="#\u9012\u5F52\u51FD\u6570" aria-hidden="true">#</a> \u9012\u5F52\u51FD\u6570</h3><ul><li><p>Python\u5BF9\u9012\u5F52\u6DF1\u5EA6\u505A\u4E86\u9650\u5236\uFF0C\u4EE5\u4FDD\u62A4\u89E3\u91CA\u5668\uFF0C\u8D85\u8FC7\u9650\u5236\u629B\u51FA<code>RecursionError:maxinum recursion depth exceeded</code></p></li><li><p>\u4F7F\u7528<code>sys.getrecursionlimit()</code>\u83B7\u53D6\u9012\u5F52\u6DF1\u5EA6\uFF0C\u9ED8\u8BA4\u4E3A<code>1000</code>\uFF1B</p></li><li><p><code>\u4F7F\u7528sys.setrecursionlimit(n)\u8BBE\u7F6E\u9012\u5F52\u6DF1\u5EA6</code>\uFF0C\u6CE8\u610F\u4E0D\u8981\u8BBE\u7F6E\u7684\u592A\u5927\uFF0C\u5426\u5219\u4F1A\u5BFC\u81F4\u6808\u6EA2\u51FA\uFF0C</p><p>\u62A5\u9519<code>OverflowError: signed integer \`\`is</code> <code>greater than maximum</code></p></li></ul><p>\u4E00\u4E2A\u9012\u5F52+\u7F13\u5B58\u7248\u7684\u8D39\u5E03\u90A3\u5207\u6570\u5217</p><div class="language-python ext-py"><pre class="language-python"><code><span class="token comment">#!/usr/bin/env python</span>
<span class="token comment"># --*-- coding:utf-8 --*--</span>

<span class="token keyword">def</span> <span class="token function">fib</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span> cache<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> cache <span class="token keyword">is</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
        cache <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token keyword">if</span> n <span class="token keyword">in</span> cache<span class="token punctuation">:</span>
        <span class="token keyword">return</span> cache<span class="token punctuation">[</span>n<span class="token punctuation">]</span>

    <span class="token keyword">if</span> n <span class="token operator">&lt;</span> <span class="token number">2</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token number">1</span>
    cache<span class="token punctuation">[</span>n<span class="token punctuation">]</span> <span class="token operator">=</span> fib<span class="token punctuation">(</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> cache<span class="token punctuation">)</span> <span class="token operator">+</span> fib<span class="token punctuation">(</span>n <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">,</span> cache<span class="token punctuation">)</span>
    <span class="token keyword">return</span> cache<span class="token punctuation">[</span>n<span class="token punctuation">]</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>fib<span class="token punctuation">(</span><span class="token number">998</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="\u9AD8\u9636\u51FD\u6570" tabindex="-1"><a class="header-anchor" href="#\u9AD8\u9636\u51FD\u6570" aria-hidden="true">#</a> \u9AD8\u9636\u51FD\u6570</h3><p>\u9AD8\u9636\u51FD\u6570\u6307\u7684\u662F\u53EF\u4EE5\u5C06\u4E00\u4E2A\u51FD\u6570\u4F5C\u4E3A\u4E00\u4E2A\u5F62\u53C2\u4F20\u9012\u7ED9\u4E00\u4E2A\u51FD\u6570 \u6216 \u8FD4\u56DE\u503C\u662F\u4E00\u4E2A\u51FD\u6570\uFF0C\u8FD9\u4E2A\u51FD\u6570\u5C31\u79F0\u4E3A\u9AD8\u9636\u51FD\u6570</p><h4 id="sorted" tabindex="-1"><a class="header-anchor" href="#sorted" aria-hidden="true">#</a> sorted</h4><p>sorted \u6392\u5E8F\u51FD\u6570\uFF0Ckey\u6307\u5B9A\u81EA\u5B9A\u4E49\u6392\u5E8F\u89C4\u5219\uFF0Creverse\u53EF\u4EE5\u53CD\u8F6C\u7ED3\u679C\uFF0C\u8FD4\u56DE\u5217\u8868</p><p>\u51FD\u6570\u7B7E\u540D</p><div class="language-python ext-py"><pre class="language-python"><code><span class="token builtin">sorted</span><span class="token punctuation">(</span>iterable<span class="token punctuation">,</span> <span class="token operator">/</span><span class="token punctuation">,</span> <span class="token operator">*</span><span class="token punctuation">,</span> key<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> reverse<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
</code></pre></div><p>\u793A\u4F8B</p><div class="language-python ext-py"><pre class="language-python"><code><span class="token comment">#!/usr/bin/env python</span>
<span class="token comment"># --*-- coding:utf-8 --*--</span>

L <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token string">&#39;b&#39;</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">&#39;a&#39;</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">&#39;c&#39;</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">&#39;d&#39;</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">]</span>

<span class="token comment"># \u6392\u5E8F\uFF0C\u9ED8\u8BA4\u60C5\u51B5\u4E0B\u6309\u7167ASCII\u6392\u5E8F</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">sorted</span><span class="token punctuation">(</span>L<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># [(&#39;a&#39;, 3), (&#39;b&#39;, 2), (&#39;c&#39;, 3), (&#39;d&#39;, 4)]</span>

<span class="token comment"># \u81EA\u5B9A\u4E49\u6392\u5E8F\u89C4\u5219\uFF0C\u6839\u636E\u5143\u7956\u7D22\u5F15\u4E3A1\u7684\u6392\u5E8F\uFF0C\u6216\u8005\u8BF4\u6839\u636E\u5B57\u5178(\u5143\u7956\u8F6C\u4E3A\u5B57\u5178)\u7684value\u6392\u5E8F</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">sorted</span><span class="token punctuation">(</span>L<span class="token punctuation">,</span> key<span class="token operator">=</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> x<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># [(&#39;b&#39;, 2), (&#39;a&#39;, 3), (&#39;c&#39;, 3), (&#39;d&#39;, 4)]</span>

<span class="token comment"># \u5982\u679C\u7B2C\u4E00\u6B21\u6392\u5E8F\u6709\u76F8\u540C\u7684\uFF0C\u5373x[1]\u76F8\u540C\uFF0C\u90A3\u4E48\u6309\u7167x[0]\u6392\u5E8F</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">sorted</span><span class="token punctuation">(</span>L<span class="token punctuation">,</span> key<span class="token operator">=</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> <span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> x<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># [(&#39;b&#39;, 2), (&#39;a&#39;, 3), (&#39;c&#39;, 3), (&#39;d&#39;, 4)]</span>

<span class="token comment"># \u5982\u679Cx[0]\u6211\u60F3\u6309\u5012\u5E8F\u6392\u5E8F\uFF0C\u90A3\u4E48\u53EF\u4EE5\u8FD9\u6837\u505A</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">sorted</span><span class="token punctuation">(</span>L<span class="token punctuation">,</span> key<span class="token operator">=</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> <span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token builtin">ord</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># [(&#39;b&#39;, 2), (&#39;c&#39;, 3), (&#39;a&#39;, 3), (&#39;d&#39;, 4)]</span>
</code></pre></div><p>\u4EFF\u5199sorted\u51FD\u6570</p><div class="language-python ext-py"><pre class="language-python"><code><span class="token comment">#!/usr/bin/env python</span>
<span class="token comment"># --*-- coding:utf-8 --*--</span>

<span class="token keyword">def</span> <span class="token function">sorted</span><span class="token punctuation">(</span>iterable<span class="token punctuation">,</span> <span class="token operator">*</span><span class="token punctuation">,</span> key<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> reverse<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> key <span class="token keyword">is</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
        key <span class="token operator">=</span> <span class="token keyword">lambda</span> x<span class="token punctuation">:</span> x

    <span class="token comment"># \u4FDD\u5B58\u6392\u5E8F\u597D\u7684\u6570\u636E</span>
    ret <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>

    <span class="token comment"># \u8FED\u4EE3\u5BF9\u8C61</span>
    <span class="token keyword">for</span> z <span class="token keyword">in</span> iterable<span class="token punctuation">:</span>

        <span class="token comment"># \u8FED\u4EE3\u5DF2\u6392\u597D\u5E8F\u7684\u6570\u636E</span>
        <span class="token keyword">for</span> x<span class="token punctuation">,</span> y <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>ret<span class="token punctuation">)</span><span class="token punctuation">:</span>

            <span class="token comment"># \u7ED3\u679C\u53CD\u8F6C\u90E8\u5206</span>
            flag <span class="token operator">=</span> key<span class="token punctuation">(</span>z<span class="token punctuation">)</span> <span class="token operator">&gt;</span> key<span class="token punctuation">(</span>y<span class="token punctuation">)</span> <span class="token keyword">if</span> reverse <span class="token keyword">else</span> key<span class="token punctuation">(</span>z<span class="token punctuation">)</span> <span class="token operator">&lt;</span> key<span class="token punctuation">(</span>y<span class="token punctuation">)</span>
            <span class="token keyword">if</span> flag<span class="token punctuation">:</span>
                ret<span class="token punctuation">.</span>insert<span class="token punctuation">(</span>x<span class="token punctuation">,</span> z<span class="token punctuation">)</span>
                <span class="token keyword">break</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            ret<span class="token punctuation">.</span>append<span class="token punctuation">(</span>z<span class="token punctuation">)</span>
    <span class="token keyword">return</span> ret
</code></pre></div><h4 id="filter" tabindex="-1"><a class="header-anchor" href="#filter" aria-hidden="true">#</a> filter</h4><p>filter \u7B5B\u9009\u6307\u5B9A\u5143\u7D20\uFF0C\u51FD\u6570\u53EF\u4EE5\u4E3ANone\u65F6\u4EE3\u8868\u4ECE\u5E8F\u5217\u4E2D\u7B5B\u9009\u51FA\u4E3A\u771F\u7684\u5143\u7D20\uFF0C\u8FD4\u56DE\u4E00\u4E2Afilter\u5BF9\u8C61</p><p>\u4F7F\u7528filter\u8FC7\u6EE4\u540E\uFF0C\u8FD4\u56DE\u65B0\u7684\u5143\u7D20\u4E2A\u6570\u53EF\u80FD\u4F1A\u51CF\u5C11</p><p>\u51FD\u6570\u7B7E\u540D</p><div class="language-python ext-py"><pre class="language-python"><code><span class="token builtin">filter</span><span class="token punctuation">(</span>function <span class="token keyword">or</span> <span class="token boolean">None</span><span class="token punctuation">,</span> iterable<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">filter</span> <span class="token builtin">object</span>
</code></pre></div><p>\u793A\u4F8B</p><div class="language-python ext-py"><pre class="language-python"><code><span class="token comment">#!/usr/bin/env python</span>
<span class="token comment"># --*-- coding:utf-8 --*--</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">filter</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># [1, 2, 3, 4, 5, 6, 7, 8, 9]</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">filter</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> x <span class="token operator">%</span> <span class="token number">3</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># [0, 3, 6, 9, 12, 15, 18]</span>
</code></pre></div><p>\u4EFF\u5199filter</p><div class="language-python ext-py"><pre class="language-python"><code><span class="token comment">#!/usr/bin/env python</span>
<span class="token comment"># --*-- coding:utf-8 --*--</span>

<span class="token keyword">def</span> <span class="token function">filter</span><span class="token punctuation">(</span>fn<span class="token punctuation">,</span> iterable<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> fn <span class="token keyword">is</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
        fn <span class="token operator">=</span> <span class="token builtin">bool</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> iterable<span class="token punctuation">:</span>
        <span class="token keyword">if</span> fn<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">yield</span> i
</code></pre></div><h4 id="map" tabindex="-1"><a class="header-anchor" href="#map" aria-hidden="true">#</a> map</h4><p>\u5C06\u5E8F\u5217\u7684\u6BCF\u4E2A\u5143\u7D20\u90FD\u4F5C\u7528\u5728\u51FD\u6570\u4E0A\uFF0C\u8FD4\u56DE\u4E00\u4E2Amap object</p><p>\u4F7F\u7528map\u540E\uFF0C\u65B0\u5BF9\u8C61\u7684\u5143\u7D20\u4E2A\u6570\u4E0D\u4F1A\u53D8\uFF0C\u503C\u4E00\u822C\u90FD\u4F1A\u53D8</p><p>\u51FD\u6570\u7B7E\u540D</p><div class="language-python ext-py"><pre class="language-python"><code><span class="token builtin">map</span><span class="token punctuation">(</span>func<span class="token punctuation">,</span> <span class="token operator">*</span>iterables<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">map</span> <span class="token builtin">object</span>
</code></pre></div><p>\u4E3E\u4F8B</p><div class="language-python ext-py"><pre class="language-python"><code><span class="token comment">#!/usr/bin/env python</span>
<span class="token comment"># --*-- coding:utf-8 --*--</span>

<span class="token comment"># \u5C06\u5217\u8868\u4E2D\u7684\u6570\u5B57\u90FD\u8F6C\u4E3A\u5B57\u7B26\u4E32</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">map</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># [&#39;1&#39;, &#39;2&#39;, &#39;3&#39;, &#39;4&#39;, &#39;5&#39;]</span>


<span class="token comment"># \u5C0F\u7EC3\u4E60\uFF0C\u4F7F\u7528map\u6765\u6C421-20\u4E4B\u95F4\u7684\u5076\u6570\uFF1F</span>

<span class="token comment"># (1)\u6B63\u5E38\u6765\u8BF4\uFF0C\u80AF\u5B9A\u662F\u5148\u60F3\u5230\u4F7F\u7528filter\uFF0C\u5148\u5199\u4E00\u4E0B</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">filter</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> x <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># [2, 4, 6, 8, 10, 12, 14, 16, 18, 20]</span>

<span class="token comment"># (2) \u4F7F\u7528map\u6765\u5199\uFF0C\u603B\u611F\u89C9\u54EA\u91CC\u4E0D\u5BF9\uFF0C\u5143\u7D20\u4E2A\u6570\u591A\u4E86~</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">map</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> x <span class="token keyword">if</span> x <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">==</span> <span class="token number">1</span> <span class="token keyword">else</span> <span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># [1, None, 3, None, 5, None, 7, None, 9, None, 11, None, 13, None, 15, None, 17, None, 19, None]</span>

<span class="token comment"># (3) \u4FEE\u6539\u4E00\u4E0B</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">map</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> x <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># ----------------------------------------------------------------------------------------------------</span>

<span class="token comment"># map \u53EF\u540C\u65F6\u63A5\u6536\u591A\u4E2A\u53EF\u8FED\u4EE3\u5BF9\u8C61\uFF0C\u6709\u51E0\u4E2A\u53EF\u8FED\u4EE3\u5BF9\u8C61\uFF0C\u90A3\u4E48\u51FD\u6570\u7684\u5C31\u8BE5\u6709\u51E0\u4E2A\u53C2\u6570</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">map</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">,</span> y<span class="token punctuation">:</span> <span class="token punctuation">{</span>x<span class="token punctuation">:</span> y<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># [{1: 10}, {2: 11}, {3: 12}, {4: 13}, {5: 14}]</span>

<span class="token comment"># \u5982\u679C\u4E24\u4E2A\u5E8F\u5217\u7684\u5143\u7D20\u4E2A\u6570\u4E0D\u4E00\u81F4\uFF0C\u4EE5\u6700\u77ED\u5E8F\u5217\u4E3A\u6807\u51C6\uFF082.x\u4E2D\u4F1A\u4EE5\u6700\u957F\u5E8F\u5217\u4E3A\u6807\u51C6\uFF09</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">map</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">,</span> y<span class="token punctuation">:</span> <span class="token punctuation">{</span>x<span class="token punctuation">:</span> y<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># [{1: 10}, {2: 11}, {3: 12}, {4: 13}, {5: 14}]</span>

<span class="token comment"># \u5982\u679C\u8981\u4EE5\u6700\u957F\u5E8F\u5217\u4E3A\u6807\u51C6\u7684\u8BDD\uFF0C\u81EA\u5DF1\u5B9E\u73B0\u4E86\u4E00\u4E2A\u51FD\u6570</span>
<span class="token keyword">from</span> itertools <span class="token keyword">import</span> zip_longest


<span class="token keyword">def</span> <span class="token function">map_longest</span><span class="token punctuation">(</span>func<span class="token punctuation">,</span> <span class="token operator">*</span>iterables<span class="token punctuation">)</span><span class="token punctuation">:</span>
    ret <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    iter_list <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span>zip_longest<span class="token punctuation">(</span><span class="token operator">*</span>iterables<span class="token punctuation">)</span><span class="token punctuation">)</span>

    <span class="token comment"># \u83B7\u53D6\u53EF\u8FED\u4EE3\u5BF9\u8C61\u7684\u4E2A\u6570</span>
    iter_number <span class="token operator">=</span> <span class="token builtin">max</span><span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">map</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">,</span> iter_list<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

    <span class="token comment"># \u904D\u5386\u6BCF\u4E2A\u53EF\u8FED\u4EE3\u5BF9\u8C61</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>iter_number<span class="token punctuation">)</span><span class="token punctuation">:</span>
        ret<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">[</span>x<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token keyword">for</span> x <span class="token keyword">in</span> iter_list<span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token builtin">map</span><span class="token punctuation">(</span>func<span class="token punctuation">,</span> <span class="token operator">*</span>ret<span class="token punctuation">)</span>


<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">(</span>map_longest<span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">,</span> y<span class="token punctuation">:</span> <span class="token punctuation">{</span>x<span class="token punctuation">:</span> y<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># [{1: 10}, {2: 11}, {3: 12}, {4: 13}, {5: 14}, {None: 15}, {None: 16}, {None: 17}, {None: 18}, {None: 19}, {None: 20}]</span>
</code></pre></div><p>\u4EFF\u5199map</p><div class="language-python ext-py"><pre class="language-python"><code><span class="token comment">#!/usr/bin/env python</span>
<span class="token comment"># --*-- coding:utf-8 --*--</span>

<span class="token keyword">def</span> <span class="token function">map</span><span class="token punctuation">(</span>fn<span class="token punctuation">,</span> <span class="token operator">*</span>iterable<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">zip</span><span class="token punctuation">(</span><span class="token operator">*</span>iterable<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">yield</span> fn<span class="token punctuation">(</span><span class="token operator">*</span>i<span class="token punctuation">)</span>
starmap
</code></pre></div><p><code>starmap</code>\u4E0Emap\u7C7B\u4F3C\uFF0C\u4E0D\u540C\u7684\u662F\u5BF9\u4E8E\u591A\u4E2A\u53EF\u8FED\u4EE3\u5BF9\u8C61\u7684\u5904\u7406\u65B9\u5F0F</p><div class="language-python ext-py"><pre class="language-python"><code><span class="token comment">#!/usr/bin/env python</span>
<span class="token comment"># --*-- coding:utf-8 --*--</span>
<span class="token keyword">from</span> itertools <span class="token keyword">import</span> starmap

data <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">map</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">,</span> y<span class="token punctuation">:</span> <span class="token punctuation">{</span>x<span class="token punctuation">:</span> y<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token operator">*</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># [{1: 3}, {2: 4}]   map\u5C061,3\u548C24\u5206\u522B\u4F20\u8FDB\u53BB</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">(</span>starmap<span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">,</span> y<span class="token punctuation">:</span> <span class="token punctuation">{</span>x<span class="token punctuation">:</span> y<span class="token punctuation">}</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># [{1: 2}, {3: 4}]   start_map \u5C061,2\u548C3,4\u5206\u522B\u4F20\u8FDB\u53BB,start_map \u53EA\u9700\u8981\u4F20\u9012\u4E00\u4E2A\u53EF\u8FED\u4EE3\u5BF9\u8C61\u5373\u53EF</span>
</code></pre></div><h3 id="\u88C5\u9970\u5668" tabindex="-1"><a class="header-anchor" href="#\u88C5\u9970\u5668" aria-hidden="true">#</a> \u88C5\u9970\u5668</h3><h4 id="\u67EF\u91CC\u5316-currying" tabindex="-1"><a class="header-anchor" href="#\u67EF\u91CC\u5316-currying" aria-hidden="true">#</a> \u67EF\u91CC\u5316(Currying)</h4><p>\u5C06\u539F\u6765\u63A5\u53D72\u4E2A\u53C2\u6570\u7684\u51FD\u6570\u53D8\u6210\u65B0\u7684\u63A5\u53D7\u4E00\u4E2A\u53C2\u6570\u7684\u51FD\u6570\u7684\u8FC7\u7A0B\u3002\u65B0\u7684\u51FD\u6570\u662F\u63A5\u53D7\u539F\u6709\u51FD\u6570\u7B2C\u4E8C\u4E2A\u53C2\u6570\u7684\u51FD\u6570\uFF0C\u6BD4\u5982\uFF1A</p><p>\u539F\u51FD\u6570\u4E3A: <code>add(1, 2)</code></p><p>\u67EF\u91CC\u5316\u540E: <code>add(1)(2)</code></p><p>\u67EF\u91CC\u5316\u7B80\u5355\u4E3E\u4F8B</p><div class="language-python ext-py"><pre class="language-python"><code><span class="token comment">#!/usr/bin/env python</span>
<span class="token comment"># --*-- coding:utf-8 --*--</span>

<span class="token comment"># \u539F\u51FD\u6570</span>
<span class="token keyword">def</span> <span class="token function">add</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> x <span class="token operator">+</span> y

<span class="token comment"># \u67EF\u91CC\u5316\u540E</span>
<span class="token keyword">def</span> <span class="token function">add</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">fn</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> x <span class="token operator">+</span> y
    
    <span class="token keyword">return</span> fn

<span class="token keyword">print</span><span class="token punctuation">(</span>add<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># 3</span>
</code></pre></div><h4 id="\u95ED\u5305-closure" tabindex="-1"><a class="header-anchor" href="#\u95ED\u5305-closure" aria-hidden="true">#</a> \u95ED\u5305(Closure)</h4><p>\u95ED\u5305\u5C31\u662F\u51FD\u6570\u4E2D\u518D\u5D4C\u5957\u4E00\u4E2A\u51FD\u6570\uFF0C\u5185\u5C42\u51FD\u6570\u4E2D\u4F7F\u7528\u4E86\u5916\u5C42\u51FD\u6570\u7684\u81EA\u6709\u53D8\u91CF\uFF0C\u5C31\u4EA7\u751F\u4E86\u95ED\u5305</p><p>\u5916\u5C42\u51FD\u6570<code>__closure__</code>\u5C5E\u6027\u662F\u4E00\u4E2Acell\u5BF9\u8C61\u7684\u5143\u7956\uFF0C\u6BCF\u4E2Acell\u5BF9\u8C61\u7684cell_contents\u5C5E\u6027\u5BF9\u5E94\u4EA7\u751F\u95ED\u5305\u7684\u81EA\u6709\u53D8\u91CF\u7684\u503C</p><div class="language-python ext-py"><pre class="language-python"><code><span class="token comment">#!/usr/bin/env python</span>
<span class="token comment"># --*-- coding:utf-8 --*--</span>

<span class="token keyword">def</span> <span class="token function">add</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">:</span>
    count <span class="token operator">=</span> <span class="token number">0</span>

    <span class="token keyword">def</span> <span class="token function">wrapper</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> x<span class="token punctuation">,</span> y

    <span class="token keyword">return</span> wrapper


<span class="token keyword">for</span> i <span class="token keyword">in</span> add<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__closure__<span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>i<span class="token punctuation">.</span>cell_contents<span class="token punctuation">)</span>
    <span class="token comment"># 1</span>
    <span class="token comment"># 2</span>
</code></pre></div><h4 id="\u88C5\u9970\u5668-1" tabindex="-1"><a class="header-anchor" href="#\u88C5\u9970\u5668-1" aria-hidden="true">#</a> \u88C5\u9970\u5668</h4><p>\u65E0\u53C2\u88C5\u9970\u5668</p><div class="language-python ext-py"><pre class="language-python"><code><span class="token comment">#!/usr/bin/env python</span>
<span class="token comment"># --*-- coding:utf-8 --*--</span>

<span class="token keyword">import</span> time


<span class="token comment"># \u65E0\u53C2\u88C5\u9970\u5668</span>
<span class="token keyword">def</span> <span class="token function">timer</span><span class="token punctuation">(</span>func<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">wrapper</span><span class="token punctuation">(</span><span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span>
        start <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>
        f <span class="token operator">=</span> func<span class="token punctuation">(</span><span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span>
        end <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&#39;Runnint time: {time} seconds.&#39;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>time<span class="token operator">=</span><span class="token punctuation">(</span>end <span class="token operator">-</span> start<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> f

    <span class="token keyword">return</span> wrapper


<span class="token decorator annotation punctuation">@timer</span>  <span class="token comment"># \u7B49\u540C\u4E8E timer(add)(a, b)</span>
<span class="token keyword">def</span> <span class="token function">add</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">:</span>
    time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> a <span class="token operator">+</span> b


<span class="token keyword">print</span><span class="token punctuation">(</span>add<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><p>\u5E26\u53C2\u88C5\u9970\u5668\uFF0C\u9700\u8981\u518D\u9970\u5668\u51FD\u6570\u7684\u7B2C\u4E00\u5C42\u518D\u5D4C\u5957\u4E00\u4E2A\u51FD\u6570</p><div class="language-python ext-py"><pre class="language-python"><code><span class="token keyword">import</span> time
 
<span class="token keyword">def</span> <span class="token function">timer</span><span class="token punctuation">(</span>start_time<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">_timer</span><span class="token punctuation">(</span>func<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">def</span> <span class="token function">wrapper</span><span class="token punctuation">(</span><span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span>
            start <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>
            f <span class="token operator">=</span> func<span class="token punctuation">(</span><span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span>
            delta <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> start
            <span class="token keyword">if</span> delta <span class="token operator">&gt;=</span> start_time<span class="token punctuation">:</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&#39;Runnint time: {time} seconds.&#39;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>time<span class="token operator">=</span>delta<span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token keyword">return</span> f
        <span class="token keyword">return</span> wrapper
    <span class="token keyword">return</span> _timer
 
<span class="token decorator annotation punctuation">@timer</span><span class="token punctuation">(</span>start_time<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">)</span>        <span class="token comment"># \u7B49\u540C\u4E8Etimer(start_time=3)(add)(a, b)</span>
<span class="token keyword">def</span> <span class="token function">add</span><span class="token punctuation">(</span>a <span class="token punctuation">,</span>b<span class="token punctuation">)</span><span class="token punctuation">:</span>
    time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> a <span class="token operator">+</span> b
 
<span class="token keyword">print</span><span class="token punctuation">(</span>add<span class="token punctuation">(</span><span class="token number">1</span> <span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><p>\u88C5\u9970\u5668\u7684\u526F\u4F5C\u7528\uFF1A\u90E8\u5206\u5C5E\u6027\u4F1A\u88AB\u8986\u76D6,\u6BD4\u5982 <code>__name__</code>, <code>__doc__</code></p><p>\u4F7F\u7528\u88C5\u9970\u5668<code>functools.wraps(func)</code> \u6216 \u51FD\u6570<code>functools.update_wrapper(wrapper, func)</code> \u53EF\u4EE5\u6D88\u9664\u8FD9\u79CD\u5F71\u54CD</p><div class="language-python ext-py"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">timer</span><span class="token punctuation">(</span>start_time<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">_timer</span><span class="token punctuation">(</span>func<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># \u65B9\u6CD51-\u63A8\u8350</span>
        <span class="token decorator annotation punctuation">@functools<span class="token punctuation">.</span>wraps</span><span class="token punctuation">(</span>func<span class="token punctuation">)</span>
        <span class="token keyword">def</span> <span class="token function">wrapper</span><span class="token punctuation">(</span><span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span>
            start <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>
            f <span class="token operator">=</span> func<span class="token punctuation">(</span><span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span>
            delta <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> start
            <span class="token keyword">if</span> delta <span class="token operator">&gt;=</span> start_time<span class="token punctuation">:</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&#39;Runnint time: {time} seconds.&#39;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>time<span class="token operator">=</span>delta<span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token keyword">return</span> f
        <span class="token comment"># \u65B9\u6CD52</span>
        <span class="token comment"># functools.update_wrapper(wrapper, func)</span>
        <span class="token keyword">return</span> wrapper
    <span class="token keyword">return</span> _timer
</code></pre></div><h2 id="-2" tabindex="-1"><a class="header-anchor" href="#-2" aria-hidden="true">#</a></h2><h2 id="\u56DB\u3001\u591A\u7EBF\u7A0B" tabindex="-1"><a class="header-anchor" href="#\u56DB\u3001\u591A\u7EBF\u7A0B" aria-hidden="true">#</a> \u56DB\u3001\u591A\u7EBF\u7A0B</h2><h3 id="\u5E76\u53D1\u548C\u5E76\u884C" tabindex="-1"><a class="header-anchor" href="#\u5E76\u53D1\u548C\u5E76\u884C" aria-hidden="true">#</a> \u5E76\u53D1\u548C\u5E76\u884C</h3><p>\u5E76\u53D1\uFF08Concurrent\uFF09\uFF1A\u5728\u540C\u4E00\u65F6\u95F4\u70B9\uFF0C\u4E00\u9897CPU\u6838\u5FC3\u4EA4\u66FF\u505A\u4E24\u4EF6\u6216\u591A\u4EF6\u4E8B</p><p>\u5E76\u884C\uFF08Parallel\uFF09\uFF1A\u540C\u4E00\u65F6\u95F4\u70B9\uFF0C\u4E24\u9897\u6216\u591A\u9897CPU\u6838\u5FC3\u540C\u65F6\u505A\u4E24\u4EF6\u6216\u591A\u4EF6\u4E8B</p><p>\u5355\u5355\u53EA\u770B\u8FD9\u4E9B\u6982\u5FF5\u8FD8\u662F\u8BA9\u4EBA\u6478\u4E0D\u7740\u5934\u8111\uFF0C\u6211\u4EEC\u6DF1\u5165\u7406\u89E3\u4E00\u4E0B\uFF1A</p><ul><li><p>\u5728\u53EA\u6709\u4E00\u9897CPU\u6838\u5FC3\u7684\u5904\u7406\u5668\u4E0A\u9762\u662F\u65E0\u6CD5\u5B9E\u73B0\u5E76\u884C\u7684\uFF0C\u4F46\u662F\u53EF\u4EE5\u5B9E\u73B0\u5E76\u53D1</p></li><li><p>\u5E76\u884C\u662F\u63D0\u9AD8\u5E76\u53D1\u7684\u4E00\u79CD\u624B\u6BB5</p></li><li><p>\u7531\u4E8ECPython\u7279\u6B8A\u7684GIL\u9501\uFF0C\u5BFC\u81F4CPython\u4E0D\u80FD\u5B9E\u73B0\u5E76\u884C\uFF0C\u89E3\u51B3\u529E\u6CD5\u53EF\u4EE5\u4F7F\u7528\u591A\u8FDB\u7A0B\u6765\u5B9E\u73B0\u5E76\u884C\uFF0C</p><p>\u4E5F\u53EF\u4EE5\u4F7F\u7528PyPy\u7B49\u79FB\u9664\u6389GIL\u7684\u7B2C\u4E09\u65B9\u89E3\u91CA\u5668\u6765\u6267\u884C\uFF08\u8FD9\u53C8\u662F\u4E00\u4E2A\u6BD4\u8F83\u6DF1\u7684\u5751\uFF09</p></li></ul><h3 id="\u9AD8\u5E76\u53D1\u89E3\u51B3\u65B9\u6848" tabindex="-1"><a class="header-anchor" href="#\u9AD8\u5E76\u53D1\u89E3\u51B3\u65B9\u6848" aria-hidden="true">#</a> \u9AD8\u5E76\u53D1\u89E3\u51B3\u65B9\u6848</h3><p>\u4E0A\u9762\u6211\u4EEC\u8BB2\u7684\u90FD\u662F\u5728\u7F16\u7A0B\u8BED\u8A00\u8303\u56F4\u5185\u7684\u5E76\u53D1\uFF0C\u800C\u5728\u4E00\u4E2A\u9879\u76EE\u4E2D\uFF0C\u9AD8\u5E76\u53D1\u7684\u672C\u8D28\u95EE\u9898\u5F80\u5F80\u5728\u4E8E\u6570\u636E\u5E93\u80FD\u591F\u627F\u8F7D\u7684\u5E76\u53D1\u662F\u6709\u9650\u7684\u3002\u89E3\u51B3\u9AD8\u5E76\u53D1\u7684\u5173\u952E\u5C31\u5728\u4E8E\u964D\u4F4E\u5355\u5E93\u7684\u8FDE\u63A5\u6570\u3002</p><p>\u901A\u5E38\u6211\u4EEC\u53EF\u4EE5\u6709\u4EE5\u4E0B\u51E0\u79CD\u65B9\u6CD5\uFF1A</p><ul><li>\u4F7F\u7528\u7F13\u5B58\uFF0C\u7F13\u5B58\u547D\u4E2D\u4FBF\u4E0D\u4F1A\u518D\u53BB\u8BF7\u6C42\u6570\u636E\u5E93</li><li>\u7CFB\u7EDF\u62C6\u5206\uFF0C\u6BCF\u4E2A\u4E1A\u52A1\u4F7F\u7528\u72EC\u7ACB\u7684\u4E00\u4E2A\u6570\u636E\u5E93\u5B9E\u4F8B</li><li>\u8BFB\u5199\u5206\u79BB\uFF0C\u5BF9\u540C\u4E00\u4E2A\u6570\u636E\u5E93\u8FDB\u4E00\u6B65\u62C6\u5206\uFF0C\u8BFB\u548C\u5199\u5206\u6563\u5728\u4E0D\u540C\u7684\u6570\u636E\u5E93\u5B9E\u4F8B\u4E0A</li><li>MQ\u524A\u5CF0\uFF0C\u670D\u52A1\u7AEF\u9650\u901F\u6267\u884C</li><li>\u9650\u6D41\u64CD\u4F5C\uFF0C\u6BD4\u5982\u4EE4\u724C\u6876\u7B49\uFF0C\u8D85\u51FA\u5219\u4E22\u5F03</li></ul><blockquote><p>\u5B9E\u9645\u60C5\u51B5\u4E2D\u8981\u6839\u636E\u9879\u76EE\u7684\u7279\u6027\uFF0C\u662F\u8BFB\u591A\u5199\u5C11\u8FD8\u662F\u8BFB\u5C11\u5199\u591A\uFF0C\u7EFC\u5408\u4E0D\u540C\u7684\u624B\u6BB5\u6765\u8FBE\u5230\u9AD8\u5E76\u53D1\u7684\u76EE\u7684</p></blockquote><h3 id="\u7EBF\u7A0B\u8BF4\u660E" tabindex="-1"><a class="header-anchor" href="#\u7EBF\u7A0B\u8BF4\u660E" aria-hidden="true">#</a> \u7EBF\u7A0B\u8BF4\u660E</h3><ul><li>\u7EBF\u7A0B\u662FCPU\u8C03\u5EA6\u7684\u6700\u5C0F\u5355\u5143</li><li>\u6BCF\u4E2A\u53EF\u6267\u884C\u7A0B\u5E8F\u90FD\u4F1A\u6709\u4E00\u4E2A\u4E3B\u7EBF\u7A0B\uFF0C\u4E3B\u7EBF\u7A0B\u4E00\u822C\u6211\u4EEC\u90FD\u7528\u6765\u505A\u534F\u8C03\u5DE5\u4F5C\uFF0C\u7531\u4E3B\u7EBF\u7A0B\u6765\u521B\u5EFA\u5176\u4ED6\u7EBF\u7A0B\u79F0\u4E3A\u5DE5\u4F5C\u7EBF\u7A0B</li><li>\u7EBF\u7A0B\u4E4B\u95F4\u6570\u636E\u5171\u4EAB</li><li>\u7EBF\u7A0B\u72B6\u6001 <ul><li>\u5C31\u7EEA(Ready)\uFF1A\u7EBF\u7A0B\u80FD\u591F\u8FD0\u884C\u4F46\u662F\u8FD8\u6CA1\u6709\u5F00\u59CB\u8FD0\u884C\uFF0C\u7B49\u5F85\u88AB\u8C03\u5EA6</li><li>\u8FD0\u884C(Running)\uFF1A\u7EBF\u7A0B\u4E00\u65E6\u8C03\u5EA6\u5C31\u5904\u4E8E\u8FD0\u884C\u4E2D</li><li>\u963B\u585E(Blocked)\uFF1A\u7EBF\u7A0B\u7B49\u5F85\u5916\u90E8\u4E8B\u4EF6\u800C\u65E0\u6CD5\u8FD0\u884C\uFF0C\u6BD4\u5982I<code>/O</code>\u7B49\u5F85</li><li>\u7EC8\u6B62(Teminated)\uFF1A\u7EBF\u7A0B\u9000\u51FA</li></ul></li><li>\u5DE5\u4F5C\u7EBF\u7A0B\u4E00\u65E6\u542F\u52A8\uFF0C\u4E0D\u53EF\u6682\u505C\u548C\u53D6\u6D88\uFF0C\u9664\u975E\u4EE3\u7801\u8FD0\u884C\u5B8C\u6210\u6216\u629B\u51FA\u5F02\u5E38\u800C\u505C\u6B62\uFF1B\u5DE5\u4F5C\u7EBF\u7A0B\u5D29\u6E83\u4E0D\u5F71\u54CD\u4E3B\u7EBF\u7A0B\u6B63\u5E38\u8FD0\u884C</li></ul><h3 id="cpython\u7EBF\u7A0B\u4F7F\u7528\u573A\u666F" tabindex="-1"><a class="header-anchor" href="#cpython\u7EBF\u7A0B\u4F7F\u7528\u573A\u666F" aria-hidden="true">#</a> CPython\u7EBF\u7A0B\u4F7F\u7528\u573A\u666F</h3><p>\u7EBF\u7A0B\u662F\u6700\u51FA\u540D\u7684\u5B9E\u73B0\u5E76\u53D1\u548C\u5E76\u884C\u7684\u65B9\u5F0F\u4E4B\u4E00\uFF0C\u4F46\u662F\u5728CPython\u4E2D\u7531\u4E8EGIL\u7684\u5B58\u5728\uFF0C\u7EBF\u7A0B\u53EA\u80FD\u5B9E\u73B0\u5E76\u53D1\uFF0C\u800C\u4E0D\u80FD\u5B9E\u73B0\u5E76\u884C\u3002</p><p>\u53EF\u4EE5\u8BF4CPython\u7684\u7EBF\u7A0B\u5E76\u4E0D\u662F\u771F\u6B63\u7684\u7EBF\u7A0B\uFF0C\u4F46\u662F\u5B83\u5728\u67D0\u4E9B\u573A\u666F\u4E0B\u4ECD\u65E7\u53EF\u4EE5\u4E3A\u6211\u4EEC\u7684\u4EE3\u7801\u63D0\u901F\uFF0C\u5176\u539F\u7406\u5728\u4E8E\uFF1A</p><ul><li>\u5BF9\u4E8ECPU\u5BC6\u96C6\u578B\u7684\u5E94\u7528\uFF0C\u7531\u4E8E\u7EBF\u7A0B\u4F1A\u4E00\u76F4\u9738\u5360CPU\uFF0C\u9664\u975E\u7EBF\u7A0B\u6267\u884C\u5B8C\u6210\u6216\u4E3B\u52A8\u4EA4\u51FA\u63A7\u5236\u6743\uFF0C\u6240\u4EE5\u4F7F\u7528\u591A\u7EBF\u7A0B\u4E00\u822C\u4F1A\u5BFC\u81F4\u7A0B\u5E8F\u53D8\u6162\uFF08\u7EBF\u7A0B\u521B\u5EFA\u548C\u9500\u6BC1\u9700\u8981\u5F00\u9500\uFF09</li><li>\u5BF9\u4E8EIO\u5BC6\u96C6\u578B\u5E94\u7528\uFF0C\u9047\u5230IO\u963B\u585E\u65F6\u7CFB\u7EDF\u4F1A\u81EA\u52A8\u8FDB\u884C\u7EBF\u7A0B\u5207\u6362\uFF0C\u6240\u4EE5\u53EF\u4EE5\u6781\u5927\u7684\u63D0\u9AD8\u7A0B\u5E8F\u6548\u7387</li></ul><h3 id="\u57FA\u672C\u4F7F\u7528" tabindex="-1"><a class="header-anchor" href="#\u57FA\u672C\u4F7F\u7528" aria-hidden="true">#</a> \u57FA\u672C\u4F7F\u7528</h3><p>\u51FD\u6570\u5F62\u5F0F</p><div class="language-python ext-py"><pre class="language-python"><code><span class="token comment">#!/usr/bin/env python</span>
<span class="token comment"># -*-coding:utf-8-*-</span>

<span class="token keyword">from</span> datetime <span class="token keyword">import</span> datetime
<span class="token keyword">from</span> threading <span class="token keyword">import</span> Thread


<span class="token comment"># \u5B9A\u4E49\u4E00\u4E2A\u666E\u901A\u51FD\u6570</span>
<span class="token keyword">def</span> <span class="token function">show_time</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&#39;{}{}&#39;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>msg<span class="token punctuation">,</span> datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>


<span class="token comment"># \u5B9E\u4F8B\u5316Thread\u7C7B\uFF0C\u521B\u5EFA\u4E00\u4E2A\u7EBF\u7A0B\uFF0C\u6267\u884C\u6211\u4EEC\u7684\u51FD\u6570show_time\uFF0C\u51FD\u6570\u53C2\u6570\u4EE5\u5143\u7EC4\u5F62\u5F0F\u4F7F\u7528args\u4F20\u9012</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    t <span class="token operator">=</span> Thread<span class="token punctuation">(</span>target<span class="token operator">=</span>show_time<span class="token punctuation">,</span> args<span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">&quot;\u5F53\u524D\u65F6\u95F4\u662F: &quot;</span><span class="token punctuation">,</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    t<span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p>\u7C7B\u5F62\u5F0F</p><div class="language-python ext-py"><pre class="language-python"><code><span class="token comment">#!/usr/bin/env python</span>
<span class="token comment"># -*-coding:utf-8-*-</span>

<span class="token keyword">from</span> datetime <span class="token keyword">import</span> datetime
<span class="token keyword">from</span> threading <span class="token keyword">import</span> Thread


<span class="token keyword">class</span> <span class="token class-name">ShowTime</span><span class="token punctuation">(</span>Thread<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> <span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token builtin">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">run</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&#39;\u5F53\u524D\u65F6\u95F4\u662F: {}\\n&#39;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> end<span class="token operator">=</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span>


<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    t <span class="token operator">=</span> ShowTime<span class="token punctuation">(</span><span class="token punctuation">)</span>
    t<span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="\u7EBF\u7A0B\u5C5E\u6027" tabindex="-1"><a class="header-anchor" href="#\u7EBF\u7A0B\u5C5E\u6027" aria-hidden="true">#</a> \u7EBF\u7A0B\u5C5E\u6027</h3><p>Thread\u7C7B\u7B7E\u540D</p><div class="language-python ext-py"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> group<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> target<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span>
                 args<span class="token operator">=</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> kwargs<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token operator">*</span><span class="token punctuation">,</span> daemon<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span>

targe	\u7EBF\u7A0B\u8C03\u5EA6\u7684\u51FD\u6570
name	\u7EBF\u7A0B\u540D\u5B57
args	\u7EBF\u7A0B\u51FD\u6570\u53C2\u6570\uFF0C\u662F\u4E00\u4E2A\u5143\u7956
daemon	\u540E\u9762\u6709\u8BB2\u89E3
</code></pre></div><p>Thread\u5B9E\u4F8B\u5C5E\u6027\u548C\u65B9\u6CD5</p><table><thead><tr><th>\u5C5E\u6027/\u65B9\u6CD5</th><th>\u8BF4\u660E</th></tr></thead><tbody><tr><td>start()</td><td>\u6267\u884C\u4EFB\u52A1\uFF08\u542F\u52A8\u65B0\u7EBF\u7A0B\uFF09,start\u4F1A\u542F\u52A8\u65B0\u7EBF\u7A0B\u7136\u540E\u8C03\u7528run\u65B9\u6CD5</td></tr><tr><td>run()</td><td>\u6267\u884C\u4EFB\u52A1\uFF08\u5728\u5F53\u524D\u7EBF\u7A0B\u4E2D\uFF09\uFF0Crun\u65B9\u6CD5\u4F1A\u6267\u884C\u5177\u4F53\u7684\u4EFB\u52A1</td></tr><tr><td>name/getName()</td><td>\u7EBF\u7A0B\u540D\uFF0C\u9ED8\u8BA4\u4EE5Thread-1\u3001Thread-2\u5F62\u5F0F\u547D\u540D</td></tr><tr><td>setName()</td><td>\u8BBE\u7F6E\u7EBF\u7A0B\u540D\u79F0</td></tr><tr><td>ident</td><td>\u7EBF\u7A0BID\uFF0C\u975E0\u6574\u6570\uFF0C\u7EBF\u7A0B\u542F\u52A8\u540E\u624D\u4F1A\u6709ID\uFF0C\u5426\u5219\u4E3ANone\u3002\u7EBF\u7A0B\u9000\u51FA\uFF0C\u6B64ID\u4F9D\u65E7\u53EF\u4EE5\u8BBF\u95EE\u3002\u6B64ID\u53EF\u4EE5\u91CD\u590D\u4F7F\u7528</td></tr><tr><td>is_alive()</td><td>\u8FD4\u56DE\u7EBF\u7A0B\u662F\u5426\u8FD8\u6D3B\u7740\uFF0C\u7B49\u540C\u4E8E.isAlive()</td></tr></tbody></table><p>threading\u6A21\u5757\u5C5E\u6027\u548C\u65B9\u6CD5</p><table><thead><tr><th>\u5C5E\u6027/\u65B9\u6CD5</th><th>\u8BF4\u660E</th></tr></thead><tbody><tr><td>current_thread()</td><td>\u8FD4\u56DE\u5F53\u524D\u7EBF\u7A0B\u5BF9\u8C61</td></tr><tr><td>get_ident()</td><td>\u8FD4\u56DE\u5F53\u524D\u7EBF\u7A0B\u7684ID\uFF0C\u975E0\u6574\u6570</td></tr><tr><td>main_thread()</td><td>\u8FD4\u56DE\u4E3B\u7EBF\u7A0B\u5BF9\u8C61</td></tr><tr><td>active_count()</td><td>\u5F53\u524D\u5904\u4E8Ealive\u72B6\u6001\u7684\u7EBF\u7A0B\u4E2A\u6570</td></tr><tr><td>enumerate()</td><td>\u8FD4\u56DE\u6240\u6709\u7684\u6D3B\u7740\u7684\u7EBF\u7A0B\u5217\u8868\uFF0C\u4E0D\u5305\u62EC\u672A\u5F00\u59CB\u548C\u5DF2\u7EC8\u6B62\u7684\u7EBF\u7A0B</td></tr></tbody></table><h3 id="\u7EBF\u7A0B\u5B89\u5168" tabindex="-1"><a class="header-anchor" href="#\u7EBF\u7A0B\u5B89\u5168" aria-hidden="true">#</a> \u7EBF\u7A0B\u5B89\u5168</h3><p>\u7EBF\u7A0B\u6267\u884C\u4E00\u6BB5\u4EE3\u7801\u7684\u65F6\u5019\uFF0C\u8FD9\u6BB5\u4EE3\u7801\u8981\u4E48\u4E0D\u6267\u884C\uFF0C\u8981\u4E48\u4E00\u5B9A\u4F1A\u6267\u884C\u5B8C(\u6267\u884C\u8FC7\u7A0B\u4E2D\u4E0D\u4F1A\u5207\u6362\u5230\u5176\u4ED6\u7EBF\u7A0B)\uFF0C\u8FD9\u6BB5\u4EE3\u7801\u5C31\u79F0\u4E3A\u7EBF\u7A0B\u5B89\u5168</p><p>\uFF081\uFF09\u76F4\u63A5\u4F7F\u7528<code>print</code>\u51FD\u6570\u662F\u7EBF\u7A0B\u4E0D\u5B89\u5168\u7684\uFF0C\u4F46\u901A\u8FC7\u4FEE\u6539\u4F7F\u7528\u65B9\u5F0F\uFF0C\u53EF\u4EE5\u8FBE\u5230\u7EBF\u7A0B\u5B89\u5168\uFF1B<code>logging</code>\u662F\u7EBF\u7A0B\u5B89\u5168\uFF0C\u66F4\u63A8\u8350\u4F7F\u7528<code>logging</code>\u6765\u4EE3\u66FF<code>print</code></p><p><code>print</code>\u7EBF\u7A0B\u5B89\u5168\u8BF4\u660E</p><div class="language-python ext-py"><pre class="language-python"><code><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;hello world&quot;</span><span class="token punctuation">)</span>            <span class="token comment"># \u7EBF\u7A0B\u4E0D\u5B89\u5168</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;hello world\\n&quot;</span><span class="token punctuation">,</span> end<span class="token operator">=</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span>  <span class="token comment"># \u7EBF\u7A0B\u5B89\u5168</span>

<span class="token comment"># \u539F\u7406\u5728\u4E8E\uFF1A</span>
<span class="token comment">#   (1)print(&quot;hello world&quot;)\u5176\u5B9E\u662F\u4E24\u6B65\u64CD\u4F5C\uFF0C\u5148\u8F93\u51FAhello world\uFF0C\u518D\u8F93\u51FA\u6362\u884C\u7B26\\n\uFF0C\u8FD9\u4E2D\u95F4\u662F\u53EF\u4EE5\u88AB\u6253\u65AD\u7684</span>
<span class="token comment">#   (2)\u901A\u8FC7\u6307\u5B9Aend=&quot;&quot;\uFF0C\u7B49\u540C\u4E8E\u5C06\u7B2C\u4E8C\u6B65\u64CD\u4F5C\u7ED9\u53BB\u6389</span>
</code></pre></div><p>\u7EBF\u7A0B\u5B89\u5168\u6F14\u793A</p><div class="language-python ext-py"><pre class="language-python"><code><span class="token comment">#!/usr/bin/env python</span>
<span class="token comment"># -*-coding:utf-8-*-</span>

<span class="token keyword">import</span> logging
<span class="token keyword">from</span> threading <span class="token keyword">import</span> Thread<span class="token punctuation">,</span> current_thread


<span class="token keyword">def</span> <span class="token function">thread_safe</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;{} is running&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>current_thread<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># \u7EBF\u7A0B\u4E0D\u5B89\u5168</span>
        <span class="token comment"># print(&quot;{} is running\\n&quot;.format(current_thread().name), end=&quot;&quot;)    # \u7EBF\u7A0B\u5B89\u5168</span>
        <span class="token comment"># logging.warning(&quot;{} is running&quot;.format(current_thread().name))    # \u7EBF\u7A0B\u5B89\u5168</span>


<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    t <span class="token operator">=</span> Thread<span class="token punctuation">(</span>target<span class="token operator">=</span>thread_safe<span class="token punctuation">)</span>
    t<span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="https://tuchuang-1257805459.cos.ap-shanghai.myqcloud.com/image-20220330204518155.png" alt="image-20220330204518155"></p><p>\uFF082\uFF09<code>queue</code>\u662F\u7EBF\u7A0B\u5B89\u5168\u7684\uFF0C\u4F46\u662F\u4E0B\u9762\u7684\u4EE3\u7801\u662F\u7EBF\u7A0B\u4E0D\u5B89\u5168\u7684</p><p><code>queue</code>\u7EBF\u7A0B\u4E0D\u5B89\u5168\u539F\u7406</p><div class="language-python ext-py"><pre class="language-python"><code><span class="token keyword">if</span> q<span class="token punctuation">.</span>qsize<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">:</span>
	q<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># \u95EE\u9898\u63CF\u8FF0\uFF1Aqsize()&gt;0\u4E0D\u80FD\u4FDD\u8BC1\u4E00\u5B9A\u80FDget()\uFF0Cqsize()&lt;maxsize\u4E0D\u80FD\u4FDD\u8BC1\u4E00\u5B9Aput()</span>
<span class="token comment"># \u539F\u56E0\u5728\u4E8E\uFF1Aqsize()\u548Cget()\u672C\u8EAB\u662F\u7EBF\u7A0B\u5B89\u5168\u7684,\u4F46\u662F\u8FD9\u4E24\u4E2A\u7EC4\u5408\u5230\u4E00\u5757\u5C31\u4E0D\u80FD\u4FDD\u8BC1\u662F\u7EBF\u7A0B\u5B89\u5168\uFF0C\u56E0\u4E3A\u8FD9\u662F\u4E24\u6B65\u64CD\u4F5C\u4E86\uFF0C\u4E2D\u95F4\u662F\u53EF\u80FD\u88AB\u6253\u65AD\u7684</span>
<span class="token comment"># \u89E3\u51B3\u529E\u6CD5\uFF1Aqsize()\u548Cget()\u7684\u7EC4\u5408\u4EE3\u7801\u52A0\u9501</span>
</code></pre></div><p><code>queue</code>\u7EBF\u7A0B\u5B89\u5168\u6F14\u793A</p><div class="language-python ext-py"><pre class="language-python"><code><span class="token comment">#!/usr/bin/env python</span>
<span class="token comment"># -*-coding:utf-8-*-</span>

<span class="token keyword">import</span> logging
<span class="token keyword">import</span> random
<span class="token keyword">import</span> time
<span class="token keyword">from</span> queue <span class="token keyword">import</span> Queue
<span class="token keyword">from</span> threading <span class="token keyword">import</span> Thread<span class="token punctuation">,</span> Lock

<span class="token comment"># \u521D\u59CB\u5316\u961F\u5217</span>
q <span class="token operator">=</span> Queue<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># \u521D\u59CB\u5316\u5168\u5C40\u9501</span>
lock <span class="token operator">=</span> Lock<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># \u521D\u59CB\u5316\u65E5\u5FD7</span>
FORMAT <span class="token operator">=</span> <span class="token string">&#39;%(asctime)-15s\\t [%(threadName)-10s, %(thread)d] %(message)s&#39;</span>
logging<span class="token punctuation">.</span>basicConfig<span class="token punctuation">(</span><span class="token builtin">format</span><span class="token operator">=</span>FORMAT<span class="token punctuation">)</span>


<span class="token comment"># \u7EBF\u7A0B\u4E0D\u5B89\u5168\u4EE3\u7801(\u672A\u52A0\u9501)</span>
<span class="token keyword">def</span> <span class="token function">thread_safe</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> q<span class="token punctuation">.</span>qsize<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;=</span> <span class="token number">0</span><span class="token punctuation">:</span>
        time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span>random<span class="token punctuation">.</span>random<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        q<span class="token punctuation">.</span>put<span class="token punctuation">(</span>random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    logging<span class="token punctuation">.</span>warning<span class="token punctuation">(</span><span class="token string">&quot;\u961F\u5217\u5927\u5C0F: {}&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>q<span class="token punctuation">.</span>qsize<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>


<span class="token comment"># \u7EBF\u7A0B\u5B89\u5168\u4EE3\u7801(\u5DF2\u52A0\u9501)</span>
<span class="token keyword">def</span> <span class="token function">thread_safe2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">with</span> lock<span class="token punctuation">:</span>
        <span class="token keyword">if</span> q<span class="token punctuation">.</span>qsize<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;=</span> <span class="token number">0</span><span class="token punctuation">:</span>
            time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span>random<span class="token punctuation">.</span>random<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            q<span class="token punctuation">.</span>put<span class="token punctuation">(</span>random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        logging<span class="token punctuation">.</span>warning<span class="token punctuation">(</span><span class="token string">&quot;\u961F\u5217\u5927\u5C0F: {}&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>q<span class="token punctuation">.</span>qsize<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># \u5F00\u542F100\u4E2A\u7EBF\u7A0B</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    Thread<span class="token punctuation">(</span>target<span class="token operator">=</span>thread_safe<span class="token punctuation">)</span><span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment"># Thread(target=thread_safe2).start()</span>
</code></pre></div><h3 id="daemon" tabindex="-1"><a class="header-anchor" href="#daemon" aria-hidden="true">#</a> daemon</h3><p>\u8BBE\u7F6E\u7EBF\u7A0Bdaemon\u4E3AFalse\u540E\uFF0C\u5F53\u4E3B\u7EBF\u7A0B\u6267\u884C\u7ED3\u675F\u540E\uFF0C\u8981\u7B49\u5F85\u975Edaemon\u7EBF\u7A0B\u6267\u884C\u5B8C\u6210</p><p>\u8BBE\u7F6Edaemon\u4E3ATrue\u540E\uFF0C\u5F53\u4E3B\u7EBF\u7A0B\u6267\u884C\u7ED3\u675F\u540E\uFF0Cdaemon\u7EBF\u7A0B\u4E5F\u4F1A\u7ACB\u5373\u9000\u51FA</p><p>\u5B50\u7EBF\u7A0B\u7684daemon\u7684\u503C\u4ECE\u7236\u7EBF\u7A0B\u4E2D\u7EE7\u627F\u6765\uFF0C\u7236\u7EBF\u7A0B\u5982\u679C\u4E0D\u8BBE\u7F6E\u9ED8\u8BA4\u4E3AFalse</p><p>daemon\u76F8\u5173\u65B9\u6CD5</p><table><thead><tr><th>\u5C5E\u6027</th><th>\u8BF4\u660E</th></tr></thead><tbody><tr><td>threading.Thread(...., daemon=True)</td><td>\u521B\u5EFA\u7EBF\u7A0B\u65F6\u8BBE\u7F6Edaemon\u5C5E\u6027</td></tr><tr><td>\u7EBF\u7A0B.setDaemon(True)</td><td>\u7EBF\u7A0B\u521B\u5EFA\u5B8C\u6210\u540E\uFF0C\u4E5F\u53EF\u4EE5\u8BBE\u7F6Edaemon\u5C5E\u6027\uFF0C\u5FC5\u987B\u5728start\u4E4B\u524D</td></tr><tr><td>\u7EBF\u7A0B.isDaemon()/daemon</td><td>\u8FD4\u56DEdaemon\u72B6\u6001</td></tr></tbody></table><p>daemon\u7EBF\u7A0B\u5E94\u7528\u573A\u666F</p><ul><li><p>\u968F\u65F6\u53EF\u4EE5\u88AB\u7EC8\u6B62\u7684\u7EBF\u7A0B</p></li><li><p>\u540E\u53F0\u4EFB\u52A1\uFF0C\u5982\u53D1\u9001\u5FC3\u8DF3\u5305\u3001\u76D1\u63A7\uFF1B</p></li><li><p>\u4E3B\u7EBF\u7A0B\u5DE5\u4F5C\u624D\u6709\u7528\u7684\u7EBF\u7A0B\uFF0C\u5982\u4E3B\u7EBF\u7A0B\u7EF4\u62A4\u8FD9\u516C\u5171\u8D44\u6E90\uFF0C\u4E3B\u7EBF\u7A0B\u5DF2\u7ECF\u6E05\u7406\u4E86\uFF0C\u51C6\u5907\u9000\u51FA\uFF0C\u800C\u5DE5\u4F5C\u7EBF\u7A0B\u4F7F\u7528\u8FD9\u4E9B\u8D44\u6E90\u5DF2\u7ECF\u6CA1\u6709\u610F\u4E49\u4E86\uFF0C\u4E00\u8D77\u9000\u51FA\u6700\u5408\u9002</p></li></ul><p>daemon\u793A\u4F8B</p><div class="language-python ext-py"><pre class="language-python"><code><span class="token comment">#!/usr/bin/env python</span>
<span class="token comment"># -*-coding:utf-8-*-</span>

<span class="token keyword">import</span> time
<span class="token keyword">from</span> threading <span class="token keyword">import</span> Thread<span class="token punctuation">,</span> current_thread


<span class="token keyword">def</span> <span class="token function">show_msg</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">0.1</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;{}\\n&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>current_thread<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>getName<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> end<span class="token operator">=</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span>


<span class="token comment"># \u5F00\u542F10\u4E2A\u7EBF\u7A0B</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    Thread<span class="token punctuation">(</span>target<span class="token operator">=</span>show_msg<span class="token punctuation">)</span><span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># \u672A\u8BBE\u7F6Edaemon\u5C5E\u6027\uFF0C\u9ED8\u8BA4\u7EE7\u627F\u592B\u7EBF\u7A0B\uFF0C\u9ED8\u8BA4\u4E3AFalse</span>
    <span class="token comment"># Thread(target=show_msg, daemon=True).start()  # \u8BBE\u7F6Edaemon\u5C5E\u6027</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;End&quot;</span><span class="token punctuation">)</span>

<span class="token comment"># \u672A\u8BBE\u7F6Edaemon\u65F6\uFF0C\u8F93\u51FA\u7ED3\u679C\uFF1A</span>
<span class="token comment">#     End</span>
<span class="token comment">#     Thread-3</span>
<span class="token comment">#     Thread-2</span>
<span class="token comment">#     Thread-7</span>
<span class="token comment">#     Thread-5</span>
<span class="token comment">#     Thread-4</span>
<span class="token comment">#     Thread-6</span>
<span class="token comment">#     Thread-9</span>
<span class="token comment">#     Thread-1</span>
<span class="token comment">#     Thread-10</span>
<span class="token comment">#     Thread-8</span>
<span class="token comment">#</span>
<span class="token comment"># \u8BBE\u7F6Edaemon\u65F6\uFF0C\u7531\u4E8E\u4E3B\u7EBF\u7A0B\u5F88\u5FEB\u4F1A\u6267\u884C\u5B8C\u6210\uFF0C\u800C\u5B50\u7EBF\u7A0B\u4F1A\u963B\u585E0.1\u79D2\uFF0C\u6240\u4EE5\u4E0D\u4F1A\u8F93\u51FA\u5B50\u7EBF\u7A0B\u540D\uFF0C\u8F93\u51FA\u7ED3\u679C\uFF1A</span>
<span class="token comment">#     End</span>
</code></pre></div><h3 id="join\u963B\u585E\u7EBF\u7A0B" tabindex="-1"><a class="header-anchor" href="#join\u963B\u585E\u7EBF\u7A0B" aria-hidden="true">#</a> join\u963B\u585E\u7EBF\u7A0B</h3><p>\u5982\u679C\u60F3\u8BA9\u6240\u6709\u7EBF\u7A0B\u5DE5\u4F5C\u5B8C\u6BD5\u540E\uFF0C\u4E3B\u7EBF\u7A0B\u518D\u6267\u884C\u4EE3\u7801\uFF0C\u6B64\u65F6\u53EF\u4EE5\u4F7F\u7528<code>\u7EBF\u7A0B.join()</code>\u6765\u7B49\u5F85\u7EBF\u7A0B\u6267\u884C\u5B8C\u6BD5</p><p>join\u4F5C\u7528</p><ul><li>\u963B\u585E\u7EBF\u7A0B\u76F4\u5230\u6267\u884C\u5B8C\u6BD5</li><li>\u5B83\u8FD8\u53EF\u4EE5\u8BBE\u7F6E\u8D85\u65F6\u65F6\u95F4\uFF0C\u5F53\u8D85\u8FC7\u8D85\u65F6\u65F6\u95F4\uFF0C\u4E0D\u7BA1\u7EBF\u7A0B\u662F\u5426\u6267\u884C\u5B8C\u6BD5\uFF0C\u90FD\u4F1A\u5411\u4E0B\u6267\u884C</li><li><code>join</code>\u65E0\u89C6<code>daemon</code>\u7684\u503C</li></ul><p>\u5C06<code>daemon</code>\u4EE3\u7801\u6539\u9020\u4E00\u4E0B\uFF0C\u4F7F\u4EE3\u7801\u6700\u540E\u518D\u8F93\u51FA<code>End</code></p><div class="language-python ext-py"><pre class="language-python"><code><span class="token comment">#!/usr/bin/env python</span>
<span class="token comment"># -*-coding:utf-8-*-</span>

<span class="token keyword">import</span> time
<span class="token keyword">from</span> threading <span class="token keyword">import</span> Thread<span class="token punctuation">,</span> current_thread


<span class="token keyword">def</span> <span class="token function">show_msg</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">0.1</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;{}\\n&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>current_thread<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>getName<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> end<span class="token operator">=</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span>


<span class="token comment"># \u5F00\u542F10\u4E2A\u7EBF\u7A0B</span>
threads <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    t <span class="token operator">=</span> Thread<span class="token punctuation">(</span>target<span class="token operator">=</span>show_msg<span class="token punctuation">,</span> daemon<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    t<span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span>
    threads<span class="token punctuation">.</span>append<span class="token punctuation">(</span>t<span class="token punctuation">)</span>  <span class="token comment"># \u5C06\u7EBF\u7A0B\u6536\u96C6\u8D77\u6765</span>

<span class="token comment"># \u7B49\u5F85\u6BCF\u4E2A\u7EBF\u7A0B\u6267\u884C\u5B8C\u6BD5</span>
<span class="token keyword">for</span> thread <span class="token keyword">in</span> threads<span class="token punctuation">:</span>
    thread<span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;End&quot;</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="\u7EBF\u7A0B\u9501" tabindex="-1"><a class="header-anchor" href="#\u7EBF\u7A0B\u9501" aria-hidden="true">#</a> \u7EBF\u7A0B\u9501</h3><p>Lock\u76F8\u5173\u7C7B\uFF1A</p><ul><li><p>Lock\uFF1A\u72EC\u5360\u9501\u6216\u53EB\u505A\u4E92\u65A5\u9501\uFF0C\u540C\u4E00\u65F6\u95F4\u53EA\u6709\u4E00\u4E2A\u7EBF\u7A0B\u80FD\u83B7\u53D6\u5230\u9501</p></li><li><p>RLock\uFF1A\u53EF\u91CD\u5165\u9501\uFF0C\u540C\u4E00\u65F6\u95F4\u53EA\u6709\u4E00\u4E2A\u7EBF\u7A0B\u80FD\u83B7\u53D6\u5230\u9501\uFF0C\u5728\u540C\u4E00\u4E2A\u7EBF\u7A0B\u5185\u53EF\u591A\u6B21acquire()\uFF0C\u4F46\u4E5F\u9700\u8981\u6267\u884C\u76F8\u540C\u6B21\u6570\u7684release()</p></li></ul><p>lock\u5B9E\u4F8B\u65B9\u6CD5</p><table><thead><tr><th>\u65B9\u6CD5</th><th>\u8BF4\u660E</th></tr></thead><tbody><tr><td>acquire(blocking, timeout)</td><td>\u5C1D\u8BD5\u83B7\u53D6\u9501\uFF0C\u83B7\u53D6\u6210\u529F\u8FD4\u56DETrue\uFF0C\u83B7\u53D6\u5931\u8D25\u7684\u8BDD\uFF1A<br>\uFF081\uFF09\u9ED8\u8BA4\u4F1A\u4E00\u76F4\u963B\u585E<br>\uFF082\uFF09\u5982\u679C\u6307\u5B9Ablocking\u4E3AFalse\uFF0C\u76F4\u63A5\u8FD4\u56DEFalse\uFF0C\u8868\u793A\u83B7\u53D6\u9501\u5931\u8D25<br>\uFF083\uFF09\u5982\u679C\u6307\u5B9A\u4E86timeout\uFF0C\u90A3\u4E48\u8D85\u65F6\u4EE5\u540E\u8FD4\u56DEFalse</td></tr><tr><td>release()</td><td>\u91CA\u653E\u9501</td></tr><tr><td>locked()</td><td>\u67E5\u770B\u662F\u5426\u4E0A\u9501\uFF0C\u5DF2\u4E0A\u9501\u8FD4\u56DETrue\uFF0C\u5426\u5219\u8FD4\u56DEFalse\uFF08\u6CE8\u610FRLOCK\u5B9E\u4F8B\u6CA1\u6709\u8FD9\u4E2A\u65B9\u6CD5\uFF09</td></tr></tbody></table><p>\u6B7B\u9501\u548CRLOCK</p><p>\u8FDE\u7EED\u4E24\u6B21acquire\u8BF7\u6C42\u4F1A\u5BFC\u81F4\u6B7B\u9501\uFF0C\u56E0\u4E3A\u7B2C\u4E00\u6B21\u83B7\u5F97\u9501\u4E4B\u540E\u8FD8\u6CA1\u6709\u91CA\u653E\u65F6\uFF0C\u7B2C\u4E8C\u6B21acquire\u8BF7\u6C42\u7D27\u63A5\u7740\u5C31\u5230\u6765\uFF0C</p><p>\u4F46\u662Facquire\u4F1A\u8BA9\u7A0B\u5E8F\u963B\u585E\uFF0C\u65E0\u6CD5\u6267\u884Crelease()\uFF0C\u8FD9\u5C31\u5BFC\u81F4\u9501\u6C38\u8FDC\u65E0\u6CD5\u91CA\u653E\uFF0C\u5C31\u50CF\u4E0B\u9762\u8FD9\u6837</p><div class="language-python ext-py"><pre class="language-python"><code>Lock<span class="token punctuation">.</span>acquire<span class="token punctuation">(</span><span class="token punctuation">)</span>
Lock<span class="token punctuation">.</span>acquire<span class="token punctuation">(</span><span class="token punctuation">)</span>
Lock<span class="token punctuation">.</span>release<span class="token punctuation">(</span><span class="token punctuation">)</span>
Lock<span class="token punctuation">.</span>release<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p>RLock\u5C31\u4E0D\u5B58\u5728\u4E0A\u9762\u63D0\u5230\u7684\u6B7B\u9501\u95EE\u9898\uFF0C\u53EA\u9700\u8981\u4FDD\u8BC1\u6709\u591A\u5C11\u6B21acquire()\uFF0C\u5C31\u6709\u591A\u5C11\u6B21release()\u5373\u53EF</p><p>Lock\u6F14\u793A</p><div class="language-python ext-py"><pre class="language-python"><code><span class="token comment">#!/usr/bin/env python</span>
<span class="token comment"># -*-coding:utf-8-*-</span>


<span class="token keyword">from</span> threading <span class="token keyword">import</span> Thread<span class="token punctuation">,</span> current_thread<span class="token punctuation">,</span> Lock<span class="token punctuation">,</span> RLock

<span class="token comment"># \u521D\u59CB\u5316\u9501</span>
lock <span class="token operator">=</span> Lock<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># \u5168\u5C40\u53D8\u91CF</span>
data <span class="token operator">=</span> <span class="token number">0</span>


<span class="token keyword">def</span> <span class="token function">add</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">global</span> data
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1000000</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># \u672A\u52A0\u9501</span>
        data <span class="token operator">+=</span> n

        <span class="token comment"># \u52A0\u9501\uFF08\u65B9\u5F0F\u4E00\uFF09</span>
        lock<span class="token punctuation">.</span>acquire<span class="token punctuation">(</span><span class="token punctuation">)</span>
        data <span class="token operator">+=</span> n
        lock<span class="token punctuation">.</span>release<span class="token punctuation">(</span><span class="token punctuation">)</span>

        <span class="token comment"># \u52A0\u9501\uFF08\u65B9\u5F0F\u4E8C\uFF09</span>
        <span class="token comment"># if lock.acquire():</span>
        <span class="token comment">#     data += n</span>
        <span class="token comment">#     lock.release()</span>

        <span class="token comment"># \u52A0\u9501\uFF08\u65B9\u5F0F\u4E09\uFF09</span>
        <span class="token comment"># with lock:</span>
        <span class="token comment">#     data += n</span>


<span class="token comment"># \u5F00\u542F2\u4E2A\u7EBF\u7A0B, \u4E00\u4E2A\u7EBF\u7A0B\u4E0D\u65AD+1\uFF0C\u53E6\u4E00\u4E2A\u7EBF\u7A0B\u4E0D\u65AD-1</span>
t1 <span class="token operator">=</span> Thread<span class="token punctuation">(</span>target<span class="token operator">=</span>add<span class="token punctuation">,</span> args<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
t2 <span class="token operator">=</span> Thread<span class="token punctuation">(</span>target<span class="token operator">=</span>add<span class="token punctuation">,</span> args<span class="token operator">=</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
t1<span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span>
t2<span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span>
t1<span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token punctuation">)</span>
t2<span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;End&quot;</span><span class="token punctuation">)</span>

<span class="token comment"># \u672A\u52A0\u9501\u8F93\u51FA\u7ED3\u679C\uFF1A</span>
<span class="token comment"># 924375</span>
<span class="token comment"># End</span>
<span class="token comment"># \u52A0\u9501\u8F93\u51FA\u7ED3\u679C</span>
<span class="token comment"># 0</span>
<span class="token comment"># End</span>
</code></pre></div><h3 id="\u7EBF\u7A0B\u5C40\u90E8\u53D8\u91CF" tabindex="-1"><a class="header-anchor" href="#\u7EBF\u7A0B\u5C40\u90E8\u53D8\u91CF" aria-hidden="true">#</a> \u7EBF\u7A0B\u5C40\u90E8\u53D8\u91CF</h3><p>\u521B\u5EFA\u4E00\u4E2A\u5168\u5C40\u53D8\u91CF<code>request = local()</code>\uFF0C\u4F7F\u7528\u591A\u7EBF\u7A0B\u5BF9<code>request</code>\u8FDB\u884C\u4FEE\u6539\u65F6\uFF0C\u4F1A\u5148\u5C06request\u62F7\u8D1D\u5230\u81EA\u8EAB\u7EBF\u7A0B\u4E2D\u4E00\u4EFD\uFF0C\u4E0D\u4F1A\u5F71\u54CD\u5230\u5168\u5C40\u548C\u5176\u4ED6\u7EBF\u7A0B\u4E2D\u7684<code>request</code></p><div class="language-python ext-py"><pre class="language-python"><code><span class="token comment">#!/usr/bin/env python</span>
<span class="token comment"># -*-coding:utf-8-*-</span>

<span class="token keyword">import</span> time
<span class="token keyword">import</span> logging
<span class="token keyword">from</span> threading <span class="token keyword">import</span> Thread<span class="token punctuation">,</span> local<span class="token punctuation">,</span> current_thread<span class="token punctuation">,</span> active_count

<span class="token comment"># \u521D\u59CB\u5316\u65E5\u5FD7</span>
FORMAT <span class="token operator">=</span> <span class="token string">&#39;%(asctime)-15s\\t [%(threadName)s, %(thread)d] %(message)s&#39;</span>
logging<span class="token punctuation">.</span>basicConfig<span class="token punctuation">(</span><span class="token builtin">format</span><span class="token operator">=</span>FORMAT<span class="token punctuation">)</span>

<span class="token comment"># \u521D\u59CB\u5316\u5168\u5C40\u53D8\u91CF</span>
<span class="token comment"># class Request(object): pass</span>
<span class="token comment"># request = Request()</span>


<span class="token comment"># \u521D\u59CB\u5316\u7EBF\u7A0B\u5C40\u90E8\u53D8\u91CF</span>
request <span class="token operator">=</span> local<span class="token punctuation">(</span><span class="token punctuation">)</span>


<span class="token keyword">def</span> <span class="token function">thread_local</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span>
    request<span class="token punctuation">.</span>thread_name <span class="token operator">=</span> current_thread<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>getName<span class="token punctuation">(</span><span class="token punctuation">)</span>
    time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
    logging<span class="token punctuation">.</span>warning<span class="token punctuation">(</span><span class="token string">&#39;request.thread_name: {}&#39;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>thread_name<span class="token punctuation">)</span><span class="token punctuation">)</span>


<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    Thread<span class="token punctuation">(</span>target<span class="token operator">=</span>thread_local<span class="token punctuation">,</span> args<span class="token operator">=</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">while</span> active_count<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">1</span><span class="token punctuation">:</span>
    time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;End&quot;</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="\u7EBF\u7A0B\u540C\u6B65-\u4E8B\u4EF6event" tabindex="-1"><a class="header-anchor" href="#\u7EBF\u7A0B\u540C\u6B65-\u4E8B\u4EF6event" aria-hidden="true">#</a> \u7EBF\u7A0B\u540C\u6B65 - \u4E8B\u4EF6Event</h3><p>Event\u662F\u7EBF\u7A0B\u901A\u4FE1\u95F4\u6700\u7B80\u5355\u7684\u5B9E\u73B0\uFF0C\u4F7F\u7528\u4E00\u4E2A\u53D8\u91CFflag\uFF0C\u901A\u8FC7flag\u7684True\u6216False\u53D8\u5316\u6765\u6267\u884C\u4E0D\u540C\u64CD\u4F5C</p><p>Event\u53D8\u5316\u4F1A\u901A\u77E5\u5230\u6240\u6709\u7EBF\u7A0B</p><p>Event\u5B9E\u4F8B\u65B9\u6CD5</p><table><thead><tr><th>\u65B9\u6CD5</th><th>\u8BF4\u660E</th></tr></thead><tbody><tr><td>set()</td><td>\u6807\u8BB0\u4E3ATrue</td></tr><tr><td>clear()</td><td>\u6807\u8BB0\u4E3AFalse</td></tr><tr><td>is_set()</td><td>\u65B0\u521B\u5EFA\u7684event\u6216\u4F7F\u7528<code>clear</code>()\u540E\u4E3AFalse\uFF0C\u5F53\u8BBE\u7F6E<code>set</code>()\u540E\u8FD4\u56DETrue</td></tr><tr><td>wait(timeout=None)</td><td>\u7B49\u5F85\uFF0C\u6EE1\u8DB3\u4EE5\u4E0B\u6761\u4EF6\u540E\u7ACB\u5373\u6267\u884C\uFF1A<br>\uFF081\uFF09\u5F53\u8C03\u7528<code>set</code>()\u540E\u7ACB\u5373\u6267\u884C\uFF0C\u6B64\u65F6wait\u8FD4\u56DE\u503C\u4E3ATrue<br>\uFF082\uFF09\u5F53\u8D85\u65F6\u540E\u7ACB\u5373\u6267\u884C\uFF0C\u6B64\u65F6wait\u8FD4\u56DE\u503C\u4E3AFalse</td></tr></tbody></table><p>Event\u6F14\u793A</p><div class="language-python ext-py"><pre class="language-python"><code><span class="token comment">#!/usr/bin/env python</span>
<span class="token comment"># -*-coding:utf-8-*-</span>

<span class="token keyword">import</span> time
<span class="token keyword">import</span> threading
<span class="token keyword">import</span> logging

FORMAT <span class="token operator">=</span> <span class="token string">&#39;%(asctime)-15s\\t [%(threadName)s, %(thread)d] %(message)s&#39;</span>
logging<span class="token punctuation">.</span>basicConfig<span class="token punctuation">(</span><span class="token builtin">format</span><span class="token operator">=</span>FORMAT<span class="token punctuation">)</span>


<span class="token keyword">def</span> <span class="token function">test</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># \u5B50\u7EBF\u7A0B\u4E2D\u6BCF\u96943\u79D2\u5FAA\u73AF\u4E00\u6B21\uFF0C\u65E0\u9650\u5FAA\u73AF\uFF0C\u9664\u975E\u4E3B\u7EBF\u7A0B\u4E3B\u52A8\u6682\u505C\uFF0C\u8FD9\u91CC\u662F\u4E00\u4E2A\u6280\u5DE7\uFF0C\u4EE5\u540E\u53EF\u4EE5\u4F7F\u7528</span>
    <span class="token keyword">while</span> <span class="token keyword">not</span> event<span class="token punctuation">.</span>wait<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        logging<span class="token punctuation">.</span>warning<span class="token punctuation">(</span><span class="token string">&quot;Running&quot;</span><span class="token punctuation">)</span>


<span class="token comment"># \u521D\u59CB\u5316event</span>
event <span class="token operator">=</span> threading<span class="token punctuation">.</span>Event<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># \u5F00\u542F\u4E24\u4E2A\u5B50\u7EBF\u7A0B</span>
threading<span class="token punctuation">.</span>Thread<span class="token punctuation">(</span>target<span class="token operator">=</span>test<span class="token punctuation">,</span> args<span class="token operator">=</span><span class="token punctuation">(</span>event<span class="token punctuation">,</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span>
threading<span class="token punctuation">.</span>Thread<span class="token punctuation">(</span>target<span class="token operator">=</span>test<span class="token punctuation">,</span> args<span class="token operator">=</span><span class="token punctuation">(</span>event<span class="token punctuation">,</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># \u6A21\u62DF\u4E3B\u7EBF\u7A0B\u8FD0\u884C\u4E2D</span>
time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span>

<span class="token comment"># \u901A\u77E5\u6240\u6709\u5B50\u7EBF\u7A0B\u9000\u51FA</span>
event<span class="token punctuation">.</span><span class="token builtin">set</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="event\u5E94\u7528-\u5EF6\u8FDF\u5668-timer" tabindex="-1"><a class="header-anchor" href="#event\u5E94\u7528-\u5EF6\u8FDF\u5668-timer" aria-hidden="true">#</a> Event\u5E94\u7528 - \u5EF6\u8FDF\u5668 Timer</h3><div class="language-python ext-py"><pre class="language-python"><code><span class="token comment">#!/usr/bin/env python</span>
<span class="token comment"># -*-coding:utf-8-*-</span>


<span class="token keyword">import</span> logging
<span class="token keyword">from</span> threading <span class="token keyword">import</span> Timer

<span class="token comment"># \u521D\u59CB\u5316\u65E5\u5FD7</span>
FORMAT <span class="token operator">=</span> <span class="token string">&#39;%(asctime)-15s\\t [%(threadName)s, %(thread)8d] %(message)s&#39;</span>
logging<span class="token punctuation">.</span>basicConfig<span class="token punctuation">(</span><span class="token builtin">format</span><span class="token operator">=</span>FORMAT<span class="token punctuation">)</span>


<span class="token keyword">def</span> <span class="token function">add</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">:</span>
    ret <span class="token operator">=</span> x <span class="token operator">+</span> y
    logging<span class="token punctuation">.</span>warning<span class="token punctuation">(</span>ret<span class="token punctuation">)</span>
    <span class="token keyword">return</span> ret


t <span class="token operator">=</span> Timer<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> add<span class="token punctuation">,</span> args<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># \u521B\u5EFA\u4E00\u4E2A\u5B9A\u65F6\u5668\uFF0C5\u79D2\u540E\u6267\u884Cadd\u51FD\u6570</span>
t<span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># \u542F\u52A8\u7EBF\u7A0B</span>

logging<span class="token punctuation">.</span>warning<span class="token punctuation">(</span><span class="token string">&quot;\u5EF6\u8FDF\u5668\u5DF2\u7ECF\u542F\u52A8...&quot;</span><span class="token punctuation">)</span>
logging<span class="token punctuation">.</span>warning<span class="token punctuation">(</span><span class="token string">&quot;\u505A\u4E00\u4E9B\u5176\u4ED6\u7684\u4E8B...&quot;</span><span class="token punctuation">)</span>

<span class="token comment"># \u53D6\u6D88\u7EBF\u7A0B</span>
<span class="token comment">#   \u6B64\u65F6\u51FD\u6570\u8FD8\u6CA1\u6709\u6267\u884C\uFF0C\u7A0B\u5E8F\u9000\u51FA</span>
<span class="token comment">#   \u5982\u679C\u51FD\u6570\u5DF2\u7ECF\u8FD0\u884C\uFF0C\u6B64\u65F6cancel\u4F9D\u7136\u53EF\u4EE5\u6B63\u5E38\u6267\u884C\uFF0C\u4F46\u662F\u51FD\u6570\u5DF2\u7ECF\u65E0\u6CD5\u53D6\u6D88</span>
<span class="token comment"># t.cancel()</span>
</code></pre></div><h3 id="\u7EBF\u7A0B\u540C\u6B65-\u6761\u4EF6\u53D8\u91CFcondition" tabindex="-1"><a class="header-anchor" href="#\u7EBF\u7A0B\u540C\u6B65-\u6761\u4EF6\u53D8\u91CFcondition" aria-hidden="true">#</a> \u7EBF\u7A0B\u540C\u6B65 - \u6761\u4EF6\u53D8\u91CFCondition</h3><p>Condition\u5185\u90E8\u4F1A\u7EF4\u62A4\u4E00\u4E2A\u9501\uFF08\u9ED8\u8BA4\u662FRLock\uFF09\uFF0C\u83B7\u53D6\u5230\u9501\u7684\u7EBF\u7A0B\u4F7F\u7528notify\u673A\u5236\u6765\u901A\u77E5\uFF08\u6216\u79F0\u4E3A\u5524\u9192\uFF09\u5176\u4ED6\u7EBF\u7A0B\uFF081\u4E2A\u6216\u591A\u4E2A\uFF09\uFF0C\u7136\u540E\u4F7F\u7528wait\u91CA\u653E\u9501\u5E76\u8FDB\u5165\u7B49\u5F85\uFF0C\u5F53\u81EA\u8EAB\u88AB\u5176\u4ED6\u7EBF\u7A0B\u901A\u77E5\uFF08\u6216\u5524\u9192\uFF09\u65F6\uFF0C\u53C8\u4F1A\u91CD\u65B0\u83B7\u53D6\u9501\uFF0C\u7EE7\u7EED\u5411\u4E0B\u6267\u884C</p><p>Condition\u5B9E\u4F8B\u65B9\u6CD5</p><table><thead><tr><th>\u65B9\u6CD5</th><th>\u8BF4\u660E</th></tr></thead><tbody><tr><td>acquire(blocking, timeout)</td><td>\u4E0ERLock\u5B9E\u4F8B\u7684acquire\u65B9\u6CD5\u4E00\u81F4</td></tr><tr><td>release()</td><td>\u4E0ERLock\u5B9E\u4F8B\u7684release\u65B9\u6CD5\u4E00\u81F4</td></tr><tr><td>notify(n=1)</td><td>\u5524\u9192\u4E00\u4E2A\u6216\u591A\u4E2A\u7EBF\u7A0B</td></tr><tr><td>notify_all()</td><td>\u5524\u9192\u6240\u6709\u7EBF\u7A0B</td></tr><tr><td>wait(timeout=None)</td><td>\u8FDB\u5165\u7B49\u5F85\u72B6\u6001\uFF08\u8FD9\u4F1A\u91CA\u653E\u9501\uFF09\uFF0C\u76F4\u5230\u88AB\u5524\u9192\u6216\u8D85\u65F6\uFF08\u53C8\u4F1A\u91CD\u65B0\u83B7\u53D6\u9501\uFF09\uFF0C\u88AB\u5524\u9192\u8FD4\u56DETrue\uFF0C\u8D85\u65F6\u8FD4\u56DEFalse<br>\u5982\u679C\u672A\u83B7\u5F97\u9501\u5C31\u4F7F\u7528wait\uFF0C\u5219\u62A5\u9519<code>RuntimeError: cannot wait on un-acquired lock</code></td></tr><tr><td>wait_for(predicate, timeout=None)</td><td>wait_for\u662F\u66F4\u7075\u6D3B\u7684\u4E00\u79CDwait\u65B9\u5F0F\uFF0Cpredicate\u9700\u8981\u6307\u5B9A\u4E00\u4E2A\u53EF\u8C03\u7528\u5BF9\u8C61\uFF0C<br>\uFF081\uFF09\u5F53predicate()\u8FD4\u56DETrue\uFF0C\u5219\u7EE7\u7EED\u5F80\u4E0B\u6267\u884C<br>\uFF082\uFF09\u5F53predicate()\u8FD4\u56DEFalse\uFF0C\u5219\u548Cwait\u884C\u4E3A\u4E00\u81F4\u4E86<br>\uFF083\uFF09timeout\u53C2\u6570\u542B\u4E49\u4E0D\u53D8\uFF0C\u82E5\u8D85\u65F6\u4EE5\u540E\u8FD8\u4F1A\u8C03\u7528predicate\u4E00\u6B21</td></tr></tbody></table><p>\u751F\u4EA7\u8005\u6D88\u8D39\u8005\u6A21\u578B</p><div class="language-python ext-py"><pre class="language-python"><code><span class="token comment">#!/usr/bin/env python</span>
<span class="token comment"># -*-coding:utf-8-*-</span>

<span class="token keyword">import</span> logging
<span class="token keyword">import</span> random
<span class="token keyword">import</span> time
<span class="token keyword">from</span> threading <span class="token keyword">import</span> Thread<span class="token punctuation">,</span> Condition<span class="token punctuation">,</span> Lock
<span class="token keyword">from</span> queue <span class="token keyword">import</span> Queue

<span class="token comment"># \u521D\u59CB\u5316\u65E5\u5FD7</span>
FORMAT <span class="token operator">=</span> <span class="token string">&#39;%(asctime)-15s\\t [%(threadName)s, %(thread)d] %(message)s&#39;</span>
logging<span class="token punctuation">.</span>basicConfig<span class="token punctuation">(</span><span class="token builtin">format</span><span class="token operator">=</span>FORMAT<span class="token punctuation">)</span>

<span class="token comment"># \u521D\u59CB\u5316\u6761\u4EF6\u53D8\u91CF</span>
condition <span class="token operator">=</span> Condition<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># condition = Condition(Lock())</span>

<span class="token comment"># \u521D\u59CB\u5316\u5168\u5C40\u6570\u636E</span>
data <span class="token operator">=</span> Queue<span class="token punctuation">(</span>maxsize<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">)</span>


<span class="token keyword">class</span> <span class="token class-name">Producer</span><span class="token punctuation">(</span>Thread<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token builtin">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">run</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
        <span class="token keyword">def</span> <span class="token function">wrapper</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token comment"># \u83B7\u53D6\u9501</span>
            <span class="token comment"># \u6CE8\u610F\uFF1A\u5982\u679C\u76F4\u63A5\u4F7F\u7528condition.acquire()\u7684\u8BDD\u4E0D\u8981\u5FD8\u8BB0release(),</span>
            <span class="token comment">#      \u5426\u5219\u5F53condition = Condition(Lock())\u65F6\u4F1A\u9020\u6210\u6B7B\u9501\uFF0C\u4F7F\u7528\u9ED8\u8BA4\u7684RLock\u4E5F\u4F1A\u9020\u6210\u6B7B\u9501\uFF0C\u53EA\u662F\u4E0D\u5BB9\u6613\u590D\u73B0</span>
            <span class="token keyword">with</span> condition<span class="token punctuation">:</span>
                <span class="token comment"># \u6DFB\u52A0\u6570\u636E\u81F3\u5BB9\u5668\u6EE1</span>
                <span class="token keyword">while</span> <span class="token keyword">not</span> data<span class="token punctuation">.</span>full<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                    item <span class="token operator">=</span> random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">99</span><span class="token punctuation">)</span>
                    data<span class="token punctuation">.</span>put<span class="token punctuation">(</span>item<span class="token punctuation">)</span>
                    logging<span class="token punctuation">.</span>warning<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;\u6DFB\u52A0\u6570\u636E\u9879: </span><span class="token interpolation"><span class="token punctuation">{</span>item<span class="token punctuation">}</span></span><span class="token string">, \u5F53\u524D\u961F\u5217\u5927\u5C0F: </span><span class="token interpolation"><span class="token punctuation">{</span>data<span class="token punctuation">.</span>qsize<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>

                <span class="token comment"># \u901A\u77E5\u5C0F\u4F19\u4F34\u6D88\u8D39</span>
                condition<span class="token punctuation">.</span>notify<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># \u901A\u77E5\uFF0C\u4F46\u8FD8\u672A\u91CA\u653E\u9501</span>
                logging<span class="token punctuation">.</span>warning<span class="token punctuation">(</span><span class="token string">&quot;\u961F\u5217\u5DF2\u6EE1, \u901A\u77E5\u5176\u4ED6\u7EBF\u7A0B\u6D88\u8D39&quot;</span><span class="token punctuation">)</span>
                condition<span class="token punctuation">.</span>wait<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># \u91CA\u653E\u9501\uFF0C\u5E76\u8FDB\u5165\u7B49\u5F85\u6A21\u5F0F; \u88AB\u5524\u9192\u65F6\u53C8\u4F1A\u91CD\u65B0\u83B7\u53D6\u9501</span>

        <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
            wrapper<span class="token punctuation">(</span><span class="token punctuation">)</span>


<span class="token keyword">class</span> <span class="token class-name">Consumer</span><span class="token punctuation">(</span>Thread<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token builtin">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">run</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
        <span class="token keyword">def</span> <span class="token function">wrapper</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">with</span> condition<span class="token punctuation">:</span>
                <span class="token keyword">while</span> <span class="token keyword">not</span> data<span class="token punctuation">.</span>empty<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                    item <span class="token operator">=</span> data<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token punctuation">)</span>
                    logging<span class="token punctuation">.</span>warning<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;\u6D88\u8D39\u6570\u636E\u9879: </span><span class="token interpolation"><span class="token punctuation">{</span>item<span class="token punctuation">}</span></span><span class="token string">, \u5F53\u524D\u961F\u5217\u5927\u5C0F: </span><span class="token interpolation"><span class="token punctuation">{</span>data<span class="token punctuation">.</span>qsize<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
                condition<span class="token punctuation">.</span>notify<span class="token punctuation">(</span><span class="token punctuation">)</span>
                logging<span class="token punctuation">.</span>warning<span class="token punctuation">(</span><span class="token string">&quot;\u961F\u5217\u5DF2\u7A7A, \u901A\u77E5\u5176\u4ED6\u7EBF\u7A0B\u6DFB\u52A0\\n&quot;</span><span class="token punctuation">)</span>
                time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>  <span class="token comment"># \u6682\u505C\u4E00\u4E0B\uFF0C\u65B9\u4FBF\u63A7\u5236\u53F0\u770B\u7684\u6E05\u695A</span>
                condition<span class="token punctuation">.</span>wait<span class="token punctuation">(</span><span class="token punctuation">)</span>

        <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
            wrapper<span class="token punctuation">(</span><span class="token punctuation">)</span>


<span class="token comment"># \u521B\u5EFA\u591A\u4E2A\u751F\u4EA7\u8005\u548C\u6D88\u8D39\u8005</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    t <span class="token operator">=</span> Producer<span class="token punctuation">(</span><span class="token punctuation">)</span>
    t<span class="token punctuation">.</span>setName<span class="token punctuation">(</span><span class="token string">&quot;Producer-{}&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    t<span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span>

    t <span class="token operator">=</span> Consumer<span class="token punctuation">(</span><span class="token punctuation">)</span>
    t<span class="token punctuation">.</span>setName<span class="token punctuation">(</span><span class="token string">&quot;Consumer-{}&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    t<span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="\u7EBF\u7A0B\u540C\u6B65-barrier" tabindex="-1"><a class="header-anchor" href="#\u7EBF\u7A0B\u540C\u6B65-barrier" aria-hidden="true">#</a> \u7EBF\u7A0B\u540C\u6B65 - Barrier</h3><h3 id="\u7EBF\u7A0B\u540C\u6B65-semaphore" tabindex="-1"><a class="header-anchor" href="#\u7EBF\u7A0B\u540C\u6B65-semaphore" aria-hidden="true">#</a> \u7EBF\u7A0B\u540C\u6B65 - Semaphore</h3><h3 id="\u7EBF\u7A0B\u6C60-threadpoolexecutor" tabindex="-1"><a class="header-anchor" href="#\u7EBF\u7A0B\u6C60-threadpoolexecutor" aria-hidden="true">#</a> \u7EBF\u7A0B\u6C60 - ThreadPoolExecutor</h3><p>ThreadPoolExecutor\u6784\u9020\u53C2\u6570</p><table><thead><tr><th>\u53C2\u6570</th><th>\u8BF4\u660E</th></tr></thead><tbody><tr><td>max_workers</td><td>\u6307\u5B9A\u7EBF\u7A0B\u6C60\u7684\u6700\u5927\u7EBF\u7A0B\u6570\uFF0C\u9ED8\u8BA4\u4E3ACPU\u6838\u6570\u76845\u500D</td></tr><tr><td>thread_name_prefix</td><td>\u6307\u5B9A\u7EBF\u7A0B\u6C60\u4E2D\u7EBF\u7A0B\u7684\u540D\u79F0\u524D\u7F00</td></tr></tbody></table><p>ThreadPoolExecutor\u5B9E\u4F8B\u65B9\u6CD5</p><table><thead><tr><th>\u65B9\u6CD5</th><th>\u8BF4\u660E</th></tr></thead><tbody><tr><td>submit(fn, *args, **kwargs)</td><td>\u63D0\u4EA4\u4EFB\u52A1\uFF0C\u7EBF\u7A0B\u6C60\u4F1A\u5206\u914D\u4E00\u4E2A\u7EBF\u7A0B\u8FDF\u603B\u4EFB\u52A1\uFF0C\u8FD4\u56DE\u4E00\u4E2AFuture\u5B9E\u4F8B\uFF0C\u5982\u679C\u6C60\u5DF2\u7ECF\u6EE1\u4E86\uFF0C\u8FD8\u53EF\u4EE5\u7EE7\u7EED\u63D0\u4EA4</td></tr><tr><td>shutdown(wait=True)</td><td>\u6E05\u7406\u6C60\uFF0C\u6C60\u4E2D\u7684\u7EBF\u7A0B/\u8FDB\u7A0B\u5168\u90E8\u6740\u6389\uFF0C\u540C\u65F6\u4E0D\u518D\u63A5\u53D7\u65B0\u63D0\u4EA4\u7684\u4EFB\u52A1\uFF0C<br>\u5982\u679C\u7EE7\u7EED\u63D0\u4EA4\u4F1A\u62A5\u9519<code>RuntimeError: cannot schedule new futures after shutdown</code></td></tr></tbody></table><p>Future\u5B9E\u4F8B\u65B9\u6CD5</p><table><thead><tr><th>\u65B9\u6CD5</th><th>\u8BF4\u660E</th></tr></thead><tbody><tr><td>done()</td><td>\u5982\u679C\u8C03\u7528\u6210\u529F\u6267\u884C\u6216\u53D6\u6D88\u6210\u529F\uFF0C\u90A3\u4E48\u8FD4\u56DETrue\uFF0C\u5426\u5219\u8FD4\u56DEFalse</td></tr><tr><td>cancelled()</td><td>\u5982\u679C\u590D\u7528\u88AB\u6210\u529F\u7684\u53D6\u6D88\uFF0C\u90A3\u4E48\u8FD4\u56DETrue</td></tr><tr><td>running()</td><td>\u5982\u679C\u6B63\u5728\u8FD0\u884C\u4E14\u4E0D\u80FD\u88AB\u53D6\u6D88\uFF0C\u90A3\u4E48\u8FD4\u56DETrue</td></tr><tr><td>cancel()</td><td>\u5C1D\u8BD5\u53D6\u6D88\u8C03\u7528\uFF0C\u5982\u679C\u5DF2\u7ECF\u6267\u884C\u4E14\u4E0D\u80FD\u53D6\u6D88\u8FD4\u56DEFalse\uFF0C\u5426\u5219\u8FD4\u56DETrue</td></tr><tr><td>result(timeout=None)</td><td>\u53D6\u8FD4\u56DE\u7684\u7ED3\u679C\uFF0Ctimeout\u4E3ANone,\u4E00\u76F4\u7B49\u5F85\u8FD4\u56DE\uFF0C\u8D85\u65F6\u629B\u51FAconcurrent.futures.TimeoutError\u5F02\u5E38</td></tr><tr><td>exception(timeout=None)</td><td>\u53D6\u8FD4\u56DE\u7684\u5F02\u5E38\uFF0Ctimeout\u4E3ANone,\u4E00\u76F4\u7B49\u5F85\u8FD4\u56DE,\u8D85\u65F6\u629B\u51FAconcurrent.futures.TimeoutError\u5F02\u5E38</td></tr></tbody></table><p>\u7EBF\u7A0B\u6C60\u7B80\u5355\u6F14\u793A</p><div class="language-python ext-py"><pre class="language-python"><code><span class="token comment">#!/usr/bin/env python</span>
<span class="token comment"># -*-coding:utf-8-*-</span>

<span class="token keyword">import</span> time
<span class="token keyword">import</span> logging
<span class="token keyword">from</span> concurrent<span class="token punctuation">.</span>futures <span class="token keyword">import</span> ThreadPoolExecutor

<span class="token comment"># \u521D\u59CB\u5316\u65E5\u5FD7</span>
FORMAT <span class="token operator">=</span> <span class="token string">&#39;%(asctime)-15s\\t [%(threadName)s, %(thread)d] %(message)s&#39;</span>
logging<span class="token punctuation">.</span>basicConfig<span class="token punctuation">(</span><span class="token builtin">format</span><span class="token operator">=</span>FORMAT<span class="token punctuation">)</span>


<span class="token keyword">def</span> <span class="token function">add</span><span class="token punctuation">(</span>x<span class="token punctuation">:</span> <span class="token builtin">int</span><span class="token punctuation">,</span> y<span class="token punctuation">:</span> <span class="token builtin">int</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    logging<span class="token punctuation">.</span>warning<span class="token punctuation">(</span><span class="token string">&quot;Function add run&quot;</span><span class="token punctuation">)</span>

    time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>  <span class="token comment"># \u6A21\u62DF\u51FD\u6570\u9F9F\u901F\u8FD0\u884C</span>
    <span class="token keyword">if</span> x <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">:</span>  <span class="token comment"># \u6A21\u62DF\u610F\u5916\u62A5\u9519</span>
        <span class="token keyword">raise</span> Exception<span class="token punctuation">(</span><span class="token string">&quot;Error: Parameter x in add function is not allowed to be 2&quot;</span><span class="token punctuation">)</span>

    ret <span class="token operator">=</span> x <span class="token operator">+</span> y  <span class="token comment"># \u6B63\u786E\u8BA1\u7B97\u7ED3\u679C</span>

    logging<span class="token punctuation">.</span>warning<span class="token punctuation">(</span><span class="token string">&quot;Function add finished&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> ret


<span class="token keyword">with</span> ThreadPoolExecutor<span class="token punctuation">(</span>max_workers<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">,</span> thread_name_prefix<span class="token operator">=</span><span class="token string">&quot;Thread-Add&quot;</span><span class="token punctuation">)</span> <span class="token keyword">as</span> executor<span class="token punctuation">:</span>
    <span class="token comment"># \u63D0\u4EA4\u591A\u4E2A\u4EFB\u52A1,\u5E76\u5C06\u4EFB\u52A1\u6536\u96C6\u8D77\u6765</span>
    <span class="token comment"># \u5F53\u4EFB\u52A1\u6570 &gt; \u5DE5\u4F5C\u7EBF\u7A0B\u65F6\uFF0C\u8FD8\u53EF\u4EE5\u7EE7\u7EED\u63D0\u4EA4\u4EFB\u52A1\uFF0Csubmit\u51FD\u6570\u5E76\u4E0D\u4F1A\u963B\u585E\uFF0C\u800C\u662F\u4F1A\u5C06\u4EFB\u52A1\u653E\u5230\u961F\u5217\u4E2D</span>
    <span class="token comment"># \u67E5\u770B\u6E90\u7801\u53D1\u73B0\u4F7F\u7528\u7684\u662Fqueue.SimpleQueue()\uFF0C\u7B80\u5355\u961F\u5217\uFF0C\u5148\u8FDB\u5148\u51FA\uFF0C\u961F\u5217\u5927\u5C0F\u6CA1\u6709\u9650\u5236</span>
    tasks <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        future <span class="token operator">=</span> executor<span class="token punctuation">.</span>submit<span class="token punctuation">(</span>add<span class="token punctuation">,</span> i<span class="token punctuation">,</span> i<span class="token punctuation">)</span>
        tasks<span class="token punctuation">.</span>append<span class="token punctuation">(</span>future<span class="token punctuation">)</span>
    <span class="token comment"># logging.warning(&quot;\u5168\u90E8\u4EFB\u52A1\u5DF2\u63D0\u4EA4&quot;)</span>

    <span class="token comment"># \u83B7\u53D6\u6BCF\u4E2A\u4EFB\u52A1\u6267\u884C\u7ED3\u679C\uFF0C\u5E76\u5C06\u7ED3\u679C\u6536\u96C6\u8D77\u6765</span>
    results <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> j <span class="token keyword">in</span> tasks<span class="token punctuation">:</span>
        <span class="token keyword">if</span> j<span class="token punctuation">.</span>exception<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">is</span> <span class="token boolean">None</span><span class="token punctuation">:</span>  <span class="token comment"># \u7EBF\u7A0B\u672A\u5D29\u6E83(\u62A5\u9519)</span>
            results<span class="token punctuation">.</span>append<span class="token punctuation">(</span>j<span class="token punctuation">.</span>result<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            results<span class="token punctuation">.</span>append<span class="token punctuation">(</span>j<span class="token punctuation">.</span>exception<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># \u7EBF\u7A0B\u5D29\u6E83\u4FE1\u606F</span>

    <span class="token comment"># \u4F9D\u6B21\u8F93\u51FA\u6BCF\u4E2A\u4EFB\u52A1\u7684\u7ED3\u679C</span>
    <span class="token keyword">for</span> result <span class="token keyword">in</span> results<span class="token punctuation">:</span>
        logging<span class="token punctuation">.</span>warning<span class="token punctuation">(</span><span class="token string">&quot;add result: {}&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="-3" tabindex="-1"><a class="header-anchor" href="#-3" aria-hidden="true">#</a></h2><h2 id="\u4E94\u3001\u534F\u7A0B" tabindex="-1"><a class="header-anchor" href="#\u4E94\u3001\u534F\u7A0B" aria-hidden="true">#</a> \u4E94\u3001\u534F\u7A0B</h2><h3 id="\u540C\u6B65\u548C\u5F02\u6B65" tabindex="-1"><a class="header-anchor" href="#\u540C\u6B65\u548C\u5F02\u6B65" aria-hidden="true">#</a> \u540C\u6B65\u548C\u5F02\u6B65</h3><p>\u5BF9\u4E8E\u4E00\u4E2A\u51FD\u6570\u6765\u8BF4\uFF0C\u540C\u6B65\u6307\u7684\u662F\u51FD\u6570\u8FD4\u56DE\u503C\u5C31\u662F\u6211\u4EEC\u60F3\u8981\u7684\u6700\u7EC8\u7ED3\u679C\uFF0C\u5F02\u6B65\u5219\u6307\u4E0D\u4F1A\u76F4\u63A5\u62FF\u5230\u6700\u7EC8\u7ED3\u679C\u3002</p><p>\u90A3\u4E48\u5F02\u6B65\u51FD\u6570\u5982\u4F55\u62FF\u5230\u6700\u7EC8\u7ED3\u679C\uFF0C\u53EF\u4EE5\u6709\u5982\u4E0B\u51E0\u79CD\u65B9\u6CD5</p><ul><li>\u7ED9\u5F02\u6B65\u51FD\u6570\u4F20\u5165\u4E00\u4E2A\u56DE\u8C03\u51FD\u6570\uFF0C\u5728\u56DE\u8C03\u51FD\u6570\u4E2D\u6211\u4EEC\u53EF\u4EE5\u62FF\u5230\u6700\u7EC8\u7ED3\u679C</li><li>\u5F02\u6B65\u51FD\u6570\u8FD4\u56DE\u7ED9\u6211\u4EEC\u4E00\u4E2A\u4E2D\u95F4\u7ED3\u679C\uFF0C\u6BD4\u5982\u8BF4\u662F\u4E00\u4E2A\u5BF9\u8C61\uFF0C\u901A\u8FC7\u5BF9\u8C61\u7684xx\u65B9\u6CD5\u53EF\u4EE5\u62FF\u5230\u7ED3\u679C</li></ul><p><span style="color:red;font-weight:bold;">\u603B\u7ED3\uFF1A\u540C\u6B65/\u5F02\u6B65\u5C31\u770B\u662F\u5426\u80FD\u76F4\u63A5\u62FF\u5230\u6700\u7EC8\u7ED3\u679C\uFF0C\u9700\u8981\u6CE8\u610F\u7684\u662F\u4E0E\u4EE3\u7801\u8FD0\u884C\u65F6\u957F\u662F\u6CA1\u6709\u4EFB\u4F55\u5173\u7CFB\u7684</span></p><br><h3 id="\u963B\u585E\u548C\u975E\u963B\u585E" tabindex="-1"><a class="header-anchor" href="#\u963B\u585E\u548C\u975E\u963B\u585E" aria-hidden="true">#</a> \u963B\u585E\u548C\u975E\u963B\u585E</h3><p>\u963B\u585E\u548C\u975E\u963B\u585E\u76F4\u63A5\u8BB2\u5E76\u4E0D\u5BB9\u6613\u8BB2\u6E05\u695A\uFF0C\u6240\u4EE5\u8FD9\u91CC\u7ED3\u5408\u961F\u5217\u505A\u4E00\u4E0B\u8BF4\u660E</p><p>\u963B\u585E\u961F\u5217</p><ul><li>\u5165\u961F\u963B\u585E\uFF1A\u5F53\u961F\u5217\u6EE1\u4E86\u4E4B\u540E\u518D\u5165\u961F\uFF0C\u5219\u4F1A\u8FDB\u884C\u963B\u585E\uFF0C\u76F4\u5230\u6EE1\u8DB3\u4EE5\u4E0B\u60C5\u51B5\uFF1A <ul><li>\u82E5\u8BBE\u7F6E\u4E86\u8D85\u65F6\u65F6\u95F4\uFF0C\u5165\u961F\u8D85\u65F6\uFF0C\u963B\u585E\u7ED3\u675F</li><li>\u5F53\u5176\u4ED6\u7EBF\u7A0B\u6D88\u8D39\u961F\u5217\u6570\u636E\u540E\u5BFC\u81F4\u961F\u5217\u4E0D\u6EE1\uFF0C\u672C\u7EBF\u7A0B\u5165\u961F\u6210\u529F\uFF0C\u963B\u585E\u7ED3\u675F</li></ul></li><li>\u51FA\u961F\u963B\u585E\uFF1A\u5F53\u961F\u5217\u4E3A\u7A7A\u65F6\u518D\u51FA\u961F\uFF0C\u5219\u4F1A\u8FDB\u884C\u963B\u585E\uFF0C\u76F4\u5230\u6EE1\u8DB3\u4EE5\u4E0B\u60C5\u51B5\uFF1A <ul><li>\u82E5\u8BBE\u7F6E\u4E86\u8D85\u65F6\u65F6\u95F4\uFF0C\u51FA\u961F\u8D85\u65F6\uFF0C\u963B\u585E\u7ED3\u675F</li><li>\u5F53\u5176\u4ED6\u7EBF\u7A0B\u5165\u961F\u6570\u636E\u540E\uFF0C\u672C\u7EBF\u7A0B\u51FA\u961F\u6210\u529F\uFF0C\u963B\u585E\u7ED3\u675F</li></ul></li></ul><p>\u975E\u963B\u585E\u961F\u5217</p><ul><li>\u5165\u961F\u4E0D\u4F1A\u963B\u585E\uFF0C\u5982\u4F55\u4FDD\u8BC1\u4E0D\u4F1A\u963B\u585E\uFF1A <ul><li>\u4E0D\u8003\u8651\u5185\u5B58\u9650\u5236\u7684\u8BDD\uFF0C\u6700\u7B80\u5355\u7684\u65B9\u6CD5\u5C31\u662F\u4E0D\u8BBE\u7F6E\u961F\u5217\u5927\u5C0F\uFF0C\u4E00\u76F4\u53EF\u4EE5\u653E\u5165\u6570\u636E</li><li>\u5982\u679C\u8003\u8651\u5185\u5B58\u9650\u5236\u7684\u8BDD\uFF0C\u53EF\u4EE5\u4F7F\u7528\u53CC\u7AEF\u961F\u5217\uFF0C\u5F53\u961F\u5217\u6EE1\u4E86\u4E4B\u540E\u518D\u653E\u5165\u6570\u636E\u4F1A\u5148\u628A\u6700\u5F00\u59CB\u7684\u6570\u636E\u5220\u6389\uFF0C\u7136\u540E\u5C31\u80FD\u6B63\u5E38\u653E\u5165</li></ul></li><li>\u51FA\u961F\u4E0D\u4F1A\u963B\u585E\uFF0C\u5982\u4F55\u4FDD\u8BC1\u4E0D\u4F1A\u963B\u585E\uFF1A <ul><li>\u5F53\u961F\u5217\u4E3A\u7A7A\u65F6\u8FD4\u56DE<code>None</code>\u6216\u8005\u62A5\u9519\u5373\u53EF</li></ul></li></ul><p>\u963B\u585E\u961F\u5217-\u5165\u961F\u963B\u585E\u6F14\u793A</p><details class="custom-container details"><summary>\u70B9\u51FB\u67E5\u770B\u5B8C\u6574\u4EE3\u7801</summary><div class="language-python ext-py"><pre class="language-python"><code><span class="token comment">#!/usr/bin/env python</span>
<span class="token comment"># -*-coding:utf-8-*-</span>

<span class="token triple-quoted-string string">&#39;&#39;&#39;\u963B\u585E\u961F\u5217-\u5165\u961F\u963B\u585E\u6F14\u793A&#39;&#39;&#39;</span>

<span class="token keyword">import</span> logging
<span class="token keyword">import</span> random
<span class="token keyword">import</span> time
<span class="token keyword">from</span> queue <span class="token keyword">import</span> Queue
<span class="token keyword">from</span> threading <span class="token keyword">import</span> Thread

<span class="token comment"># \u521D\u59CB\u5316\u65E5\u5FD7</span>
FORMAT <span class="token operator">=</span> <span class="token string">&#39;%(asctime)-15s\\t [%(threadName)s, %(thread)d] %(message)s&#39;</span>
logging<span class="token punctuation">.</span>basicConfig<span class="token punctuation">(</span><span class="token builtin">format</span><span class="token operator">=</span>FORMAT<span class="token punctuation">)</span>

<span class="token comment"># \u521D\u59CB\u5316\u961F\u5217\uFF0C\u961F\u5217\u5927\u5C0F\u4E3A3</span>
q <span class="token operator">=</span> Queue<span class="token punctuation">(</span>maxsize<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">)</span>


<span class="token comment"># \u751F\u4EA7\u8005</span>
<span class="token keyword">def</span> <span class="token function">producer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">&#39;&#39;&#39;\u5165\u961F\u963B\u585E\uFF1A\u5411\u961F\u5217\u4E2D\u653E\u51653\u4E2A\u6570\u636E\u65F6\uFF0C\u961F\u5217\u5C31\u5DF2\u7ECF\u6EE1\u4E86\uFF0C\u6B64\u65F6\u518D\u8FDB\u884Cput\u5C31\u4F1A\u8FDB\u884C\u963B\u585E
    &#39;&#39;&#39;</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        item <span class="token operator">=</span> random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">99</span><span class="token punctuation">)</span>
        q<span class="token punctuation">.</span>put<span class="token punctuation">(</span>item<span class="token punctuation">)</span>
        logging<span class="token punctuation">.</span>warning<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;\u961F\u5217\u653E\u5165\u6570\u636E: </span><span class="token interpolation"><span class="token punctuation">{</span>item<span class="token punctuation">}</span></span><span class="token string"> | \u5F53\u524D\u961F\u5217\u5927\u5C0F: </span><span class="token interpolation"><span class="token punctuation">{</span>q<span class="token punctuation">.</span>qsize<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string"> | \u961F\u5217\u662F\u5426\u5DF2\u6EE1: </span><span class="token interpolation"><span class="token punctuation">{</span>q<span class="token punctuation">.</span>full<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>

<span class="token comment"># \u6D88\u8D39\u8005</span>
<span class="token keyword">def</span> <span class="token function">consumer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">&#39;&#39;&#39;\u6D88\u8D39\u961F\u5217\u4E2D\u7684\u4E00\u4E2A\u6570\u636E&#39;&#39;&#39;</span>
    time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>  <span class="token comment"># \u4E3A\u4E86\u66F4\u597D\u7684\u663E\u793A\u961F\u5217\u963B\u585E\uFF0C\u6240\u4EE5\u8BA9\u6D88\u8D39\u8005\u5148\u6682\u505C3\u79D2\u949F\u518D\u6D88\u8D39</span>
    item <span class="token operator">=</span> q<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token punctuation">)</span>
    logging<span class="token punctuation">.</span>warning<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;\u961F\u5217\u6D88\u8D39\u6570\u636E: </span><span class="token interpolation"><span class="token punctuation">{</span>item<span class="token punctuation">}</span></span><span class="token string"> | \u5F53\u524D\u961F\u5217\u5927\u5C0F: </span><span class="token interpolation"><span class="token punctuation">{</span>q<span class="token punctuation">.</span>qsize<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string"> | \u961F\u5217\u662F\u5426\u5DF2\u6EE1: </span><span class="token interpolation"><span class="token punctuation">{</span>q<span class="token punctuation">.</span>full<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>


Thread<span class="token punctuation">(</span>target<span class="token operator">=</span>producer<span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">&quot;Producer&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span>
Thread<span class="token punctuation">(</span>target<span class="token operator">=</span>consumer<span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">&quot;Consumer&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div></details><p>\u975E\u963B\u585E\u961F\u5217-\u5165\u961F\u975E\u963B\u585E\u6F14\u793A</p><details class="custom-container details"><summary>\u70B9\u51FB\u67E5\u770B\u5B8C\u6574\u4EE3\u7801</summary><div class="language-python ext-py"><pre class="language-python"><code><span class="token comment">#!/usr/bin/env python</span>
<span class="token comment"># -*-coding:utf-8-*-</span>

<span class="token triple-quoted-string string">&#39;&#39;&#39;\u975E\u963B\u585E\u961F\u5217-\u5165\u961F\u975E\u963B\u585E\u6F14\u793A&#39;&#39;&#39;</span>

<span class="token keyword">import</span> logging
<span class="token keyword">import</span> random
<span class="token keyword">import</span> time
<span class="token keyword">from</span> collections <span class="token keyword">import</span> deque
<span class="token keyword">from</span> threading <span class="token keyword">import</span> Thread

<span class="token comment"># \u521D\u59CB\u5316\u65E5\u5FD7</span>
FORMAT <span class="token operator">=</span> <span class="token string">&#39;%(asctime)-15s\\t [%(threadName)s, %(thread)d] %(message)s&#39;</span>
logging<span class="token punctuation">.</span>basicConfig<span class="token punctuation">(</span><span class="token builtin">format</span><span class="token operator">=</span>FORMAT<span class="token punctuation">)</span>

<span class="token comment"># \u521D\u59CB\u5316\u53CC\u7AEF\u961F\u5217\uFF0C\u961F\u5217\u5927\u5C0F\u4E3A3</span>
q <span class="token operator">=</span> deque<span class="token punctuation">(</span>maxlen<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">)</span>


<span class="token comment"># \u751F\u4EA7\u8005</span>
<span class="token keyword">def</span> <span class="token function">producer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">&#39;&#39;&#39;\u5165\u961F\u975E\u963B\u585E\uFF1A\u5411\u961F\u5217\u4E2D\u653E\u51653\u4E2A\u6570\u636E\u65F6\uFF0C\u961F\u5217\u5C31\u5DF2\u7ECF\u6EE1\u4E86\uFF0C\u6B64\u65F6\u518D\u8FDB\u884Cput\u5C31\u4F1A\u5220\u9664\u4E4B\u524D\u653E\u7684\u6570\u636E\uFF0C\u7ED9\u65B0\u6570\u636E\u817E\u4F4D\u7F6E
    &#39;&#39;&#39;</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        item <span class="token operator">=</span> random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">99</span><span class="token punctuation">)</span>
        q<span class="token punctuation">.</span>append<span class="token punctuation">(</span>item<span class="token punctuation">)</span>

        msg <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f&quot;\u961F\u5217\u653E\u5165\u6570\u636E: </span><span class="token interpolation"><span class="token punctuation">{</span>item<span class="token punctuation">}</span></span><span class="token string"> | \u5F53\u524D\u961F\u5217\u5927\u5C0F: </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token builtin">len</span><span class="token punctuation">(</span>q<span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string"> | \u961F\u5217\u662F\u5426\u5DF2\u6EE1: </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token builtin">str</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>q<span class="token punctuation">)</span> <span class="token operator">==</span> q<span class="token punctuation">.</span>maxlen<span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token format-spec">&lt;5</span><span class="token punctuation">}</span></span><span class="token string"> | \u961F\u5217\u6570\u636E: </span><span class="token interpolation"><span class="token punctuation">{</span>q<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span>
        logging<span class="token punctuation">.</span>warning<span class="token punctuation">(</span>msg<span class="token punctuation">)</span>


<span class="token comment"># \u6D88\u8D39\u8005</span>
<span class="token keyword">def</span> <span class="token function">consumer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">&#39;&#39;&#39;\u6D88\u8D39\u961F\u5217\u4E2D\u7684\u4E00\u4E2A\u6570\u636E&#39;&#39;&#39;</span>
    time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>  <span class="token comment"># \u4E3A\u4E86\u66F4\u597D\u7684\u663E\u793A\u961F\u5217\u975E\u963B\u585E\uFF0C\u6240\u4EE5\u8BA9\u6D88\u8D39\u8005\u5148\u6682\u505C3\u79D2\u949F\u518D\u6D88\u8D39</span>
    item <span class="token operator">=</span> q<span class="token punctuation">.</span>pop<span class="token punctuation">(</span><span class="token punctuation">)</span>

    msg <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f&quot;\u961F\u5217\u6D88\u8D39\u6570\u636E: </span><span class="token interpolation"><span class="token punctuation">{</span>item<span class="token punctuation">}</span></span><span class="token string"> | \u5F53\u524D\u961F\u5217\u5927\u5C0F: </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token builtin">len</span><span class="token punctuation">(</span>q<span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string"> | \u961F\u5217\u662F\u5426\u5DF2\u6EE1: </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token builtin">str</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>q<span class="token punctuation">)</span> <span class="token operator">==</span> q<span class="token punctuation">.</span>maxlen<span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token format-spec">&lt;5</span><span class="token punctuation">}</span></span><span class="token string"> | \u961F\u5217\u6570\u636E: </span><span class="token interpolation"><span class="token punctuation">{</span>q<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span>
    logging<span class="token punctuation">.</span>warning<span class="token punctuation">(</span>msg<span class="token punctuation">)</span>


Thread<span class="token punctuation">(</span>target<span class="token operator">=</span>producer<span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">&quot;Producer&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span>
Thread<span class="token punctuation">(</span>target<span class="token operator">=</span>consumer<span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">&quot;Consumer&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div></details><p><span style="color:red;font-weight:bold;">\u603B\u7ED3\uFF1A\u963B\u585E\u548C\u975E\u963B\u585E\u662F\u6307\u662F\u5426\u80FD\u76F4\u63A5\u80FD\u7ACB\u5373\u8FD4\u56DE\uFF0C\u9700\u8981\u6CE8\u610F\u7684\u662F\u4E0E\u662F\u5426\u80FD\u76F4\u63A5\u62FF\u5230\u6700\u7EC8\u7ED3\u679C\u65E0\u5173</span></p><br><h3 id="io" tabindex="-1"><a class="header-anchor" href="#io" aria-hidden="true">#</a> IO</h3><p>\u4E0A\u9762\u6240\u8BF4\u7684\u540C\u6B65/\u5F02\u6B65/\u963B\u585E/\u975E\u963B\u585E\u90FD\u662F\u6982\u5FF5\u6027\u7684\uFF0C\u9700\u8981\u4E0E\u5177\u4F53\u7684\u67D0\u4E2A\u4E1C\u897F\u7ED3\u5408\u8D77\u6765\u624D\u7B26\u5408\u6211\u4EEC\u7684\u5B9E\u9645\u60C5\u51B5\uFF0C\u6BD4\u5982\u963B\u585E\u961F\u5217\uFF0C\u800C\u4E0E\u8FD9\u4E9B\u6982\u5FF5\u5173\u7CFB\u6700\u5BC6\u5207\u7684\u5F53\u5C5E<code>IO</code>\u64CD\u4F5C\u3002</p><p>IO\u8BF4\u7B80\u5355\u70B9\u5C31\u662F\u8F93\u5165\u548C\u8F93\u51FA(Input/Output)\uFF0C\u5F80\u6DF1\u5165\u8BF4\u5C31\u592A\u592A\u592A\u590D\u6742\u4E86\uFF0C\u53EF\u4EE5\u53C2\u8003\u4E00\u4E0B\u7ECF\u5178\u7684\u4E09\u79CDIO\u6A21\u578B\uFF1A<code>select</code>\u3001<code>poll</code>\u3001<code>epoll</code></p><p>\u6211\u4EEC\u6765\u5217\u4E3E\u5E38\u89C1\u7684\u4E00\u4E9BIO\u64CD\u4F5C</p><ul><li>\u78C1\u76D8IO\uFF1A\u8BFB\u5199\u6587\u4EF6</li><li>\u7F51\u7EDCIO\uFF1A\u53D1\u9001/\u63A5\u6536\u7F51\u7EDC\u8BF7\u6C42</li><li>\u4E0EUSB\u8BBE\u5907\u3001\u663E\u793A\u5668\u3001\u952E\u76D8\u3001\u9F20\u6807\u7B49\u4EA4\u4E92\u4EA7\u751F\u7684IO\uFF0C\u6BD4\u5982<code>print(&quot;hello&quot;)</code>\u5C31\u4F1A\u6D89\u53CA\u5230IO\u64CD\u4F5C</li></ul><p>IO\u64CD\u4F5C\u7C7B\u578B</p><table><thead><tr><th>\u7C7B\u578B</th><th>\u8BF4\u660E</th></tr></thead><tbody><tr><td>\u540C\u6B65\u963B\u585EIO</td><td>\u8FD9\u662F\u6211\u4EEC\u5199\u4EE3\u7801\u6700\u5E38\u7528\u7684\u65B9\u5F0F\uFF0C\u8FD9\u79CD\u65B9\u5F0F\u6700\u7B26\u5408\u5F00\u53D1\u8005\u7684\u601D\u8003\u903B\u8F91\uFF0C\u4F46\u662F\u6548\u7387\u4E0D\u9AD8<br>\u6BD4\u5982\u4F7F\u7528<code>open</code>\u51FD\u6570\u8BFB\u5199\u6587\u4EF6\uFF0C\u4F7F\u7528\u7B2C\u4E09\u65B9\u5E93<code>requests</code>\u53D1\u9001\u7F51\u7EDC\u8BF7\u6C42\u7B49</td></tr><tr><td>\u540C\u6B65\u975E\u963B\u585EIO</td><td>\u4E00\u822C\u4E0D\u7528\uFF0C\u4E0D\u5728\u8BA8\u8BBA\u8303\u56F4\u5185</td></tr><tr><td>\u5F02\u6B65\u963B\u585EIO</td><td>\u4E00\u822C\u4E0D\u7528\uFF0C\u4E0D\u5728\u8BA8\u8BBA\u8303\u56F4\u5185</td></tr><tr><td>\u5F02\u6B65\u975E\u963B\u585EIO</td><td>\u6211\u4EEC\u5C06\u8981\u5B66\u4E60\u7684\u534F\u7A0B\uFF0C\u5C31\u662F\u7528\u6765\u5B9E\u73B0\u5F02\u6B65\u975E\u963B\u585EIO\uFF0C\u76F8\u6BD4\u540C\u6B65\u963B\u585EIO\uFF0C\u4EE3\u7801\u4F1A\u96BE\u5199\u4E00\u4E9B\uFF0C\u4F46\u662F\u6548\u7387\u66F4\u9AD8</td></tr></tbody></table><h3 id="\u534F\u7A0B\u6982\u5FF5" tabindex="-1"><a class="header-anchor" href="#\u534F\u7A0B\u6982\u5FF5" aria-hidden="true">#</a> \u534F\u7A0B\u6982\u5FF5</h3><h3 id="\u534F\u7A0B\u57FA\u672C\u4F7F\u7528" tabindex="-1"><a class="header-anchor" href="#\u534F\u7A0B\u57FA\u672C\u4F7F\u7528" aria-hidden="true">#</a> \u534F\u7A0B\u57FA\u672C\u4F7F\u7528</h3>`,204),hs=s("\u5B98\u65B9\u6587\u6863\uFF1A"),ys={href:"https://docs.python.org/zh-cn/3.9/library/asyncio.html",target:"_blank",rel:"noopener noreferrer"},_s=s("https://docs.python.org/zh-cn/3.9/library/asyncio.html"),bs=p(`<h4 id="\u5B9A\u4E49\u534F\u7A0B\u51FD\u6570" tabindex="-1"><a class="header-anchor" href="#\u5B9A\u4E49\u534F\u7A0B\u51FD\u6570" aria-hidden="true">#</a> \u5B9A\u4E49\u534F\u7A0B\u51FD\u6570</h4><p>\u4F7F\u7528<code>async</code>\u5173\u952E\u5B57\u5B9A\u4E49\u7684\u51FD\u6570\u4FBF\u662F\u4E00\u4E2A\u534F\u7A0B\u51FD\u6570</p><h4 id="\u8FD0\u884C\u534F\u7A0B\u51FD\u6570" tabindex="-1"><a class="header-anchor" href="#\u8FD0\u884C\u534F\u7A0B\u51FD\u6570" aria-hidden="true">#</a> \u8FD0\u884C\u534F\u7A0B\u51FD\u6570</h4><p>\u76F4\u63A5\u8C03\u7528\u534F\u7A0B\u51FD\u6570\uFF0C\u8FD4\u56DE\u7684\u53EB\u505A\u534F\u7A0B\u5BF9\u8C61</p><p>\u534F\u7A0B\u5BF9\u8C61\u9700\u8981\u501F\u52A9\u5916\u529B\u542F\u52A8\uFF0C\u624D\u80FD\u771F\u6B63\u6267\u884C\u51FD\u6570\u4EE3\u7801\uFF0C\u6B64\u65F6\u6709\u5982\u4E0B\u51E0\u79CD\u65B9\u6CD5</p><ul><li>\u5728\u534F\u7A0B\u51FD\u6570\u5916\u90E8\uFF0C\u4F7F\u7528<code>asyncio.run(\u534F\u7A0B\u5BF9\u8C61)</code>\uFF0C\u8FD9\u4E2A\u662F\u534F\u7A0B\u6267\u884C\u6700\u9AD8\u5165\u53E3\u70B9</li><li>\u5728\u534F\u7A0B\u51FD\u6570\u5185\u90E8\uFF0C\u53EF\u4EE5\u4F7F\u7528\u51E0\u4E0B\u51E0\u79CD\u65B9\u6CD5\u8FD0\u884C\u65B0\u7684\u534F\u7A0B\uFF1A <ul><li>\u4F7F\u7528<code>await \u534F\u7A0B\u5BF9\u8C61</code></li><li>\u4F7F\u7528<code>await asyncio.create_task(\u534F\u7A0B\u5BF9\u8C61)</code>\u5E76\u53D1\u8FD0\u884C\u4E00\u4E2A\u6216\u591A\u4E2A\u534F\u7A0B</li></ul></li></ul><blockquote><p>await\u662F\u4E00\u4E2A\u5173\u952E\u5B57\uFF0C\u8BE6\u7EC6\u5185\u5BB9\u53C2\u8003\uFF1A\u53EF\u7B49\u5F85\u5BF9\u8C61</p></blockquote><p>\u534F\u7A0B\u51FD\u6570\u4E3E\u4F8B</p><div class="language-python ext-py"><pre class="language-python"><code><span class="token comment">#!/usr/bin/env python</span>
<span class="token comment"># -*-coding:utf-8-*-</span>

<span class="token keyword">import</span> logging
<span class="token keyword">import</span> asyncio
<span class="token keyword">import</span> time

<span class="token comment"># \u521D\u59CB\u5316\u65E5\u5FD7</span>
FORMAT <span class="token operator">=</span> <span class="token string">&#39;%(asctime)-15s\\t [%(threadName)s, %(thread)d] %(message)s&#39;</span>
logging<span class="token punctuation">.</span>basicConfig<span class="token punctuation">(</span><span class="token builtin">format</span><span class="token operator">=</span>FORMAT<span class="token punctuation">)</span>

<span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># \u4F7F\u7528async\u5173\u952E\u5B57\u5B9A\u4E49\u534F\u7A0B\u51FD\u6570</span>
    logging<span class="token punctuation">.</span>warning<span class="token punctuation">(</span><span class="token string">&quot;hello&quot;</span><span class="token punctuation">)</span>

    <span class="token comment"># \u8FD0\u884C\u534F\u7A0B\u51FD\u6570-\u65B9\u5F0F2, \u4F7F\u7528await</span>
    <span class="token comment"># \u6302\u8D77\u5F53\u524D\u534F\u7A0B\uFF0C\u6267\u884Casyncio.sleep(3), \u5E76\u7B49\u5F85\u5B83\u6267\u884C\u5B8C\u6210, asyncio.sleep\u4E0E\u666E\u901A\u7684time.sleep\u4E0D\u4E00\u6837\uFF0C\u4ED6\u662F\u534F\u7A0B\u51FD\u6570</span>
    <span class="token comment"># \u8FD9\u91CC\u9700\u8981\u6267\u884C3\u79D2\u949F</span>
    <span class="token keyword">await</span> asyncio<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>

    <span class="token comment"># \u8FD0\u884C\u534F\u7A0B\u51FD\u6570-\u65B9\u5F0F3\uFF0C\u5E76\u53D1\u6267\u884C\u591A\u4E2A\u534F\u7A0B</span>
    <span class="token comment"># \u8FD9\u91CC\u603B\u5171\u9700\u8981\u6267\u884C5\u79D2\u949F\uFF0C\u6CE8\u610F\u5E76\u4E0D\u662F10\u79D2\u949F</span>
    task1 <span class="token operator">=</span> asyncio<span class="token punctuation">.</span>create_task<span class="token punctuation">(</span>asyncio<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    task2 <span class="token operator">=</span> asyncio<span class="token punctuation">.</span>create_task<span class="token punctuation">(</span>asyncio<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">await</span> task1
    <span class="token keyword">await</span> task2

    logging<span class="token punctuation">.</span>warning<span class="token punctuation">(</span><span class="token string">&quot;wrold&quot;</span><span class="token punctuation">)</span>  <span class="token comment"># \u7EE7\u7EED\u6267\u884C\u5F53\u524D\u534F\u7A0B</span>

    <span class="token comment"># main\u51FD\u6570\u603B\u5171\u9700\u8981\u6267\u884C3+5=8\u79D2\u949F</span>


<span class="token comment"># \u8FD0\u884C\u534F\u7A0B\u51FD\u6570-\u65B9\u5F0F1, \u8FD9\u91CC\u662F\u6700\u9AD8\u5165\u53E3\u70B9</span>
asyncio<span class="token punctuation">.</span>run<span class="token punctuation">(</span>main<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="\u5E76\u53D1\u8FD0\u884C\u534F\u7A0B\u51FD\u6570" tabindex="-1"><a class="header-anchor" href="#\u5E76\u53D1\u8FD0\u884C\u534F\u7A0B\u51FD\u6570" aria-hidden="true">#</a> \u5E76\u53D1\u8FD0\u884C\u534F\u7A0B\u51FD\u6570</h4><div class="language-python ext-py"><pre class="language-python"><code><span class="token comment">#!/usr/bin/env python</span>
<span class="token comment"># -*-coding:utf-8-*-</span>

<span class="token keyword">import</span> logging
<span class="token keyword">import</span> asyncio


<span class="token comment"># \u521D\u59CB\u5316\u65E5\u5FD7</span>
FORMAT <span class="token operator">=</span> <span class="token string">&#39;%(asctime)-15s\\t [%(threadName)s, %(thread)d] %(message)s&#39;</span>
logging<span class="token punctuation">.</span>basicConfig<span class="token punctuation">(</span><span class="token builtin">format</span><span class="token operator">=</span>FORMAT<span class="token punctuation">)</span>


<span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">show_message</span><span class="token punctuation">(</span>message<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">await</span> asyncio<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
    logging<span class="token punctuation">.</span>warning<span class="token punctuation">(</span>message<span class="token punctuation">)</span>


<span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">show_message2</span><span class="token punctuation">(</span>message<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">await</span> asyncio<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> message


<span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># \u5E76\u53D1\u8FD0\u884C\u591A\u4E2A\u534F\u7A0B1 - create_task - \u8F93\u51FA\u7ED3\u679C\u662F\u65E0\u5E8F\u7684</span>
    logging<span class="token punctuation">.</span>warning<span class="token punctuation">(</span><span class="token string">&quot;\u5E76\u53D1\u8FD0\u884C\u591A\u4E2A\u534F\u7A0B1 - create_task - \u8F93\u51FA\u7ED3\u679C\u662F\u65E0\u5E8F\u7684&quot;</span><span class="token punctuation">)</span>
    tasks <span class="token operator">=</span> <span class="token punctuation">[</span>asyncio<span class="token punctuation">.</span>create_task<span class="token punctuation">(</span>show_message<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;create_task_</span><span class="token interpolation"><span class="token punctuation">{</span>i<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> task <span class="token keyword">in</span> tasks<span class="token punctuation">:</span>
        <span class="token keyword">await</span> task
    logging<span class="token punctuation">.</span>warning<span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span>

    <span class="token comment"># \u5E76\u53D1\u8FD0\u884C\u591A\u4E2A\u534F\u7A0B1 - create_task - \u6539\u5199\u51FD\u6570\uFF0C\u4EC5\u8BA9\u8F93\u51FA\u7ED3\u679C\u6709\u5E8F</span>
    logging<span class="token punctuation">.</span>warning<span class="token punctuation">(</span><span class="token string">&quot;\u5E76\u53D1\u8FD0\u884C\u591A\u4E2A\u534F\u7A0B1 - create_task - \u6539\u5199\u51FD\u6570\uFF0C\u4EC5\u8BA9\u8F93\u51FA\u7ED3\u679C\u6709\u5E8F&quot;</span><span class="token punctuation">)</span>
    tasks <span class="token operator">=</span> <span class="token punctuation">[</span>asyncio<span class="token punctuation">.</span>create_task<span class="token punctuation">(</span>show_message2<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;create_task_</span><span class="token interpolation"><span class="token punctuation">{</span>i<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> task <span class="token keyword">in</span> tasks<span class="token punctuation">:</span>
        ret <span class="token operator">=</span> <span class="token keyword">await</span> task
        logging<span class="token punctuation">.</span>warning<span class="token punctuation">(</span>ret<span class="token punctuation">)</span>
    logging<span class="token punctuation">.</span>warning<span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span>

    <span class="token comment"># \u5E76\u53D1\u8FD0\u884C\u591A\u4E2A\u534F\u7A0B2 - gather - \u8F93\u51FA\u7ED3\u679C\u662F\u6709\u987A\u5E8F\u7684</span>
    logging<span class="token punctuation">.</span>warning<span class="token punctuation">(</span><span class="token string">&quot;\u5E76\u53D1\u8FD0\u884C\u591A\u4E2A\u534F\u7A0B2 - gather - \u8F93\u51FA\u7ED3\u679C\u662F\u6709\u987A\u5E8F\u7684&quot;</span><span class="token punctuation">)</span>
    tasks <span class="token operator">=</span> <span class="token punctuation">[</span>show_message2<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;create_task_</span><span class="token interpolation"><span class="token punctuation">{</span>i<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
    rets <span class="token operator">=</span> <span class="token keyword">await</span> asyncio<span class="token punctuation">.</span>gather<span class="token punctuation">(</span><span class="token operator">*</span>tasks<span class="token punctuation">)</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> rets<span class="token punctuation">:</span>
        logging<span class="token punctuation">.</span>warning<span class="token punctuation">(</span>i<span class="token punctuation">)</span>
    logging<span class="token punctuation">.</span>warning<span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span>

    <span class="token comment"># \u5176\u4ED6\u5E76\u53D1\u8FD0\u884C\u591A\u4E2A\u534F\u7A0B\u65B9\u6CD5</span>
    <span class="token comment">#   * await asyncio.wait()</span>
    <span class="token comment">#   * asyncio.as_completed()</span>


<span class="token comment"># \u8FD0\u884C\u534F\u7A0B\u51FD\u6570-\u65B9\u5F0F1, \u8FD9\u91CC\u662F\u6700\u9AD8\u5165\u53E3\u70B9</span>
asyncio<span class="token punctuation">.</span>run<span class="token punctuation">(</span>main<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="\u534F\u7A0B\u51FD\u6570\u7684\u5A01\u529B-\u6D4B\u8BD5\u7F51\u7EDCio" tabindex="-1"><a class="header-anchor" href="#\u534F\u7A0B\u51FD\u6570\u7684\u5A01\u529B-\u6D4B\u8BD5\u7F51\u7EDCio" aria-hidden="true">#</a> \u534F\u7A0B\u51FD\u6570\u7684\u5A01\u529B - \u6D4B\u8BD5\u7F51\u7EDCIO</h4><p>\u534F\u7A0B\u5C5E\u4E8E\u5F02\u6B65\u4F46\u5176\u5185\u90E8\u7F16\u5199\u7684\u4EE3\u7801\u53EF\u80FD\u662F\u540C\u6B65\u963B\u585E\u7684\uFF0C\u4E0B\u9762\u4EE5<code>requests</code>\u548C<code>aiohttp</code>\u6765\u505A\u4E00\u4E2A\u6F14\u793A</p><p>\u5B89\u88C5\u7B2C\u4E09\u65B9\u5E93</p><div class="language-bash ext-sh"><pre class="language-bash"><code>pip <span class="token function">install</span> requests aiohttp
</code></pre></div><p>\u4EE3\u7801\u6F14\u793A</p><details class="custom-container details"><summary>\u70B9\u51FB\u67E5\u770B\u5B8C\u6574\u4EE3\u7801</summary><div class="language-python ext-py"><pre class="language-python"><code><span class="token comment">#!/usr/bin/env python</span>
<span class="token comment"># -*-coding:utf-8-*-</span>

<span class="token keyword">import</span> logging
<span class="token keyword">import</span> asyncio
<span class="token keyword">import</span> time
<span class="token keyword">import</span> aiohttp
<span class="token keyword">import</span> requests

<span class="token comment"># \u521D\u59CB\u5316\u65E5\u5FD7</span>
FORMAT <span class="token operator">=</span> <span class="token string">&#39;%(asctime)-15s\\t [%(threadName)s, %(thread)d] %(message)s&#39;</span>
logging<span class="token punctuation">.</span>basicConfig<span class="token punctuation">(</span><span class="token builtin">format</span><span class="token operator">=</span>FORMAT<span class="token punctuation">)</span>


<span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">request_sync</span><span class="token punctuation">(</span>url<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">,</span> number<span class="token punctuation">:</span> <span class="token builtin">int</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    start <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token comment"># \u7EDF\u8BA1HTTP\u8BF7\u6C42\u72B6\u6001\u7801\u7ED3\u679C</span>
    Counter <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token string">&quot;Success&quot;</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
        <span class="token string">&quot;Failed&quot;</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>

    <span class="token comment"># \u53D1\u9001\u7F51\u7EDC\u8BF7\u6C42</span>
    <span class="token keyword">with</span> requests<span class="token punctuation">.</span>session<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">as</span> session<span class="token punctuation">:</span>
        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>number<span class="token punctuation">)</span><span class="token punctuation">:</span>
            r <span class="token operator">=</span> session<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">)</span>
            <span class="token keyword">if</span> r<span class="token punctuation">.</span>status_code <span class="token operator">==</span> <span class="token number">200</span><span class="token punctuation">:</span>
                Counter<span class="token punctuation">[</span><span class="token string">&quot;Success&quot;</span><span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">1</span>
            <span class="token keyword">else</span><span class="token punctuation">:</span>
                Counter<span class="token punctuation">[</span><span class="token string">&quot;Failed&quot;</span><span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">1</span>

    logging<span class="token punctuation">.</span>warning<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;Function [ request_sync   ] running time: </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token builtin">int</span><span class="token punctuation">(</span>time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> start<span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string"> seconds | </span><span class="token interpolation"><span class="token punctuation">{</span>Counter<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>


<span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">request_async</span><span class="token punctuation">(</span>url<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">,</span> number<span class="token punctuation">:</span> <span class="token builtin">int</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    start <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token comment"># \u7EDF\u8BA1HTTP\u8BF7\u6C42\u72B6\u6001\u7801\u7ED3\u679C</span>
    Counter <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token string">&quot;Success&quot;</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
        <span class="token string">&quot;Failed&quot;</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">wrapper</span><span class="token punctuation">(</span>session<span class="token punctuation">:</span> aiohttp<span class="token punctuation">.</span>ClientSession<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">async</span> <span class="token keyword">with</span> session<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">)</span> <span class="token keyword">as</span> r<span class="token punctuation">:</span>
            <span class="token keyword">if</span> r<span class="token punctuation">.</span>status <span class="token operator">==</span> <span class="token number">200</span><span class="token punctuation">:</span>
                Counter<span class="token punctuation">[</span><span class="token string">&quot;Success&quot;</span><span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">1</span>
            <span class="token keyword">else</span><span class="token punctuation">:</span>
                Counter<span class="token punctuation">[</span><span class="token string">&quot;Failed&quot;</span><span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">1</span>

    <span class="token comment"># \u53D1\u9001\u7F51\u7EDC\u8BF7\u6C42</span>
    <span class="token keyword">async</span> <span class="token keyword">with</span> aiohttp<span class="token punctuation">.</span>ClientSession<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">as</span> session<span class="token punctuation">:</span>
        tasks <span class="token operator">=</span> <span class="token punctuation">[</span>wrapper<span class="token punctuation">(</span>session<span class="token punctuation">)</span> <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>number<span class="token punctuation">)</span><span class="token punctuation">]</span>
        <span class="token keyword">await</span> asyncio<span class="token punctuation">.</span>gather<span class="token punctuation">(</span><span class="token operator">*</span>tasks<span class="token punctuation">)</span>

    logging<span class="token punctuation">.</span>warning<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;Function [ request_async  ] running time: </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token builtin">int</span><span class="token punctuation">(</span>time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> start<span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string"> seconds | </span><span class="token interpolation"><span class="token punctuation">{</span>Counter<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>


asyncio<span class="token punctuation">.</span>run<span class="token punctuation">(</span>request_sync<span class="token punctuation">(</span><span class="token string">&quot;https://www.qq.com&quot;</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
asyncio<span class="token punctuation">.</span>run<span class="token punctuation">(</span>request_async<span class="token punctuation">(</span><span class="token string">&quot;https://www.qq.com&quot;</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div></details><p>\u8F93\u51FA\u7ED3\u679C</p><div class="language-bash ext-sh"><pre class="language-bash"><code><span class="token number">2022</span>-04-04 <span class="token number">11</span>:28:37,125	 <span class="token punctuation">[</span>MainThread, <span class="token number">247048</span><span class="token punctuation">]</span> Function <span class="token punctuation">[</span> request_sync   <span class="token punctuation">]</span> running time: <span class="token number">53</span> seconds <span class="token operator">|</span> <span class="token punctuation">{</span><span class="token string">&#39;Success&#39;</span><span class="token builtin class-name">:</span> <span class="token number">1000</span>, <span class="token string">&#39;Failed&#39;</span><span class="token builtin class-name">:</span> <span class="token number">0</span><span class="token punctuation">}</span>
<span class="token number">2022</span>-04-04 <span class="token number">11</span>:29:01,859	 <span class="token punctuation">[</span>MainThread, <span class="token number">247048</span><span class="token punctuation">]</span> Function <span class="token punctuation">[</span> request_async  <span class="token punctuation">]</span> running time: <span class="token number">24</span> seconds <span class="token operator">|</span> <span class="token punctuation">{</span><span class="token string">&#39;Success&#39;</span><span class="token builtin class-name">:</span> <span class="token number">1000</span>, <span class="token string">&#39;Failed&#39;</span><span class="token builtin class-name">:</span> <span class="token number">0</span><span class="token punctuation">}</span>
</code></pre></div><h4 id="\u534F\u7A0B\u51FD\u6570\u5E76\u4E0D\u662F\u4E07\u80FD\u7684-\u6D4B\u8BD5\u78C1\u76D8io" tabindex="-1"><a class="header-anchor" href="#\u534F\u7A0B\u51FD\u6570\u5E76\u4E0D\u662F\u4E07\u80FD\u7684-\u6D4B\u8BD5\u78C1\u76D8io" aria-hidden="true">#</a> \u534F\u7A0B\u51FD\u6570\u5E76\u4E0D\u662F\u4E07\u80FD\u7684 - \u6D4B\u8BD5\u78C1\u76D8IO</h4><p>\u8FD9\u6B21\u6211\u4EEC\u6765\u8BFB\u5199\u6587\u4EF6\u6D4B\u8BD5\uFF0C\u4F7F\u7528\u975E\u963B\u585E\u51FD\u6570<code>aiofiles</code>\u6765\u4EE3\u66FF<code>open</code></p><p>\u5B89\u88C5aiofiles</p><div class="language-bash ext-sh"><pre class="language-bash"><code>pip <span class="token function">install</span> aiofiles
</code></pre></div><p>\u4EE3\u7801\u6F14\u793A</p><details class="custom-container details"><summary>\u70B9\u51FB\u67E5\u770B\u5B8C\u6574\u4EE3\u7801</summary><div class="language-python ext-py"><pre class="language-python"><code><span class="token comment">#!/usr/bin/env python</span>
<span class="token comment"># -*-coding:utf-8-*-</span>

<span class="token keyword">import</span> logging
<span class="token keyword">import</span> random
<span class="token keyword">import</span> asyncio
<span class="token keyword">import</span> time
<span class="token keyword">import</span> aiofiles

<span class="token comment"># \u521D\u59CB\u5316\u65E5\u5FD7</span>
FORMAT <span class="token operator">=</span> <span class="token string">&#39;%(asctime)-15s\\t [%(threadName)s, %(thread)d] %(message)s&#39;</span>
logging<span class="token punctuation">.</span>basicConfig<span class="token punctuation">(</span><span class="token builtin">format</span><span class="token operator">=</span>FORMAT<span class="token punctuation">)</span>


<span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">write_sync</span><span class="token punctuation">(</span>file_prefix<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">,</span> number<span class="token punctuation">:</span> <span class="token builtin">int</span><span class="token punctuation">,</span> lines<span class="token punctuation">:</span> <span class="token builtin">int</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">&#39;&#39;&#39;
    :param file_prefix: \u6587\u4EF6\u540D\u524D\u7F00
    :param number: \u6587\u4EF6\u4E2A\u6570
    :param lines: \u6BCF\u4E2A\u6587\u4EF6\u884C\u6570
    :return: None
    &#39;&#39;&#39;</span>

    start <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token comment"># \u5B9A\u4E49\u6587\u4EF6\u5217\u8868</span>
    file_names <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string-interpolation"><span class="token string">f&quot;</span><span class="token interpolation"><span class="token punctuation">{</span>file_prefix<span class="token punctuation">}</span></span><span class="token string">-</span><span class="token interpolation"><span class="token punctuation">{</span>i<span class="token punctuation">}</span></span><span class="token string">.txt&quot;</span></span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>number<span class="token punctuation">)</span><span class="token punctuation">]</span>

    <span class="token comment"># \u5B9A\u4E49\u6587\u4EF6\u5185\u5BB9</span>
    content <span class="token operator">=</span> <span class="token string">&quot;&quot;</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>lines<span class="token punctuation">)</span><span class="token punctuation">:</span>
        line <span class="token operator">=</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>random<span class="token punctuation">.</span>sample<span class="token punctuation">(</span><span class="token string">&#39;zyxwvutsrqponmlkjihgfedcba&#39;</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;\\n&quot;</span>
        content <span class="token operator">+=</span> line

    <span class="token comment"># \u751F\u6210\u6587\u4EF6-\u963B\u585E</span>
    <span class="token keyword">for</span> <span class="token builtin">file</span> <span class="token keyword">in</span> file_names<span class="token punctuation">:</span>
        <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">,</span> <span class="token string">&quot;w+&quot;</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
            f<span class="token punctuation">.</span>write<span class="token punctuation">(</span>content<span class="token punctuation">)</span>
    logging<span class="token punctuation">.</span>warning<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;Function [ write_sync  ] running time: </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token builtin">int</span><span class="token punctuation">(</span>time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> start<span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string"> seconds&quot;</span></span><span class="token punctuation">)</span>


<span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">write_async</span><span class="token punctuation">(</span>file_prefix<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">,</span> number<span class="token punctuation">:</span> <span class="token builtin">int</span><span class="token punctuation">,</span> lines<span class="token punctuation">:</span> <span class="token builtin">int</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">&#39;&#39;&#39;
    :param file_prefix: \u6587\u4EF6\u540D\u524D\u7F00
    :param number: \u6587\u4EF6\u4E2A\u6570
    :param lines: \u6BCF\u4E2A\u6587\u4EF6\u884C\u6570
    :return: None
    &#39;&#39;&#39;</span>

    start <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token comment"># \u5B9A\u4E49\u6587\u4EF6\u5217\u8868</span>
    file_names <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string-interpolation"><span class="token string">f&quot;</span><span class="token interpolation"><span class="token punctuation">{</span>file_prefix<span class="token punctuation">}</span></span><span class="token string">-</span><span class="token interpolation"><span class="token punctuation">{</span>i<span class="token punctuation">}</span></span><span class="token string">.txt&quot;</span></span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>number<span class="token punctuation">)</span><span class="token punctuation">]</span>

    <span class="token comment"># \u5B9A\u4E49\u6587\u4EF6\u5185\u5BB9</span>
    content <span class="token operator">=</span> <span class="token string">&quot;&quot;</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>lines<span class="token punctuation">)</span><span class="token punctuation">:</span>
        line <span class="token operator">=</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>random<span class="token punctuation">.</span>sample<span class="token punctuation">(</span><span class="token string">&#39;zyxwvutsrqponmlkjihgfedcba&#39;</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;\\n&quot;</span>
        content <span class="token operator">+=</span> line

    <span class="token comment"># \u751F\u6210\u6587\u4EF6\u51FD\u6570-\u975E\u963B\u585E</span>
    <span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">wrapper</span><span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">async</span> <span class="token keyword">with</span> aiofiles<span class="token punctuation">.</span><span class="token builtin">open</span><span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">,</span> mode<span class="token operator">=</span><span class="token string">&#39;w+&#39;</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
            <span class="token keyword">await</span> f<span class="token punctuation">.</span>write<span class="token punctuation">(</span>content<span class="token punctuation">)</span>

    <span class="token comment"># \u751F\u6210\u6587\u4EF6-\u975E\u963B\u585E</span>
    tasks <span class="token operator">=</span> <span class="token punctuation">[</span>wrapper<span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">)</span> <span class="token keyword">for</span> <span class="token builtin">file</span> <span class="token keyword">in</span> file_names<span class="token punctuation">]</span>
    <span class="token keyword">await</span> asyncio<span class="token punctuation">.</span>gather<span class="token punctuation">(</span><span class="token operator">*</span>tasks<span class="token punctuation">)</span>

    logging<span class="token punctuation">.</span>warning<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;Function [ write_async ] running time: </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token builtin">int</span><span class="token punctuation">(</span>time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> start<span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string"> seconds&quot;</span></span><span class="token punctuation">)</span>


<span class="token comment"># \u751F\u621030\u4E2A\u6587\u4EF6\uFF0C\u6BCF\u4E2A\u6587\u4EF6\u5305\u542B800\u4E07\u884C</span>
asyncio<span class="token punctuation">.</span>run<span class="token punctuation">(</span>write_sync<span class="token punctuation">(</span><span class="token string">&quot;sync&quot;</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">8000000</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
asyncio<span class="token punctuation">.</span>run<span class="token punctuation">(</span>write_async<span class="token punctuation">(</span><span class="token string">&quot;async&quot;</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">8000000</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div></details><p>\u8F93\u51FA\u7ED3\u679C</p><div class="language-bash ext-sh"><pre class="language-bash"><code><span class="token number">2022</span>-04-04 <span class="token number">11</span>:30:32,599	 <span class="token punctuation">[</span>MainThread, <span class="token number">241668</span><span class="token punctuation">]</span> Function <span class="token punctuation">[</span> write_sync  <span class="token punctuation">]</span> running time: <span class="token number">312</span> seconds
<span class="token number">2022</span>-04-04 <span class="token number">11</span>:35:17,728	 <span class="token punctuation">[</span>MainThread, <span class="token number">241668</span><span class="token punctuation">]</span> Function <span class="token punctuation">[</span> write_async <span class="token punctuation">]</span> running time: <span class="token number">285</span> seconds
</code></pre></div><p>\u53EF\u4EE5\u770B\u5230\u786E\u5B9E\u6709\u6548\u679C\uFF0C\u4F46\u662F\u63D0\u901F\u5E76\u4E0D\u660E\u663E</p><p>\u5C24\u5176\u662F\u5F53\u6211\u4EEC\u51CF\u5C11\u6587\u4EF6\u6570\u91CF\u3001\u51CF\u5C11\u6587\u4EF6\u5185\u5BB9\u7684\u65F6\u5019\uFF0C\u4E24\u79CD\u65B9\u5F0F\u8FD0\u884C\u6548\u679C\u51E0\u4E4E\u4E00\u81F4\uFF0C\u751A\u81F3\u6709\u53EF\u80FD\u51FA\u73B0\u534F\u7A0B\u4F1A\u66F4\u6162\u7684\u60C5\u51B5</p><p>\u8FD9\u662F\u4E3A\u4EC0\u4E48\u5462\uFF1F\u53EF\u80FD\u662F\u56E0\u4E3A\u7F51\u7EDCIO\u548C\u78C1\u76D8IO\u7684\u4E0D\u540C\u5BFC\u81F4\u7684\u3002</p><h4 id="\u534F\u7A0B\u4E0E\u540C\u6B65\u963B\u585E\u6DF7\u5408\u7F16\u7A0B" tabindex="-1"><a class="header-anchor" href="#\u534F\u7A0B\u4E0E\u540C\u6B65\u963B\u585E\u6DF7\u5408\u7F16\u7A0B" aria-hidden="true">#</a> \u534F\u7A0B\u4E0E\u540C\u6B65\u963B\u585E\u6DF7\u5408\u7F16\u7A0B</h4><p>\u6CE8\u5165\u4E8B\u4EF6\u5FAA\u73AF\u4E2D\u7684\u6267\u884C\u5668\uFF08\u9ED8\u8BA4\u4E3A\u7EBF\u7A0B\u6C60\uFF09\uFF0C\u540E\u9762\u53BB\u8BB2\u5230</p><p>\u4EE3\u7801\u6F14\u793A</p><details class="custom-container details"><summary>\u70B9\u51FB\u67E5\u770B\u5B8C\u6574\u4EE3\u7801</summary><div class="language-python ext-py"><pre class="language-python"><code><span class="token comment">#!/usr/bin/env python</span>
<span class="token comment"># -*- coding:utf-8 -*-</span>

<span class="token keyword">import</span> asyncio
<span class="token keyword">import</span> logging
<span class="token keyword">import</span> time

<span class="token keyword">import</span> requests
<span class="token keyword">import</span> urllib3
<span class="token keyword">from</span> functools <span class="token keyword">import</span> partial

<span class="token comment"># \u4E0D\u9A8C\u8BC1HTTPS\u8BC1\u4E66\u540E\u4F1A\u5F39\u51FA\u8B66\u544A\uFF0C\u6B64\u4EE3\u7801\u7528\u4E8E\u5173\u95ED\u8B66\u544A</span>
urllib3<span class="token punctuation">.</span>disable_warnings<span class="token punctuation">(</span>urllib3<span class="token punctuation">.</span>exceptions<span class="token punctuation">.</span>InsecureRequestWarning<span class="token punctuation">)</span>

<span class="token comment"># \u521D\u59CB\u5316\u65E5\u5FD7</span>
FORMAT <span class="token operator">=</span> <span class="token string">&#39;%(asctime)-15s\\t [%(threadName)s, %(thread)d] %(message)s&#39;</span>
logging<span class="token punctuation">.</span>basicConfig<span class="token punctuation">(</span><span class="token builtin">format</span><span class="token operator">=</span>FORMAT<span class="token punctuation">)</span>


<span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">download_sync</span><span class="token punctuation">(</span>urls<span class="token punctuation">:</span> <span class="token builtin">list</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    name <span class="token operator">=</span> <span class="token string">&quot;download_sync&quot;</span>

    start <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> url <span class="token keyword">in</span> urls<span class="token punctuation">:</span>
        <span class="token comment"># \u53D1\u9001HTTP\u8BF7\u6C42</span>
        response <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">,</span> verify<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>

        <span class="token comment"># \u5199\u5165\u78C1\u76D8</span>
        file_name <span class="token operator">=</span> url<span class="token punctuation">.</span>rsplit<span class="token punctuation">(</span><span class="token string">&quot;/&quot;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>
        <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>file_name<span class="token punctuation">,</span> mode<span class="token operator">=</span><span class="token string">&quot;wb&quot;</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
            f<span class="token punctuation">.</span>write<span class="token punctuation">(</span>response<span class="token punctuation">.</span>content<span class="token punctuation">)</span>

    logging<span class="token punctuation">.</span>warning<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;</span><span class="token interpolation"><span class="token punctuation">{</span>name<span class="token punctuation">:</span><span class="token format-spec">14</span><span class="token punctuation">}</span></span><span class="token string"> \u4E0B\u8F7D\u5B8C\u6210 | \u7528\u65F6: </span><span class="token interpolation"><span class="token punctuation">{</span>time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> start<span class="token punctuation">}</span></span><span class="token string">\u79D2&quot;</span></span><span class="token punctuation">)</span>


<span class="token comment"># \u534F\u7A0B\u548Crequests\u5E93\u6DF7\u5408\u7F16\u7A0B</span>
<span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">download_async</span><span class="token punctuation">(</span>urls<span class="token punctuation">:</span> <span class="token builtin">list</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    name <span class="token operator">=</span> <span class="token string">&quot;download_async&quot;</span>

    <span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">wrapper</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># \u83B7\u53D6\u4E8B\u4EF6\u5FAA\u73AF</span>
        loop <span class="token operator">=</span> asyncio<span class="token punctuation">.</span>get_event_loop<span class="token punctuation">(</span><span class="token punctuation">)</span>
        
        <span class="token comment"># run_in_executor\u4E2D\u5E76\u4E0D\u80FD\u7ED9\u6267\u884C\u7684\u51FD\u6570\u4F20\u9012\u5B57\u5178\u53C2\u6570\uFF0C\u6240\u4EE5\u8FD9\u91CC\u7528get2\u6765\u4EE3\u66FFrequests.get</span>
        get2 <span class="token operator">=</span> partial<span class="token punctuation">(</span>requests<span class="token punctuation">.</span>get<span class="token punctuation">,</span> verify<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
        
        <span class="token comment"># \u6267\u884C\u5668\u6267\u884C\u540C\u6B65\u963B\u585E\u51FD\u6570</span>
        future <span class="token operator">=</span> loop<span class="token punctuation">.</span>run_in_executor<span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> get2<span class="token punctuation">,</span> url<span class="token punctuation">)</span>
        response <span class="token operator">=</span> <span class="token keyword">await</span> future

        <span class="token comment"># \u5199\u5165\u78C1\u76D8</span>
        file_name <span class="token operator">=</span> url<span class="token punctuation">.</span>rsplit<span class="token punctuation">(</span><span class="token string">&quot;/&quot;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>
        <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>file_name<span class="token punctuation">,</span> mode<span class="token operator">=</span><span class="token string">&quot;wb&quot;</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
            f<span class="token punctuation">.</span>write<span class="token punctuation">(</span>response<span class="token punctuation">.</span>content<span class="token punctuation">)</span>

    start <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>
    tasks <span class="token operator">=</span> <span class="token punctuation">[</span>wrapper<span class="token punctuation">(</span>url<span class="token punctuation">)</span> <span class="token keyword">for</span> url <span class="token keyword">in</span> urls<span class="token punctuation">]</span>
    <span class="token keyword">await</span> asyncio<span class="token punctuation">.</span>wait<span class="token punctuation">(</span>tasks<span class="token punctuation">)</span>
    logging<span class="token punctuation">.</span>warning<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;</span><span class="token interpolation"><span class="token punctuation">{</span>name<span class="token punctuation">:</span><span class="token format-spec">14</span><span class="token punctuation">}</span></span><span class="token string"> \u4E0B\u8F7D\u5B8C\u6210 | \u7528\u65F6: </span><span class="token interpolation"><span class="token punctuation">{</span>time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> start<span class="token punctuation">}</span></span><span class="token string">\u79D2&quot;</span></span><span class="token punctuation">)</span>


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">&quot;__main__&quot;</span><span class="token punctuation">:</span>
    urls <span class="token operator">=</span> <span class="token punctuation">[</span>
        <span class="token string">&quot;https://img-pre.ivsky.com/img/tupian/pre/202108/09/fengniao.jpg&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;https://img-pre.ivsky.com/img/tupian/pre/202108/09/fengniao-003.jpg&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;https://img-pre.ivsky.com/img/tupian/pre/202108/09/fengniao-004.jpg&quot;</span>
    <span class="token punctuation">]</span>

    asyncio<span class="token punctuation">.</span>run<span class="token punctuation">(</span>download_sync<span class="token punctuation">(</span>urls<span class="token punctuation">)</span><span class="token punctuation">)</span>
    asyncio<span class="token punctuation">.</span>run<span class="token punctuation">(</span>download_async<span class="token punctuation">(</span>urls<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div></details><p>\u8F93\u51FA\u7ED3\u679C</p><div class="language-bash ext-sh"><pre class="language-bash"><code><span class="token number">2022</span>-04-04 <span class="token number">12</span>:23:50,691	 <span class="token punctuation">[</span>MainThread, <span class="token number">252956</span><span class="token punctuation">]</span> download_sync  \u4E0B\u8F7D\u5B8C\u6210 <span class="token operator">|</span> \u7528\u65F6: <span class="token number">0.9531307220458984</span>\u79D2
<span class="token number">2022</span>-04-04 <span class="token number">12</span>:23:51,035	 <span class="token punctuation">[</span>MainThread, <span class="token number">252956</span><span class="token punctuation">]</span> download_async \u4E0B\u8F7D\u5B8C\u6210 <span class="token operator">|</span> \u7528\u65F6: <span class="token number">0.3437678813934326</span>\u79D2
</code></pre></div><p>\u53EF\u4EE5\u770B\u5230\u6548\u679C\u63D0\u5347\u8FD8\u662F\u6BD4\u8F83\u660E\u663E</p><h3 id="\u534F\u7A0B\u6DF1\u5165\u7406\u89E3" tabindex="-1"><a class="header-anchor" href="#\u534F\u7A0B\u6DF1\u5165\u7406\u89E3" aria-hidden="true">#</a> \u534F\u7A0B\u6DF1\u5165\u7406\u89E3</h3><h4 id="\u65E9\u671F\u7684\u534F\u7A0B\u6267\u884C\u6700\u9AD8\u5165\u53E3" tabindex="-1"><a class="header-anchor" href="#\u65E9\u671F\u7684\u534F\u7A0B\u6267\u884C\u6700\u9AD8\u5165\u53E3" aria-hidden="true">#</a> \u65E9\u671F\u7684\u534F\u7A0B\u6267\u884C\u6700\u9AD8\u5165\u53E3</h4><div class="language-python ext-py"><pre class="language-python"><code><span class="token comment">#!/usr/bin/env python</span>
<span class="token comment"># -*- coding:utf-8 -*-</span>

<span class="token keyword">import</span> asyncio


<span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;hello world&quot;</span><span class="token punctuation">)</span>

<span class="token comment"># \u8FD0\u884C\u534F\u7A0B\u51FD\u6570</span>
<span class="token comment"># asyncio.run(main())</span>

<span class="token comment"># \u4E5F\u53EF\u4EE5\u4F7F\u7528\u4F4E\u7EA7API\u6765\u8FD0\u884C\u534F\u7A0B\u51FD\u6570</span>
loop <span class="token operator">=</span> asyncio<span class="token punctuation">.</span>get_event_loop<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># \u83B7\u53D6\u4E8B\u4EF6\u5FAA\u73AF\u5BF9\u8C61</span>
loop<span class="token punctuation">.</span>run_until_complete<span class="token punctuation">(</span>main<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># \u5C06\u534F\u7A0B\u5BF9\u8C61\u653E\u5165\u4E8B\u4EF6\u5FAA\u73AF</span>
</code></pre></div><h4 id="\u4E8B\u4EF6\u5FAA\u73AF" tabindex="-1"><a class="header-anchor" href="#\u4E8B\u4EF6\u5FAA\u73AF" aria-hidden="true">#</a> \u4E8B\u4EF6\u5FAA\u73AF</h4>`,41),fs=s("\u5B98\u65B9\u6587\u6863\uFF1A"),ws={href:"https://docs.python.org/zh-cn/3.9/library/asyncio-eventloop.html",target:"_blank",rel:"noopener noreferrer"},qs=s("https://docs.python.org/zh-cn/3.9/library/asyncio-eventloop.html"),xs=p(`<p>\u770B\u4E00\u4E0B\u5B98\u7F51\u7684\u63CF\u8FF0\uFF1A</p><blockquote><p>\u4E8B\u4EF6\u5FAA\u73AF\u662F\u6BCF\u4E2A asyncio \u5E94\u7528\u7684\u6838\u5FC3\u3002 \u4E8B\u4EF6\u5FAA\u73AF\u4F1A\u8FD0\u884C\u5F02\u6B65\u4EFB\u52A1\u548C\u56DE\u8C03\uFF0C\u6267\u884C\u7F51\u7EDC IO \u64CD\u4F5C\uFF0C\u4EE5\u53CA\u8FD0\u884C\u5B50\u8FDB\u7A0B\u3002</p></blockquote><p>\u7B80\u5355\u6765\u8BF4\uFF0C\u4E8B\u4EF6\u5FAA\u73AF\u5C31\u662F\u4E00\u4E2A\u5927\u5FAA\u73AF\uFF0C\u7528\u6765\u8C03\u5EA6\u534F\u7A0B\u5BF9\u8C61\uFF0C\u53EF\u4EE5\u8BA9\u6211\u4EEC\u66F4\u7CBE\u7EC6\u7684\u63A7\u5236\u534F\u7A0B\u8C03\u5EA6</p><p><strong>\u521B\u5EFA\u548C\u8FD0\u884C</strong></p><p>\u4E8B\u4EF6\u5FAA\u73AF\u76F8\u5173\u65B9\u6CD5</p><table><thead><tr><th>\u65B9\u6CD5</th><th>\u8BF4\u660E</th></tr></thead><tbody><tr><td>asyncio.new_event_loop()</td><td>\u521B\u5EFA\u4E00\u4E2A\u4E8B\u4EF6\u5FAA\u73AF</td></tr><tr><td>asyncio.set_event_loop(loop)</td><td>\u5C06loop\u8BBE\u7F6E\u4E3A\u5F53\u524DOS\u7EBF\u7A0B\u7684\u5F53\u524D\u4E8B\u4EF6\u5FAA\u73AF</td></tr><tr><td><strong>asyncio.get_event_loop()</strong></td><td>\u83B7\u53D6\u5F53\u524D\u4E8B\u4EF6\u5FAA\u73AF\uFF0C\u5982\u679C\u5F53\u524D\u6CA1\u6709\u8FD0\u884C\u5219\u521B\u5EFA\u4E00\u4E2A\u65B0\u7684\u4E8B\u4EF6\u5FAA\u73AF</td></tr><tr><td><strong>asyncio.get_running_loop()</strong></td><td>\u8FD4\u56DE\u5F53\u524DOS\u7EBF\u7A0B\u4E2D\u6B63\u5728\u8FD0\u884C\u7684\u4E8B\u4EF6\u5FAA\u73AF\uFF0C\u5982\u679C\u6CA1\u6709\u8FD0\u884C\u5219\u5F15\u53D1RuntimeError<br>\uFF081\uFF09\u6B64\u51FD\u6570\u53EA\u80FD\u7531\u534F\u7A0B\u6216\u56DE\u8C03\u6765\u8C03\u7528\u3002<br>\uFF082\uFF09\u5B98\u65B9\u66F4\u63A8\u8350\u4F7F\u7528\u8FD9\u4E2A\u800C\u4E0D\u662F<code>get_event_loop</code></td></tr><tr><td>asyncio.get_event_loop_policy()</td><td>\u83B7\u53D6\u5F53\u524D\u4E8B\u4EF6\u5FAA\u73AF\u7B56\u7565</td></tr><tr><td><strong>asyncio.set_event_loop_policy(policy)</strong></td><td>\u8BBE\u7F6E\u5F53\u524D\u4E8B\u4EF6\u5FAA\u73AF\u7B56\u7565\uFF0C\u6BD4\u5982\u4F7F\u7528<code>uvloop</code>\u63D0\u4F9B\u7684\u4E8B\u4EF6\u5FAA\u73AF\u7B56\u7565\u6765\u52A0\u5FEB\u534F\u7A0B\u6267\u884C\u901F\u5EA6</td></tr></tbody></table><p>\u4E8B\u4EF6\u5FAA\u73AF\u4EE3\u7801\u6F14\u793A</p><details class="custom-container details"><summary>\u70B9\u51FB\u67E5\u770B\u5B8C\u6574\u4EE3\u7801</summary><div class="language-python ext-py"><pre class="language-python"><code><span class="token comment">#!/usr/bin/env python</span>
<span class="token comment"># -*- coding:utf-8 -*-</span>

<span class="token keyword">import</span> asyncio
<span class="token keyword">import</span> logging

<span class="token comment"># \u521D\u59CB\u5316\u65E5\u5FD7</span>
FORMAT <span class="token operator">=</span> <span class="token string">&#39;%(asctime)-15s\\t [%(threadName)s, %(thread)d] %(message)s&#39;</span>
logging<span class="token punctuation">.</span>basicConfig<span class="token punctuation">(</span><span class="token builtin">format</span><span class="token operator">=</span>FORMAT<span class="token punctuation">)</span>

<span class="token comment"># \u56E0\u4E3A\u4E8B\u4EF6\u5FAA\u73AF\u5C1A\u672A\u8FD0\u884C\uFF0C\u6240\u4EE5\u8FD9\u91CC\u4F1A\u62A5\u9519 RuntimeError: no running event loop</span>
<span class="token comment"># loop = asyncio.get_running_loop()</span>
<span class="token comment"># print(loop)</span>

<span class="token comment"># \u770B\u770B\u4E8B\u4EF6\u5FAA\u73AF\u5230\u5E95\u662F\u4E2A\u5565?</span>
loop1 <span class="token operator">=</span> asyncio<span class="token punctuation">.</span>get_event_loop<span class="token punctuation">(</span><span class="token punctuation">)</span>
logging<span class="token punctuation">.</span>warning<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;\u4E8B\u4EF6\u5FAA\u73AF1: </span><span class="token interpolation"><span class="token punctuation">{</span>loop1<span class="token punctuation">}</span></span><span class="token string"> | \u5185\u5B58\u5730\u5740: </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token builtin">id</span><span class="token punctuation">(</span>loop1<span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>

<span class="token comment"># \u521B\u5EFA\u4E00\u4E2A\u65B0\u7684\u4E8B\u4EF6\u5FAA\u73AF\u5BF9\u8C61\uFF0C\u5E76\u8BBE\u7F6E\u4E3A\u5F53\u524D\u4E8B\u4EF6\u5FAA\u73AF</span>
loop2 <span class="token operator">=</span> asyncio<span class="token punctuation">.</span>new_event_loop<span class="token punctuation">(</span><span class="token punctuation">)</span>
asyncio<span class="token punctuation">.</span>set_event_loop<span class="token punctuation">(</span>loop2<span class="token punctuation">)</span>
logging<span class="token punctuation">.</span>warning<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;\u4E8B\u4EF6\u5FAA\u73AF2: </span><span class="token interpolation"><span class="token punctuation">{</span>asyncio<span class="token punctuation">.</span>get_event_loop<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string"> | \u5185\u5B58\u5730\u5740: </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token builtin">id</span><span class="token punctuation">(</span>asyncio<span class="token punctuation">.</span>get_event_loop<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>


<span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">show_current_loop</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">:</span>
    current_loop <span class="token operator">=</span> asyncio<span class="token punctuation">.</span>get_running_loop<span class="token punctuation">(</span><span class="token punctuation">)</span>
    logging<span class="token punctuation">.</span>warning<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;</span><span class="token interpolation"><span class="token punctuation">{</span>message<span class="token punctuation">}</span></span><span class="token string">: </span><span class="token interpolation"><span class="token punctuation">{</span>current_loop<span class="token punctuation">}</span></span><span class="token string"> | \u5185\u5B58\u5730\u5740\uFF1A</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token builtin">id</span><span class="token punctuation">(</span>current_loop<span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>


<span class="token comment"># \u8FD0\u884C\u4E8B\u4EF6\u5FAA\u73AF</span>
loop1<span class="token punctuation">.</span>run_until_complete<span class="token punctuation">(</span>show_current_loop<span class="token punctuation">(</span><span class="token string">&quot;\u5728\u4E8B\u4EF6\u5FAA\u73AF1\u4E2D\u8FD0\u884C&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
loop2<span class="token punctuation">.</span>run_until_complete<span class="token punctuation">(</span>show_current_loop<span class="token punctuation">(</span><span class="token string">&quot;\u5728\u4E8B\u4EF6\u5FAA\u73AF1\u4E2D\u8FD0\u884C&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div></details><p>\u8F93\u51FA\u7ED3\u679C</p><div class="language-bash ext-sh"><pre class="language-bash"><code><span class="token number">2022</span>-04-04 <span class="token number">16</span>:09:19,252	 <span class="token punctuation">[</span>MainThread, <span class="token number">261928</span><span class="token punctuation">]</span> \u4E8B\u4EF6\u5FAA\u73AF1: <span class="token operator">&lt;</span>_WindowsSelectorEventLoop <span class="token assign-left variable">running</span><span class="token operator">=</span>False <span class="token assign-left variable">closed</span><span class="token operator">=</span>False <span class="token assign-left variable">debug</span><span class="token operator">=</span>False<span class="token operator">&gt;</span> <span class="token operator">|</span> \u5185\u5B58\u5730\u5740: <span class="token number">1926186899208</span>
<span class="token number">2022</span>-04-04 <span class="token number">16</span>:09:19,252	 <span class="token punctuation">[</span>MainThread, <span class="token number">261928</span><span class="token punctuation">]</span> \u4E8B\u4EF6\u5FAA\u73AF2: <span class="token operator">&lt;</span>_WindowsSelectorEventLoop <span class="token assign-left variable">running</span><span class="token operator">=</span>False <span class="token assign-left variable">closed</span><span class="token operator">=</span>False <span class="token assign-left variable">debug</span><span class="token operator">=</span>False<span class="token operator">&gt;</span> <span class="token operator">|</span> \u5185\u5B58\u5730\u5740: <span class="token number">1926189799880</span>
<span class="token number">2022</span>-04-04 <span class="token number">16</span>:09:19,252	 <span class="token punctuation">[</span>MainThread, <span class="token number">261928</span><span class="token punctuation">]</span> \u5728\u4E8B\u4EF6\u5FAA\u73AF1\u4E2D\u8FD0\u884C: <span class="token operator">&lt;</span>_WindowsSelectorEventLoop <span class="token assign-left variable">running</span><span class="token operator">=</span>True <span class="token assign-left variable">closed</span><span class="token operator">=</span>False <span class="token assign-left variable">debug</span><span class="token operator">=</span>False<span class="token operator">&gt;</span> <span class="token operator">|</span> \u5185\u5B58\u5730\u5740\uFF1A1926186899208
<span class="token number">2022</span>-04-04 <span class="token number">16</span>:09:19,252	 <span class="token punctuation">[</span>MainThread, <span class="token number">261928</span><span class="token punctuation">]</span> \u5728\u4E8B\u4EF6\u5FAA\u73AF1\u4E2D\u8FD0\u884C: <span class="token operator">&lt;</span>_WindowsSelectorEventLoop <span class="token assign-left variable">running</span><span class="token operator">=</span>True <span class="token assign-left variable">closed</span><span class="token operator">=</span>False <span class="token assign-left variable">debug</span><span class="token operator">=</span>False<span class="token operator">&gt;</span> <span class="token operator">|</span> \u5185\u5B58\u5730\u5740\uFF1A1926189799880
</code></pre></div><blockquote><p>\uFF081\uFF09\u7B2C\u4E00\u884C\u8F93\u51FA\uFF1Arunning=False \u8BF4\u660E\u867D\u7136\u521B\u5EFA\u4E86\u4E8B\u4EF6\u5FAA\u73AF\uFF0C\u4F46\u5E76\u672A\u8FD0\u884C</p><p>\uFF082\uFF09\u7B2C\u4E8C\u884C\u8F93\u51FA\uFF1A\u6211\u4EEC\u53C8\u521B\u5EFA\u4E86\u4E00\u4E2A\u4E8B\u4EF6\u5FAA\u73AF\uFF0C\u4E24\u4E2A\u5BF9\u6BD4\u4E00\u4E0B\uFF0C\u53D1\u73B0\u5185\u5B58\u5730\u5740\u5E76\u4E0D\u76F8\u540C</p><p>\uFF083\uFF09\u7B2C\u4E09\u884C\u8F93\u51FA\uFF1A\u6211\u4EEC\u7F16\u5199\u7684\u5F02\u6B65\u4EE3\u7801\u5728\u7B2C1\u4E2A\u4E8B\u4EF6\u5FAA\u73AF\u4E2D\u8FD0\u884C\uFF1A</p><p>\u200B \u2460 running\u5DF2\u53D8\u6210\u4E86True\uFF0C\u8BF4\u660E\u4E8B\u4EF6\u5FAA\u73AF\u8FD0\u884C\u8D77\u6765\u4E86</p><p>\u200B \u2461 \u5185\u5B58\u5730\u5740\u4E0E\u4E8B\u4EF6\u5FAA\u73AF1\u76F8\u540C</p><p>\uFF084\uFF09\u7B2C\u56DB\u884C\u8F93\u51FA\uFF1A\u6211\u4EEC\u7F16\u5199\u7684\u5F02\u6B65\u4EE3\u7801\u5728\u7B2C2\u4E2A\u4E8B\u4EF6\u5FAA\u73AF\u4E2D\u8FD0\u884C</p></blockquote><p><span style="color:red;font-weight:bold;">\u603B\u7ED3\uFF1A\u53EF\u4EE5\u6709\u591A\u4E2A\u4E8B\u4EF6\u5FAA\u73AF\uFF1B\u534F\u7A0B\u51FD\u6570\u9700\u8981\u5728\u4E00\u4E2A\u5177\u4F53\u7684\u4E8B\u4EF6\u5FAA\u73AF\u4E2D\u6267\u884C</span></p><br><p><strong>\u4E8B\u4EF6\u5FAA\u73AF\u5B9E\u4F8B\u65B9\u6CD5</strong></p><table><thead><tr><th>\u65B9\u6CD5</th><th>\u8BF4\u660E</th></tr></thead><tbody><tr><td>loop.run_until_complete(future)</td><td>\u8FD0\u884C\u76F4\u5230 future ( Future \u7684\u5B9E\u4F8B )\u88AB\u5B8C\u6210\uFF1B\u4E5F\u53EF\u4EE5\u4F20\u5165\u534F\u7A0B\u5BF9\u8C61\uFF0C\u4F1A\u81EA\u52A8\u5904\u7406<br>\uFF081\uFF09\u5982\u679C\u5F53\u524D\u4E8B\u4EF6\u5FAA\u73AFloop\u5904\u4E8E\u505C\u6B62\u72B6\u6001(stop)\uFF0C\u4F1A\u81EA\u52A8\u542F\u52A8<br>\uFF082\uFF09\u5982\u679C\u5F53\u524D\u4E8B\u4EF6\u5FAA\u73AFloop\u5904\u4E8E\u5173\u95ED\u72B6\u6001(close)\uFF0C\u5219\u4F1A\u629B\u51FA\u5F02\u5E38<code>RuntimeError: Event loop is closed</code></td></tr><tr><td>loop.run_forever()</td><td>\u8FD0\u884C\u4E8B\u4EF6\u5FAA\u73AF\u76F4\u5230 stop() \u88AB\u8C03\u7528</td></tr><tr><td>loop.stop()</td><td>\u505C\u6B62\u4E8B\u4EF6\u5FAA\u73AF</td></tr><tr><td>loop.is_running()</td><td>\u4E8B\u4EF6\u5FAA\u73AF\u662F\u5426\u6B63\u5728\u8FD0\u884C</td></tr><tr><td>loop.close()</td><td>\u5173\u95ED\u4E8B\u4EF6\u5FAA\u73AF\uFF0C\u5F53\u8FD9\u4E2A\u51FD\u6570\u88AB\u8C03\u7528\u7684\u65F6\u5019\uFF0C\u5FAA\u73AF\u5FC5\u987B\u5904\u4E8E\u975E\u8FD0\u884C\u72B6\u6001</td></tr><tr><td>loop.is_closed()</td><td>\u4E8B\u4EF6\u5FAA\u73AF\u662F\u5426\u5DF2\u7ECF\u88AB\u5173\u95ED</td></tr><tr><td>loop.run_in_executor(executor, func, *args)</td><td>\u5728\u6307\u5B9A\u7684\u6267\u884C\u5668\u4E2D\u8C03\u7528func,\u8FD4\u56DEFuture\u5BF9\u8C61\uFF1B\u6267\u884C\u5668\u53EF\u4EE5\u4E3A\uFF1A<br>\uFF081\uFF09None,\u4F7F\u7528\u9ED8\u8BA4\u6267\u884C\u5668\uFF0C\u7EBF\u7A0B\u6C60<br>\uFF082\uFF09concurrent.futures.ThreadPoolExecutor()\u5BF9\u8C61\uFF0C\u7EBF\u7A0B\u6C60<br>\uFF083\uFF09concurrent.futures.ProcessPoolExecutor()\u5BF9\u8C61\uFF0C\u8FDB\u7A0B\u6C60<br>\u5982\u679C\u8981\u7ED9\u51FD\u6570func\u4F20\u9012\u5B57\u5178\u53C2\u6570\uFF0C\u5219\u53EF\u4EE5\u4F7F\u7528\u6807\u51C6\u5E93<code>functools.partial</code>\u6765\u5BF9\u51FD\u6570\u8FDB\u884C\u4E00\u5C42\u5305\u88C5</td></tr></tbody></table><h4 id="\u53EF\u7B49\u5F85\u5BF9\u8C61" tabindex="-1"><a class="header-anchor" href="#\u53EF\u7B49\u5F85\u5BF9\u8C61" aria-hidden="true">#</a> \u53EF\u7B49\u5F85\u5BF9\u8C61</h4>`,16),vs=s("\u6587\u6863\uFF1A"),Ts={href:"https://docs.python.org/zh-cn/3.9/library/asyncio-task.html#awaitables",target:"_blank",rel:"noopener noreferrer"},Cs=s("https://docs.python.org/zh-cn/3.9/library/asyncio-task.html#awaitables"),Ps=s("\u5982\u679C\u4E00\u4E2A\u5BF9\u8C61\u53EF\u4EE5\u5728 "),Fs={href:"https://docs.python.org/zh-cn/3.9/reference/expressions.html#await",target:"_blank",rel:"noopener noreferrer"},Ns=n("code",null,"await",-1),Es=s(" \u8BED\u53E5\u4E2D\u4F7F\u7528\uFF0C\u90A3\u4E48\u5B83\u5C31\u662F "),As=n("strong",null,"\u53EF\u7B49\u5F85",-1),Ms=s(" \u5BF9\u8C61\u3002\u8BB8\u591A asyncio API \u90FD\u88AB\u8BBE\u8BA1\u4E3A\u63A5\u53D7\u53EF\u7B49\u5F85\u5BF9\u8C61\u3002"),Os=n("p",null,"\u53EF\u7B49\u5F85\u5BF9\u8C61\u6709\u51E0\u4E0B\u51E0\u79CD\u7C7B\u578B:",-1),js=n("ul",null,[n("li",null,"\u534F\u7A0B"),n("li",null,"Task"),n("li",null,"Future"),n("li",null,[s("\u62E5\u6709"),n("code",null,"__await__"),s("\u65B9\u6CD5\u7684\u5BF9\u8C61")])],-1),Rs=n("h4",{id:"task\u5BF9\u8C61",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#task\u5BF9\u8C61","aria-hidden":"true"},"#"),s(" Task\u5BF9\u8C61")],-1),zs=s("\u6587\u6863\uFF1A"),Is={href:"https://docs.python.org/zh-cn/3.9/library/asyncio-task.html#task-object",target:"_blank",rel:"noopener noreferrer"},Ss=s("https://docs.python.org/zh-cn/3.9/library/asyncio-task.html#task-object"),Bs=p('<p>Task\u8BF4\u660E</p><ul><li><p>Task\u5BF9\u8C61\u662F\u5BF9\u534F\u7A0B\u5BF9\u8C61\u7684\u4E00\u5C42\u5305\u88C5\uFF0C\u8BE5\u534F\u7A0B\u4F1A\u88AB<strong>\u81EA\u52A8\u8C03\u5EA6\u6267\u884C</strong></p><p>Task\u521B\u5EFA\u5B8C\u540E\u4F1A\u88AB<strong>\u81EA\u52A8\u8C03\u5EA6\u6267\u884C</strong>\uFF0C\u6240\u4EE5\u5982\u679C\u5728\u4E8B\u4EF6\u5FAA\u73AF\u8FD0\u884C\u4E4B\u524D\u521B\u5EFATask\uFF0C\u4F1A\u62A5\u9519<code>RuntimeError: no running event loop</code></p></li><li><p>Task\u5BF9\u8C61\u662F\u7EBF\u7A0B\u4E0D\u5B89\u5168\u7684</p></li><li><p>Task\u662FFuture\u7684\u5B50\u7C7B</p></li></ul><p>\u521B\u5EFATask\u5B9E\u4F8B\u7684\u65B9\u6CD5</p><ul><li>\u9AD8\u7EA7API \uFF1A<code>asyncio.create_task(\u534F\u7A0B\u5BF9\u8C61, *, name=None)</code>\uFF08\u63A8\u8350\u4F7F\u7528\uFF09</li><li>\u4F4E\u7EA7API \uFF1A<code>loop.create_task(\u534F\u7A0B\u5BF9\u8C61, *, name=None)</code></li><li>\u4F4E\u7EA7API\uFF1A<code>asyncio.ensure_future(obj, *, loop=None)</code></li></ul><h4 id="future\u5BF9\u8C61" tabindex="-1"><a class="header-anchor" href="#future\u5BF9\u8C61" aria-hidden="true">#</a> Future\u5BF9\u8C61</h4>',5),Ls=s("\u6587\u6863\uFF1A"),Ds={href:"https://docs.python.org/zh-cn/3.9/library/asyncio-future.html#asyncio.Future",target:"_blank",rel:"noopener noreferrer"},Us=s("https://docs.python.org/zh-cn/3.9/library/asyncio-future.html#asyncio.Future"),Vs=p(`<p>Future\u8BF4\u660E</p><ul><li>Future\u8868\u793A\u5F02\u6B65\u64CD\u4F5C\u7684 <strong>\u6700\u7EC8\u7ED3\u679C</strong>\uFF0C\u662F\u4E00\u79CD\u7279\u6B8A\u7684<strong>\u4F4E\u5C42\u7EA7</strong> \u53EF\u7B49\u5F85\u5BF9\u8C61\uFF0C\u901A\u5E38\u60C5\u51B5\u4E0B<strong>\u6CA1\u6709\u5FC5\u8981</strong>\u5728\u5E94\u7528\u5C42\u7EA7\u7684\u4EE3\u7801\u4E2D\u521B\u5EFA Future \u5BF9\u8C61</li><li>Future\u5BF9\u8C61\u662F\u7EBF\u7A0B\u4E0D\u5B89\u5168\u7684</li></ul><p>Future\u7B80\u5355\u793A\u4F8B</p><div class="language-python ext-py"><pre class="language-python"><code><span class="token comment">#!/usr/bin/env python</span>
<span class="token comment"># -*- coding:utf-8 -*-</span>

<span class="token keyword">import</span> asyncio
<span class="token keyword">import</span> logging

<span class="token comment"># \u521D\u59CB\u5316\u65E5\u5FD7</span>
FORMAT <span class="token operator">=</span> <span class="token string">&#39;%(asctime)-15s\\t [%(threadName)s, %(thread)d] %(message)s&#39;</span>
logging<span class="token punctuation">.</span>basicConfig<span class="token punctuation">(</span><span class="token builtin">format</span><span class="token operator">=</span>FORMAT<span class="token punctuation">)</span>


<span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">display</span><span class="token punctuation">(</span>future<span class="token punctuation">:</span> asyncio<span class="token punctuation">.</span>Future<span class="token punctuation">)</span><span class="token punctuation">:</span>
    future<span class="token punctuation">.</span>set_result<span class="token punctuation">(</span><span class="token string">&quot;Hello World&quot;</span><span class="token punctuation">)</span>  <span class="token comment"># \u8BBE\u7F6Efuture\u8FD4\u56DE\u503C</span>


<span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    loop <span class="token operator">=</span> asyncio<span class="token punctuation">.</span>get_running_loop<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># \u5F97\u5230\u5F53\u524D\u4E8B\u4EF6\u5FAA\u73AF</span>
    future <span class="token operator">=</span> loop<span class="token punctuation">.</span>create_future<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># \u5728\u5F53\u524D\u4E8B\u4EF6\u5FAA\u73AF\u4E2D\u521B\u5EFA\u4E00\u4E2AFuture\u5BF9\u8C61</span>
    <span class="token keyword">await</span> loop<span class="token punctuation">.</span>create_task<span class="token punctuation">(</span>display<span class="token punctuation">(</span>future<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># \u521B\u5EFA\u4E00\u4E2ATask\u5BF9\u8C61\u653E\u5165\u4E8B\u4EF6\u5FAA\u73AF\uFF0C\u7ED1\u5B9Adisplay\u51FD\u6570\uFF0Cdisplay\u51FD\u6570\u5185\u624B\u52A8\u7ED9future\u8D4B\u503C</span>
    data <span class="token operator">=</span> <span class="token keyword">await</span> future  <span class="token comment"># \u7B49\u5F85Future\u83B7\u53D6\u7ED3\u679C</span>
    logging<span class="token punctuation">.</span>warning<span class="token punctuation">(</span>data<span class="token punctuation">)</span>  <span class="token comment"># \u8F93\u51FA\u7ED3\u679C Hello World</span>


asyncio<span class="token punctuation">.</span>run<span class="token punctuation">(</span>main<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="\u5BF9\u8C61\u68C0\u6D4B" tabindex="-1"><a class="header-anchor" href="#\u5BF9\u8C61\u68C0\u6D4B" aria-hidden="true">#</a> \u5BF9\u8C61\u68C0\u6D4B</h4><table><thead><tr><th>\u68C0\u6D4B\u65B9\u6CD5</th><th>\u8BF4\u660E</th></tr></thead><tbody><tr><td>asyncio.iscoroutinefunction(\u534F\u7A0B\u51FD\u6570)</td><td>\u8FD4\u56DE\u662F\u5426\u662F\u534F\u7A0B\u51FD\u6570</td></tr><tr><td>asyncio.iscoroutine(\u534F\u7A0B\u5BF9\u8C61)</td><td>\u8FD4\u56DE\u662F\u5426\u662F\u534F\u7A0B\u5BF9\u8C61</td></tr><tr><td>asyncio.isfuture(future)</td><td>\u8FD4\u56DE\u662F\u5426\u662FFuture\u5BF9\u8C61</td></tr><tr><td>inspect.isawaitable(\u5BF9\u8C61)</td><td>\u8FD4\u56DE\u662F\u5426\u662F\u53EF\u7B49\u5F85\u5BF9\u8C61</td></tr></tbody></table><blockquote><p>\u534F\u7A0B\u51FD\u6570\u3001\u534F\u7A0B\u5BF9\u8C61\u4E5F\u53EF\u4EE5\u4F7F\u7528<code>inspect.iscoroutinefunction(\u534F\u7A0B\u51FD\u6570)</code>\u548C<code>inspect.iscoroutine(\u534F\u7A0B\u5BF9\u8C61)</code>\u6765\u68C0\u6D4B\uFF0C</p><p>\u4F46\u662F<code>inspect</code>\u53EA\u80FD\u68C0\u6D4B\u4F7F\u7528<code>async def</code>\u5B9A\u4E49\u7684\u534F\u7A0B\uFF0C\u5BF9\u4E8E\u4F7F\u7528\u57FA\u4E8E\u751F\u6210\u5668\u7684\u534F\u7A0B\uFF0C\u5219\u65E0\u6CD5\u68C0\u6D4B</p></blockquote><h4 id="\u5F02\u6B65\u8FED\u4EE3\u5668" tabindex="-1"><a class="header-anchor" href="#\u5F02\u6B65\u8FED\u4EE3\u5668" aria-hidden="true">#</a> \u5F02\u6B65\u8FED\u4EE3\u5668</h4>`,8),Ws=s("\u6587\u6863\uFF1A"),Hs={href:"https://docs.python.org/zh-cn/3.9/reference/datamodel.html#asynchronous-iterators",target:"_blank",rel:"noopener noreferrer"},Js=s("https://docs.python.org/zh-cn/3.9/reference/datamodel.html#asynchronous-iterators"),Gs=n("p",null,[s("\u5F02\u6B65\u8FED\u4EE3\u5668\u53EF\u4EE5\u5728\u5176 "),n("code",null,"__anext__"),s(" \u65B9\u6CD5\u4E2D\u8C03\u7528\u5F02\u6B65\u4EE3\u7801")],-1),Ys=s("\u5F02\u6B65\u8FED\u4EE3\u5668\u53EF\u5728 "),Ks={href:"https://docs.python.org/zh-cn/3.9/reference/compound_stmts.html#async-for",target:"_blank",rel:"noopener noreferrer"},Qs=n("code",null,"async for",-1),$s=s(" \u8BED\u53E5\u4E2D\u4F7F\u7528"),Zs=n("p",null,"\u5F02\u6B65\u8FED\u4EE3\u5668\u9700\u8981\u5B9A\u4E49\u5982\u4E0B\u65B9\u6CD5",-1),Xs=n("p",null,[s("\uFF081\uFF09"),n("code",null,"def __aiter__(self)")],-1),na=n("p",null,"\u5FC5\u987B\u8FD4\u56DE\u4E00\u4E2A\u53EF\u7B49\u5F85\u5BF9\u8C61\uFF0C\u4E00\u822C\u8FD4\u56DE\u81EA\u5DF1",-1),sa=n("p",null,[s("\uFF082\uFF09"),n("code",null,"async def __anext__(self)")],-1),aa=s("\u5FC5\u987B\u8FD4\u56DE\u4E00\u4E2A\u4E0B\u4E00\u6B21\u8FED\u4EE3\u7684\u7ED3\u679C\u503C\u3002 \u5F53\u8FED\u4EE3\u7ED3\u675F\u65F6\u5E94\u8BE5\u5F15\u53D1 "),ta={href:"https://docs.python.org/zh-cn/3.9/library/exceptions.html#StopAsyncIteration",target:"_blank",rel:"noopener noreferrer"},pa=n("code",null,"StopAsyncIteration",-1),oa=s(" \u9519\u8BEF"),ea=p(`<p>\u4EE3\u7801\u793A\u4F8B</p><div class="language-python ext-py"><pre class="language-python"><code><span class="token comment">#!/usr/bin/env python</span>
<span class="token comment"># -*- coding:utf-8 -*-</span>

<span class="token keyword">import</span> asyncio
<span class="token keyword">import</span> random


<span class="token keyword">class</span> <span class="token class-name">Random</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> n<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>n <span class="token operator">=</span> n
        self<span class="token punctuation">.</span>_count <span class="token operator">=</span> <span class="token number">0</span>

    <span class="token keyword">def</span> <span class="token function">__aiter__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> self

    <span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">__anext__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> self<span class="token punctuation">.</span>n <span class="token keyword">is</span> <span class="token keyword">not</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
            <span class="token keyword">if</span> self<span class="token punctuation">.</span>_count <span class="token operator">&gt;=</span> self<span class="token punctuation">.</span>n<span class="token punctuation">:</span>
                <span class="token keyword">raise</span> StopAsyncIteration
            self<span class="token punctuation">.</span>_count <span class="token operator">+=</span> <span class="token number">1</span>
        <span class="token keyword">return</span> random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span>


<span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">async</span> <span class="token keyword">for</span> x <span class="token keyword">in</span> Random<span class="token punctuation">(</span>n<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># \u5F02\u6B65\u8FED\u4EE3</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span>


asyncio<span class="token punctuation">.</span>run<span class="token punctuation">(</span>main<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="\u5F02\u6B65\u4E0A\u4E0B\u6587\u7BA1\u7406\u5668" tabindex="-1"><a class="header-anchor" href="#\u5F02\u6B65\u4E0A\u4E0B\u6587\u7BA1\u7406\u5668" aria-hidden="true">#</a> \u5F02\u6B65\u4E0A\u4E0B\u6587\u7BA1\u7406\u5668</h4>`,3),ca=s("\u6587\u6863\uFF1A"),la={href:"https://docs.python.org/zh-cn/3.9/reference/datamodel.html#asynchronous-context-managers",target:"_blank",rel:"noopener noreferrer"},ua=s("https://docs.python.org/zh-cn/3.9/reference/datamodel.html#asynchronous-context-managers"),ia=n("p",null,[s("\u5F02\u6B65\u4E0A\u4E0B\u6587\u7BA1\u7406\u5668 \u662F\u4E0A\u4E0B\u6587\u7BA1\u7406\u5668\u7684\u4E00\u79CD\uFF0C\u5B83\u80FD\u591F\u5728\u5176 "),n("code",null,"__aenter__"),s(" \u548C "),n("code",null,"__aexit__"),s(" \u65B9\u6CD5\u4E2D\u6682\u505C\u6267\u884C\u3002")],-1),ka=s("\u5F02\u6B65\u4E0A\u4E0B\u6587\u7BA1\u7406\u5668\u53EF\u5728 "),ra={href:"https://docs.python.org/zh-cn/3.9/reference/compound_stmts.html#async-with",target:"_blank",rel:"noopener noreferrer"},da=n("code",null,"async with",-1),ma=s(" \u8BED\u53E5\u4E2D\u4F7F\u7528"),ga=p(`<p>\u5F02\u6B65\u4E0A\u4E0B\u6587\u7BA1\u7406\u5668\u9700\u8981\u5B9E\u73B0\u5982\u4E0B\u65B9\u6CD5</p><p>\uFF081\uFF09<code>async def __aenter__(self)</code></p><p>\u8FD4\u56DE\u503C\u662F<code>async with xx as xx</code>\u8BED\u53E5\u4E2Das\u540E\u9762\u7684\u5BF9\u8C61\uFF0C\u5FC5\u987B\u8FD4\u56DE\u4E00\u4E2A\u53EF\u7B49\u5F85\u5BF9\u8C61</p><p>\uFF082\uFF09<code>async def __aexit__(self, exc_type, exc_val, exc_tb)</code></p><p>\u5F53<code>with</code>\u8BED\u53E5\u6267\u884C\u7ED3\u675F\u65F6\u8C03\u7528\u6B64\u51FD\u6570\uFF0C\u7528\u4E8E\u6267\u884C\u4E00\u4E9B\u8D44\u6E90\u6E05\u7406\u7684\u64CD\u4F5C</p><p>\u4EE3\u7801\u793A\u4F8B</p><div class="language-python ext-py"><pre class="language-python"><code><span class="token comment">#!/usr/bin/env python</span>
<span class="token comment"># -*- coding:utf-8 -*-</span>

<span class="token keyword">import</span> asyncio
<span class="token keyword">import</span> logging

<span class="token comment"># \u521D\u59CB\u5316\u65E5\u5FD7</span>
FORMAT <span class="token operator">=</span> <span class="token string">&#39;%(asctime)-15s\\t [%(threadName)s, %(thread)d] %(message)s&#39;</span>
logging<span class="token punctuation">.</span>basicConfig<span class="token punctuation">(</span><span class="token builtin">format</span><span class="token operator">=</span>FORMAT<span class="token punctuation">)</span>


<span class="token keyword">class</span> <span class="token class-name">ClientSession</span><span class="token punctuation">:</span>
    <span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">__aenter__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">&#39;&#39;&#39;
        async with xxx as xx
        as\u540E\u9762\u7684\u5BF9\u8C61\uFF0C\u5C31\u662F\u672C\u51FD\u6570\u7684\u8FD4\u56DE\u503C
        &#39;&#39;&#39;</span>
        <span class="token keyword">return</span> self

    <span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">__aexit__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> exc_type<span class="token punctuation">,</span> exc_val<span class="token punctuation">,</span> exc_tb<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">&#39;&#39;&#39;with\u8BED\u6CD5\u8FD0\u884C\u7ED3\u675F\u540E\u6267\u884C\u7684\u6E05\u7406\u64CD\u4F5C&#39;&#39;&#39;</span>
        self<span class="token punctuation">.</span>_close<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">get</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        logging<span class="token punctuation">.</span>warning<span class="token punctuation">(</span><span class="token string">&quot;\u6267\u884CGet\u65B9\u6CD5&quot;</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">_close</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        logging<span class="token punctuation">.</span>warning<span class="token punctuation">(</span><span class="token string">&quot;\u5173\u95EDSession&quot;</span><span class="token punctuation">)</span>


<span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">async</span> <span class="token keyword">with</span> ClientSession<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">as</span> session<span class="token punctuation">:</span>
        session<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token punctuation">)</span>

asyncio<span class="token punctuation">.</span>run<span class="token punctuation">(</span>main<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="\u63A7\u5236\u534F\u7A0B\u5E76\u53D1\u6570\u91CF" tabindex="-1"><a class="header-anchor" href="#\u63A7\u5236\u534F\u7A0B\u5E76\u53D1\u6570\u91CF" aria-hidden="true">#</a> \u63A7\u5236\u534F\u7A0B\u5E76\u53D1\u6570\u91CF</h4><p>\u53EF\u4EE5\u81EA\u5DF1\u624B\u52A8\u63A7\u5236\u4E5F\u53EF\u4EE5\u4F7F\u7528<code>asyncio.Semaphore(\u5E76\u53D1)</code>\uFF0C\u4E24\u4E2A\u4EE3\u7801\u90FD\u4E0D\u96BE\uFF0C\u4F46\u4EE5\u4E0B\u4E24\u79CD\u4EE3\u7801\u8FD8\u662F\u6709\u4E9B\u533A\u522B\u7684\uFF0C\u5047\u8BBE\u603B\u8BF7\u6C42\u6570\u4E3A10\uFF0C\u5E76\u53D1\u4E3A2\uFF0C\u90A3\u4E48\uFF1A</p><ul><li><p>\u624B\u52A8\u63A7\u5236\u7684\u662F\u7B492\u4E2A\u8BF7\u6C42\u5B8C\u5168\u5B8C\u6210\u540E\u518D\u53BB\u8BF7\u6C42\u540E2\u4E2A\uFF0C<code>Semaphore</code>\u662F2\u4E2A\u8BF7\u6C42\u4E2D\u4EFB\u610F\u4E00\u4E2A\u5B8C\u6210\u5C31\u4F1A\u518D\u542F\u52A8\u4E00\u4E2A\u65B0\u8BF7\u6C42\uFF0C</p><p><code>Semaphore</code>\u6548\u7387\u66F4\u9AD8\uFF0C\u624B\u52A8\u63A7\u7684\u5236\u63A7\u5236\u53F0\u4FE1\u606F\u66F4\u76F4\u89C2</p></li><li><p><code>Semaphore</code>\u4EE3\u7801\u91CF\u66F4\u5C0F</p></li></ul><p>\u81EA\u5DF1\u624B\u52A8\u63A7\u5236\u5E76\u53D1\u6F14\u793A</p><details class="custom-container details"><summary>\u70B9\u51FB\u67E5\u770B\u5B8C\u6574\u4EE3\u7801</summary><div class="language-python ext-py"><pre class="language-python"><code><span class="token comment">#!/usr/bin/env python</span>
<span class="token comment"># -*- coding:utf-8 -*-</span>

<span class="token keyword">import</span> asyncio
<span class="token keyword">import</span> logging
<span class="token keyword">import</span> time
<span class="token keyword">import</span> aiohttp

<span class="token comment"># \u521D\u59CB\u5316\u65E5\u5FD7</span>
FORMAT <span class="token operator">=</span> <span class="token string">&#39;%(asctime)-15s\\t [%(threadName)s, %(thread)d] %(message)s&#39;</span>
logging<span class="token punctuation">.</span>basicConfig<span class="token punctuation">(</span><span class="token builtin">format</span><span class="token operator">=</span>FORMAT<span class="token punctuation">)</span>


<span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">request_async</span><span class="token punctuation">(</span>url<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">,</span> request_total<span class="token punctuation">:</span> <span class="token builtin">int</span><span class="token punctuation">,</span> concurrent<span class="token punctuation">:</span> <span class="token builtin">int</span> <span class="token operator">=</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">&#39;&#39;&#39;
    :param url: URL
    :param request_total: \u603B\u5171\u53D1\u9001\u591A\u5C11\u6B21\u8BF7\u6C42
    :param concurrent: \u5E76\u53D1\u6570\u91CF\uFF0C\u9700\u8981 &gt; 0
    :return: None
    &#39;&#39;&#39;</span>
    start <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token comment"># \u7EDF\u8BA1HTTP\u8BF7\u6C42\u72B6\u6001\u7801\u7ED3\u679C</span>
    Counter <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token string">&quot;Success&quot;</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
        <span class="token string">&quot;Failed&quot;</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">wrapper</span><span class="token punctuation">(</span>session<span class="token punctuation">:</span> aiohttp<span class="token punctuation">.</span>ClientSession<span class="token punctuation">)</span><span class="token punctuation">:</span>
        logging<span class="token punctuation">.</span>warning<span class="token punctuation">(</span><span class="token string">&quot;Started a request&quot;</span><span class="token punctuation">)</span>
        <span class="token keyword">async</span> <span class="token keyword">with</span> session<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">)</span> <span class="token keyword">as</span> r<span class="token punctuation">:</span>
            <span class="token keyword">if</span> r<span class="token punctuation">.</span>status <span class="token operator">==</span> <span class="token number">200</span><span class="token punctuation">:</span>
                Counter<span class="token punctuation">[</span><span class="token string">&quot;Success&quot;</span><span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">1</span>
            <span class="token keyword">else</span><span class="token punctuation">:</span>
                Counter<span class="token punctuation">[</span><span class="token string">&quot;Failed&quot;</span><span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">1</span>
        logging<span class="token punctuation">.</span>warning<span class="token punctuation">(</span><span class="token string">&quot;Completed a request&quot;</span><span class="token punctuation">)</span>

    <span class="token comment"># \u53D1\u9001\u7F51\u7EDC\u8BF7\u6C42</span>
    <span class="token keyword">async</span> <span class="token keyword">with</span> aiohttp<span class="token punctuation">.</span>ClientSession<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">as</span> session<span class="token punctuation">:</span>
        <span class="token keyword">while</span> request_total <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">:</span>
            <span class="token comment"># --------------------------- \u5E76\u53D1\u63A7\u5236 --------------------------------</span>
            <span class="token comment"># \u5269\u4F59\u8BF7\u6C42\u5C0F\u4E8E\u5E76\u53D1\u6570\uFF0C\u76F4\u63A5\u8BF7\u6C42\u5373\u53EF</span>
            <span class="token keyword">if</span> request_total <span class="token operator">&lt;=</span> concurrent<span class="token punctuation">:</span>
                tasks <span class="token operator">=</span> <span class="token punctuation">[</span>wrapper<span class="token punctuation">(</span>session<span class="token punctuation">)</span> <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>request_total<span class="token punctuation">)</span><span class="token punctuation">]</span>
                request_total <span class="token operator">=</span> <span class="token number">0</span>
            <span class="token comment"># \u6309\u7167\u4E00\u5B9A\u6570\u91CF\u5E76\u53D1\u6267\u884C</span>
            <span class="token keyword">else</span><span class="token punctuation">:</span>
                tasks <span class="token operator">=</span> <span class="token punctuation">[</span>wrapper<span class="token punctuation">(</span>session<span class="token punctuation">)</span> <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>concurrent<span class="token punctuation">)</span><span class="token punctuation">]</span>
                request_total <span class="token operator">-=</span> concurrent
            <span class="token comment"># --------------------------- \u5E76\u53D1\u63A7\u5236 --------------------------------</span>
            <span class="token keyword">await</span> asyncio<span class="token punctuation">.</span>gather<span class="token punctuation">(</span><span class="token operator">*</span>tasks<span class="token punctuation">)</span>

    logging<span class="token punctuation">.</span>warning<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;Function [ request_async  ] running time: </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token builtin">int</span><span class="token punctuation">(</span>time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> start<span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string"> seconds | </span><span class="token interpolation"><span class="token punctuation">{</span>Counter<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>


asyncio<span class="token punctuation">.</span>run<span class="token punctuation">(</span>request_async<span class="token punctuation">(</span><span class="token string">&quot;https://www.qq.com&quot;</span><span class="token punctuation">,</span> request_total<span class="token operator">=</span><span class="token number">10</span> concurrent<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div></details><p>\u4F7F\u7528<code>asyncio.Semaphore</code>\u63A7\u5236\u5E76\u53D1</p><details class="custom-container details"><summary>\u70B9\u51FB\u67E5\u770B\u5B8C\u6574\u4EE3\u7801</summary><div class="language-python ext-py"><pre class="language-python"><code><span class="token comment">#!/usr/bin/env python</span>
<span class="token comment"># -*- coding:utf-8 -*-</span>

<span class="token keyword">import</span> asyncio
<span class="token keyword">import</span> logging
<span class="token keyword">import</span> time
<span class="token keyword">import</span> aiohttp

<span class="token comment"># \u521D\u59CB\u5316\u65E5\u5FD7</span>
FORMAT <span class="token operator">=</span> <span class="token string">&#39;%(asctime)-15s\\t [%(threadName)s, %(thread)d] %(message)s&#39;</span>
logging<span class="token punctuation">.</span>basicConfig<span class="token punctuation">(</span><span class="token builtin">format</span><span class="token operator">=</span>FORMAT<span class="token punctuation">)</span>


<span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">request_async</span><span class="token punctuation">(</span>url<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">,</span> request_total<span class="token punctuation">:</span> <span class="token builtin">int</span><span class="token punctuation">,</span> concurrent<span class="token punctuation">:</span> <span class="token builtin">int</span> <span class="token operator">=</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">&#39;&#39;&#39;
    :param url: URL
    :param request_total: \u603B\u5171\u53D1\u9001\u591A\u5C11\u6B21\u8BF7\u6C42
    :param concurrent: \u5E76\u53D1\u6570\u91CF\uFF0C\u9700\u8981 &gt; 0
    :return: None
    &#39;&#39;&#39;</span>
    start <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token comment"># (1)\u5E76\u53D1\u63A7\u5236, \u4E0D\u80FD\u8BBE\u7F6E\u4E3A0\uFF0C\u5426\u5219\u4F1A\u53D1\u751F\u6B7B\u9501</span>
    semphore <span class="token operator">=</span> asyncio<span class="token punctuation">.</span>Semaphore<span class="token punctuation">(</span>concurrent<span class="token punctuation">)</span>

    <span class="token comment"># \u7EDF\u8BA1HTTP\u8BF7\u6C42\u72B6\u6001\u7801\u7ED3\u679C</span>
    Counter <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token string">&quot;Success&quot;</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
        <span class="token string">&quot;Failed&quot;</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">wrapper</span><span class="token punctuation">(</span>session<span class="token punctuation">:</span> aiohttp<span class="token punctuation">.</span>ClientSession<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">async</span> <span class="token keyword">with</span> semphore<span class="token punctuation">:</span>  <span class="token comment"># (2)\u5E76\u53D1\u63A7\u5236</span>
            logging<span class="token punctuation">.</span>warning<span class="token punctuation">(</span><span class="token string">&quot;Started a request&quot;</span><span class="token punctuation">)</span>
            <span class="token keyword">async</span> <span class="token keyword">with</span> session<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">)</span> <span class="token keyword">as</span> r<span class="token punctuation">:</span>
                <span class="token keyword">if</span> r<span class="token punctuation">.</span>status <span class="token operator">==</span> <span class="token number">200</span><span class="token punctuation">:</span>
                    Counter<span class="token punctuation">[</span><span class="token string">&quot;Success&quot;</span><span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">1</span>
                <span class="token keyword">else</span><span class="token punctuation">:</span>
                    Counter<span class="token punctuation">[</span><span class="token string">&quot;Failed&quot;</span><span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">1</span>
            logging<span class="token punctuation">.</span>warning<span class="token punctuation">(</span><span class="token string">&quot;Completed a request&quot;</span><span class="token punctuation">)</span>

    <span class="token comment"># \u53D1\u9001\u7F51\u7EDC\u8BF7\u6C42</span>
    <span class="token keyword">async</span> <span class="token keyword">with</span> aiohttp<span class="token punctuation">.</span>ClientSession<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">as</span> session<span class="token punctuation">:</span>
        tasks <span class="token operator">=</span> <span class="token punctuation">[</span>wrapper<span class="token punctuation">(</span>session<span class="token punctuation">)</span> <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>request_total<span class="token punctuation">)</span><span class="token punctuation">]</span>
        <span class="token keyword">await</span> asyncio<span class="token punctuation">.</span>gather<span class="token punctuation">(</span><span class="token operator">*</span>tasks<span class="token punctuation">)</span>

    logging<span class="token punctuation">.</span>warning<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;Function [ request_async  ] running time: </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token builtin">int</span><span class="token punctuation">(</span>time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> start<span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string"> seconds | </span><span class="token interpolation"><span class="token punctuation">{</span>Counter<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>


asyncio<span class="token punctuation">.</span>run<span class="token punctuation">(</span>request_async<span class="token punctuation">(</span><span class="token string">&quot;https://www.qq.com&quot;</span><span class="token punctuation">,</span> request_total<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span> concurrent<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div></details><h4 id="\u534F\u7A0B\u5C40\u90E8\u53D8\u91CF" tabindex="-1"><a class="header-anchor" href="#\u534F\u7A0B\u5C40\u90E8\u53D8\u91CF" aria-hidden="true">#</a> \u534F\u7A0B\u5C40\u90E8\u53D8\u91CF</h4>`,15),ha=s("\u6587\u6863\uFF1A"),ya={href:"https://docs.python.org/zh-cn/3.10/library/contextvars.html",target:"_blank",rel:"noopener noreferrer"},_a=s("https://docs.python.org/zh-cn/3.10/library/contextvars.html"),ba=p(`<p><code>contextvars</code>\u4E0E<code>threading.local</code>\u7C7B\u4F3C\uFF0C\u7528\u4E8E\u5F02\u6B65\u4E2D\u7BA1\u7406\u4E0A\u4E0B\u6587</p><p>\u{1F4A1} \u63D0\u9192\uFF1A <code>asyncio</code>\u5E76\u6CA1\u6709\u63D0\u4F9B<code>local</code>\u7C7B</p><details class="custom-container details"><summary>\u70B9\u51FB\u67E5\u770B\u5B8C\u6574\u4EE3\u7801</summary><div class="language-python ext-py"><pre class="language-python"><code><span class="token comment">#!/usr/bin/env python</span>
<span class="token comment"># -*- coding:utf-8-*-</span>

<span class="token keyword">import</span> asyncio
<span class="token keyword">import</span> logging
<span class="token keyword">import</span> contextvars

<span class="token comment"># \u521D\u59CB\u5316\u65E5\u5FD7</span>
FORMAT <span class="token operator">=</span> <span class="token string">&#39;%(asctime)-15s\\t [%(threadName)s, %(thread)d] %(message)s&#39;</span>
logging<span class="token punctuation">.</span>basicConfig<span class="token punctuation">(</span><span class="token builtin">format</span><span class="token operator">=</span>FORMAT<span class="token punctuation">)</span>


<span class="token keyword">class</span> <span class="token class-name">MyClass</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> value<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>value <span class="token operator">=</span> value

    <span class="token keyword">def</span> <span class="token function">set</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>value <span class="token operator">=</span> value

    <span class="token keyword">def</span> <span class="token function">get</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> self<span class="token punctuation">.</span>value


<span class="token comment"># \u5168\u5C40\u53D8\u91CF</span>
data1 <span class="token operator">=</span> MyClass<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># \u5168\u5C40\u53D8\u91CF(\u534F\u7A0B\u5C40\u90E8\u53D8\u91CF)</span>
data2 <span class="token operator">=</span> contextvars<span class="token punctuation">.</span>ContextVar<span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span>


<span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">task1</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">:</span>
    data1<span class="token punctuation">.</span><span class="token builtin">set</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span>
    <span class="token keyword">await</span> asyncio<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">0.1</span><span class="token punctuation">)</span>
    logging<span class="token punctuation">.</span>warning<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;Task1-</span><span class="token interpolation"><span class="token punctuation">{</span>n<span class="token punctuation">}</span></span><span class="token string">: </span><span class="token interpolation"><span class="token punctuation">{</span>data1<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
    <span class="token comment"># assert n == data.get()</span>


<span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">task2</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">:</span>
    data2<span class="token punctuation">.</span><span class="token builtin">set</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span>
    <span class="token keyword">await</span> asyncio<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">0.1</span><span class="token punctuation">)</span>
    logging<span class="token punctuation">.</span>warning<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;Task2-</span><span class="token interpolation"><span class="token punctuation">{</span>n<span class="token punctuation">}</span></span><span class="token string">: </span><span class="token interpolation"><span class="token punctuation">{</span>data2<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
    <span class="token comment"># assert n == data.get()</span>


<span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># \u6D4B\u8BD51</span>
    logging<span class="token punctuation">.</span>warning<span class="token punctuation">(</span><span class="token string">&quot;\u6D4B\u8BD51\uFF1A\u534F\u7A0B\u5E76\u53D1\u4FEE\u6539\u5168\u5C40\u53D8\u91CF&quot;</span><span class="token punctuation">)</span>
    tasks1 <span class="token operator">=</span> <span class="token punctuation">[</span>task1<span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token keyword">for</span> x <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
    <span class="token keyword">await</span> asyncio<span class="token punctuation">.</span>gather<span class="token punctuation">(</span><span class="token operator">*</span>tasks1<span class="token punctuation">)</span>
    logging<span class="token punctuation">.</span>warning<span class="token punctuation">(</span><span class="token string">&quot;-&quot;</span> <span class="token operator">*</span> <span class="token number">50</span><span class="token punctuation">)</span>

    <span class="token comment"># \u6D4B\u8BD52</span>
    logging<span class="token punctuation">.</span>warning<span class="token punctuation">(</span><span class="token string">&quot;\u6D4B\u8BD52\uFF1A\u534F\u7A0B\u5C40\u90E8\u53D8\u91CF&quot;</span><span class="token punctuation">)</span>
    tasks2 <span class="token operator">=</span> <span class="token punctuation">[</span>task2<span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token keyword">for</span> x <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
    <span class="token keyword">await</span> asyncio<span class="token punctuation">.</span>gather<span class="token punctuation">(</span><span class="token operator">*</span>tasks2<span class="token punctuation">)</span>


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">&#39;__main__&#39;</span><span class="token punctuation">:</span>
    asyncio<span class="token punctuation">.</span>run<span class="token punctuation">(</span>main<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div></details><p>\u8F93\u51FA\u7ED3\u679C</p><div class="language-bash ext-sh"><pre class="language-bash"><code><span class="token number">2022</span>-04-07 <span class="token number">11</span>:45:22,185	 <span class="token punctuation">[</span>MainThread, <span class="token number">360196</span><span class="token punctuation">]</span> \u6D4B\u8BD51\uFF1A\u534F\u7A0B\u5E76\u53D1\u4FEE\u6539\u5168\u5C40\u53D8\u91CF
<span class="token number">2022</span>-04-07 <span class="token number">11</span>:45:22,294	 <span class="token punctuation">[</span>MainThread, <span class="token number">360196</span><span class="token punctuation">]</span> Task1-0: <span class="token number">9</span>
<span class="token number">2022</span>-04-07 <span class="token number">11</span>:45:22,294	 <span class="token punctuation">[</span>MainThread, <span class="token number">360196</span><span class="token punctuation">]</span> Task1-2: <span class="token number">9</span>
<span class="token number">2022</span>-04-07 <span class="token number">11</span>:45:22,294	 <span class="token punctuation">[</span>MainThread, <span class="token number">360196</span><span class="token punctuation">]</span> Task1-6: <span class="token number">9</span>
<span class="token number">2022</span>-04-07 <span class="token number">11</span>:45:22,294	 <span class="token punctuation">[</span>MainThread, <span class="token number">360196</span><span class="token punctuation">]</span> Task1-9: <span class="token number">9</span>
<span class="token number">2022</span>-04-07 <span class="token number">11</span>:45:22,294	 <span class="token punctuation">[</span>MainThread, <span class="token number">360196</span><span class="token punctuation">]</span> Task1-8: <span class="token number">9</span>
<span class="token number">2022</span>-04-07 <span class="token number">11</span>:45:22,294	 <span class="token punctuation">[</span>MainThread, <span class="token number">360196</span><span class="token punctuation">]</span> Task1-5: <span class="token number">9</span>
<span class="token number">2022</span>-04-07 <span class="token number">11</span>:45:22,294	 <span class="token punctuation">[</span>MainThread, <span class="token number">360196</span><span class="token punctuation">]</span> Task1-7: <span class="token number">9</span>
<span class="token number">2022</span>-04-07 <span class="token number">11</span>:45:22,294	 <span class="token punctuation">[</span>MainThread, <span class="token number">360196</span><span class="token punctuation">]</span> Task1-4: <span class="token number">9</span>
<span class="token number">2022</span>-04-07 <span class="token number">11</span>:45:22,294	 <span class="token punctuation">[</span>MainThread, <span class="token number">360196</span><span class="token punctuation">]</span> Task1-1: <span class="token number">9</span>
<span class="token number">2022</span>-04-07 <span class="token number">11</span>:45:22,294	 <span class="token punctuation">[</span>MainThread, <span class="token number">360196</span><span class="token punctuation">]</span> Task1-3: <span class="token number">9</span>
<span class="token number">2022</span>-04-07 <span class="token number">11</span>:45:22,294	 <span class="token punctuation">[</span>MainThread, <span class="token number">360196</span><span class="token punctuation">]</span> --------------------------------------------------
<span class="token number">2022</span>-04-07 <span class="token number">11</span>:45:22,294	 <span class="token punctuation">[</span>MainThread, <span class="token number">360196</span><span class="token punctuation">]</span> \u6D4B\u8BD52\uFF1A\u534F\u7A0B\u5C40\u90E8\u53D8\u91CF
<span class="token number">2022</span>-04-07 <span class="token number">11</span>:45:22,403	 <span class="token punctuation">[</span>MainThread, <span class="token number">360196</span><span class="token punctuation">]</span> Task2-0: <span class="token number">0</span>
<span class="token number">2022</span>-04-07 <span class="token number">11</span>:45:22,403	 <span class="token punctuation">[</span>MainThread, <span class="token number">360196</span><span class="token punctuation">]</span> Task2-2: <span class="token number">2</span>
<span class="token number">2022</span>-04-07 <span class="token number">11</span>:45:22,403	 <span class="token punctuation">[</span>MainThread, <span class="token number">360196</span><span class="token punctuation">]</span> Task2-6: <span class="token number">6</span>
<span class="token number">2022</span>-04-07 <span class="token number">11</span>:45:22,403	 <span class="token punctuation">[</span>MainThread, <span class="token number">360196</span><span class="token punctuation">]</span> Task2-9: <span class="token number">9</span>
<span class="token number">2022</span>-04-07 <span class="token number">11</span>:45:22,403	 <span class="token punctuation">[</span>MainThread, <span class="token number">360196</span><span class="token punctuation">]</span> Task2-8: <span class="token number">8</span>
<span class="token number">2022</span>-04-07 <span class="token number">11</span>:45:22,403	 <span class="token punctuation">[</span>MainThread, <span class="token number">360196</span><span class="token punctuation">]</span> Task2-5: <span class="token number">5</span>
<span class="token number">2022</span>-04-07 <span class="token number">11</span>:45:22,403	 <span class="token punctuation">[</span>MainThread, <span class="token number">360196</span><span class="token punctuation">]</span> Task2-7: <span class="token number">7</span>
<span class="token number">2022</span>-04-07 <span class="token number">11</span>:45:22,403	 <span class="token punctuation">[</span>MainThread, <span class="token number">360196</span><span class="token punctuation">]</span> Task2-4: <span class="token number">4</span>
<span class="token number">2022</span>-04-07 <span class="token number">11</span>:45:22,403	 <span class="token punctuation">[</span>MainThread, <span class="token number">360196</span><span class="token punctuation">]</span> Task2-1: <span class="token number">1</span>
<span class="token number">2022</span>-04-07 <span class="token number">11</span>:45:22,403	 <span class="token punctuation">[</span>MainThread, <span class="token number">360196</span><span class="token punctuation">]</span> Task2-3: <span class="token number">3</span>
</code></pre></div><h2 id="-4" tabindex="-1"><a class="header-anchor" href="#-4" aria-hidden="true">#</a></h2><h2 id="\u516D\u3001\u9762\u5411\u5BF9\u8C61" tabindex="-1"><a class="header-anchor" href="#\u516D\u3001\u9762\u5411\u5BF9\u8C61" aria-hidden="true">#</a> \u516D\u3001\u9762\u5411\u5BF9\u8C61</h2><h3 id="\u88C5\u9970\u5668-2" tabindex="-1"><a class="header-anchor" href="#\u88C5\u9970\u5668-2" aria-hidden="true">#</a> \u88C5\u9970\u5668</h3><p>\uFF081\uFF09\u5C5E\u6027\u88C5\u9970\u5668 <code>@property</code></p><ul><li>\u53EF\u4EE5\u5C06\u4E00\u4E2A\u65B9\u6CD5\u53EF\u4EE5\u5F53\u505A\u5C5E\u6027\u6765\u8BBF\u95EE\uFF0C\u8BBF\u95EE\u65F6\u4E0D\u9700\u8981\u52A0()</li><li>\u540C\u65F6\u8BE5\u5C5E\u6027\u4E0D\u5141\u8BB8\u76F4\u63A5\u4FEE\u6539\uFF0C\u5982\u679C\u9700\u8981\u4FEE\u6539\u548C\u5220\u9664\u529F\u80FD\uFF0C\u9700\u8981\u7F16\u5199<code>@\u51FD\u6570\u540D.setter</code>\u548C<code>@\u51FD\u6570\u540D.deleter</code>\u88C5\u9970\u7684\u540C\u540D\u51FD\u6570</li><li>\u901A\u8FC7\u9ED1\u9B54\u6CD5\u3010._\u7C7B\u540D__\u5C5E\u6027\u540D\u3011\u53EF\u4EE5\u4FEE\u6539\u5C5E\u6027\u503C\uFF0C\u4F46\u662F\u5F3A\u70C8\u4E0D\u5EFA\u8BAE\u4F7F\u7528\u8FD9\u79CD\u65B9\u6CD5</li></ul><p>\uFF082\uFF09\u7C7B\u65B9\u6CD5\u88C5\u9970\u5668 <code>@classmethod</code></p><p>\u88AB\u4FEE\u9970\u7684\u51FD\u6570\u7B2C\u4E00\u4E2A\u53C2\u6570\u4E0D\u518D\u662F\u5B9E\u4F8B\u5BF9\u8C61\u800C\u662F \u7C7B\u5BF9\u8C61</p><p>\uFF083\uFF09\u9759\u6001\u65B9\u6CD5\u88C5\u9970\u5668 <code>@staticmethod</code></p><p>\u4FEE\u9970\u7684\u51FD\u6570\u7B2C\u4E00\u4E2A\u53C2\u6570\u53EF\u4EE5\u4E0D\u7528\u4F20\uFF0C\u88C5\u9970\u5668\u4F1A\u81EA\u52A8\u7ED9\u6211\u4EEC\u4F20\u8FDB\u53BB</p><p>\u4EE3\u7801\u793A\u4F8B</p><details class="custom-container details"><summary>\u70B9\u51FB\u67E5\u770B\u5B8C\u6574\u4EE3\u7801</summary><div class="language-python ext-py"><pre class="language-python"><code><span class="token comment">#!/usr/bin/env python</span>
<span class="token comment"># -*- coding:utf-8-*-</span>

<span class="token keyword">import</span> logging

<span class="token comment"># \u521D\u59CB\u5316\u65E5\u5FD7</span>
FORMAT <span class="token operator">=</span> <span class="token string">&#39;%(asctime)-15s\\t [%(threadName)s, %(thread)d] %(message)s&#39;</span>
logging<span class="token punctuation">.</span>basicConfig<span class="token punctuation">(</span><span class="token builtin">format</span><span class="token operator">=</span>FORMAT<span class="token punctuation">)</span>


<span class="token keyword">class</span> <span class="token class-name">Person</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>__name <span class="token operator">=</span> name

    <span class="token decorator annotation punctuation">@property</span>
    <span class="token keyword">def</span> <span class="token function">name</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        logging<span class="token punctuation">.</span>warning<span class="token punctuation">(</span><span class="token string">&quot;@property&quot;</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> self<span class="token punctuation">.</span>__name

    <span class="token decorator annotation punctuation">@name<span class="token punctuation">.</span>setter</span>
    <span class="token keyword">def</span> <span class="token function">name</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">:</span>
        logging<span class="token punctuation">.</span>warning<span class="token punctuation">(</span><span class="token string">&quot;@name.setter&quot;</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>__name <span class="token operator">=</span> name

    <span class="token decorator annotation punctuation">@name<span class="token punctuation">.</span>deleter</span>
    <span class="token keyword">def</span> <span class="token function">name</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        logging<span class="token punctuation">.</span>warning<span class="token punctuation">(</span><span class="token string">&quot;@name.deleter&quot;</span><span class="token punctuation">)</span>
        <span class="token keyword">del</span> self<span class="token punctuation">.</span>__name


logging<span class="token punctuation">.</span>warning<span class="token punctuation">(</span><span class="token string">&quot;\u5C5E\u6027\u8BBF\u95EE&quot;</span><span class="token punctuation">)</span>
bob <span class="token operator">=</span> Person<span class="token punctuation">(</span><span class="token string">&quot;bob&quot;</span><span class="token punctuation">)</span>
logging<span class="token punctuation">.</span>warning<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;</span><span class="token interpolation"><span class="token punctuation">{</span>bob<span class="token punctuation">.</span>name<span class="token punctuation">}</span></span><span class="token string">\\n&quot;</span></span><span class="token punctuation">)</span>

logging<span class="token punctuation">.</span>warning<span class="token punctuation">(</span><span class="token string">&quot;\u5C5E\u6027\u8BBE\u7F6E&quot;</span><span class="token punctuation">)</span>
bob<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">&quot;Bob&quot;</span>
logging<span class="token punctuation">.</span>warning<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;</span><span class="token interpolation"><span class="token punctuation">{</span>bob<span class="token punctuation">.</span>name<span class="token punctuation">}</span></span><span class="token string">\\n&quot;</span></span><span class="token punctuation">)</span>

logging<span class="token punctuation">.</span>warning<span class="token punctuation">(</span><span class="token string">&quot;\u9ED1\u9B54\u6CD5\u8BBE\u7F6E\u5C5E\u6027&quot;</span><span class="token punctuation">)</span>
bob<span class="token punctuation">.</span>_Person__name <span class="token operator">=</span> <span class="token string">&quot;abc&quot;</span>
logging<span class="token punctuation">.</span>warning<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;</span><span class="token interpolation"><span class="token punctuation">{</span>bob<span class="token punctuation">.</span>name<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
</code></pre></div></details><h3 id="\u7EE7\u627F" tabindex="-1"><a class="header-anchor" href="#\u7EE7\u627F" aria-hidden="true">#</a> \u7EE7\u627F</h3><p>Python\u652F\u6301\u5355\u7EE7\u627F\u548C\u591A\u7EE7\u627F</p><h4 id="\u54EA\u4E9B\u5C5E\u6027\u4E0D\u4F1A\u7EE7\u627F" tabindex="-1"><a class="header-anchor" href="#\u54EA\u4E9B\u5C5E\u6027\u4E0D\u4F1A\u7EE7\u627F" aria-hidden="true">#</a> \u54EA\u4E9B\u5C5E\u6027\u4E0D\u4F1A\u7EE7\u627F</h4><p>\u7236\u7C7B\u4E2D\u7684<strong>\u79C1\u6709\u5C5E\u6027</strong>\u5728\u5B50\u7C7B\u4E2D\u4E0D\u80FD\u76F4\u63A5\u8BBF\u95EE\uFF0C\u4F46\u53EF\u4EE5\u901A\u8FC7**._\u7236\u7C7B__\u5C5E\u6027**\u6765\u8BBF\u95EE</p><details class="custom-container details"><summary>\u70B9\u51FB\u67E5\u770B\u5B8C\u6574\u4EE3\u7801</summary><div class="language-python ext-py"><pre class="language-python"><code><span class="token comment">#!/usr/bin/env python</span>
<span class="token comment"># -*- coding:utf-8-*-</span>

<span class="token keyword">class</span> <span class="token class-name">A</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>__money <span class="token operator">=</span> <span class="token number">1000</span>
        self<span class="token punctuation">.</span>_name <span class="token operator">=</span> <span class="token string">&quot;\u6211\u53EB\u5927A&quot;</span>


<span class="token keyword">class</span> <span class="token class-name">B</span><span class="token punctuation">(</span>A<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">getMoney</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># \u76F4\u63A5\u8BBF\u95EE\u662F\u8BBF\u95EE\u4E0D\u5230\u7684\uFF0C\u4F1A\u62A5\u9519\uFF0C\u4E5F\u5C31\u662F\u6CA1\u6709\u7EE7\u627F\u4E0B\u6765</span>
        <span class="token keyword">return</span> self<span class="token punctuation">.</span>__money

    <span class="token keyword">def</span> <span class="token function">getMoney2</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>__dict__<span class="token punctuation">)</span>  <span class="token comment"># {&#39;_A__money&#39;: 1000, &#39;_name&#39;: &#39;\u6211\u53EB\u5927A&#39;}</span>

        <span class="token comment"># return self._A__money  # \u5199\u6CD51, Pycharm\u4F1A\u6709\u9EC4\u8272\u8B66\u544A</span>
        <span class="token keyword">return</span> self<span class="token punctuation">.</span>__dict__<span class="token punctuation">[</span><span class="token string">&quot;_A__money&quot;</span><span class="token punctuation">]</span>  <span class="token comment"># \u5199\u6CD52</span>


<span class="token keyword">print</span><span class="token punctuation">(</span>B<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>getMoney2<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div></details><p>\u8F93\u51FA\u7ED3\u679C</p><div class="language-bash ext-sh"><pre class="language-bash"><code><span class="token punctuation">{</span><span class="token string">&#39;_A__money&#39;</span><span class="token builtin class-name">:</span> <span class="token number">1000</span>, <span class="token string">&#39;_name&#39;</span><span class="token builtin class-name">:</span> <span class="token string">&#39;\u6211\u53EB\u5927A&#39;</span><span class="token punctuation">}</span>
<span class="token number">1000</span>
</code></pre></div><h4 id="\u7C7B\u4E0E\u7C7B\u4E4B\u95F4\u7684\u5C5E\u6027\u67E5\u627E\u987A\u5E8F" tabindex="-1"><a class="header-anchor" href="#\u7C7B\u4E0E\u7C7B\u4E4B\u95F4\u7684\u5C5E\u6027\u67E5\u627E\u987A\u5E8F" aria-hidden="true">#</a> \u7C7B\u4E0E\u7C7B\u4E4B\u95F4\u7684\u5C5E\u6027\u67E5\u627E\u987A\u5E8F</h4><p>\u6309\u7167\u3010\u6DF1\u5EA6\u4F18\u5148\u3011\u7684\u641C\u7D22\u987A\u5E8F\uFF0C\u4F7F\u7528\u7684\u662FC3\u7B97\u6CD5</p><p>\u4F7F\u7528<code>\u7C7B\u5BF9\u8C61.__mro__</code> \u6216 <code>\u7C7B\u5BF9\u8C61.mro()\u65B9\u6CD5</code> \u53EF\u4EE5\u663E\u793A\u67E5\u627E\u987A\u5E8F</p><details class="custom-container details"><summary>\u70B9\u51FB\u67E5\u770B\u5B8C\u6574\u4EE3\u7801</summary><div class="language-python ext-py"><pre class="language-python"><code><span class="token comment">#!/usr/bin/env python</span>
<span class="token comment"># -*- coding:utf-8-*-</span>

<span class="token keyword">class</span> <span class="token class-name">A</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Class A.__init__ called&quot;</span><span class="token punctuation">)</span>


<span class="token keyword">class</span> <span class="token class-name">B</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Class B.__init__ called&quot;</span><span class="token punctuation">)</span>


<span class="token keyword">class</span> <span class="token class-name">C</span><span class="token punctuation">(</span>A<span class="token punctuation">,</span> B<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Class C.__init__ called&quot;</span><span class="token punctuation">)</span>
        <span class="token builtin">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token punctuation">)</span>


c <span class="token operator">=</span> C<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>C<span class="token punctuation">.</span>mro<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># \u8FD4\u56DE\u5217\u8868</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>C<span class="token punctuation">.</span>__mro__<span class="token punctuation">)</span>  <span class="token comment"># \u8FD4\u56DE\u5143\u7EC4</span>
</code></pre></div></details><p>\u8F93\u51FA\u7ED3\u679C</p><div class="language-bash ext-sh"><pre class="language-bash"><code>Class C.__init__ called
Class A.__init__ called
<span class="token punctuation">[</span><span class="token operator">&lt;</span>class <span class="token string">&#39;__main__.C&#39;</span><span class="token operator">&gt;</span>, <span class="token operator">&lt;</span>class <span class="token string">&#39;__main__.A&#39;</span><span class="token operator">&gt;</span>, <span class="token operator">&lt;</span>class <span class="token string">&#39;__main__.B&#39;</span><span class="token operator">&gt;</span>, <span class="token operator">&lt;</span>class <span class="token string">&#39;object&#39;</span><span class="token operator">&gt;</span><span class="token punctuation">]</span>
<span class="token punctuation">(</span><span class="token operator">&lt;</span>class <span class="token string">&#39;__main__.C&#39;</span><span class="token operator">&gt;</span>, <span class="token operator">&lt;</span>class <span class="token string">&#39;__main__.A&#39;</span><span class="token operator">&gt;</span>, <span class="token operator">&lt;</span>class <span class="token string">&#39;__main__.B&#39;</span><span class="token operator">&gt;</span>, <span class="token operator">&lt;</span>class <span class="token string">&#39;object&#39;</span><span class="token operator">&gt;</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="super\u89E3\u51B3\u591A\u7EE7\u627F\u4E0B\u7684\u95EE\u9898" tabindex="-1"><a class="header-anchor" href="#super\u89E3\u51B3\u591A\u7EE7\u627F\u4E0B\u7684\u95EE\u9898" aria-hidden="true">#</a> super\u89E3\u51B3\u591A\u7EE7\u627F\u4E0B\u7684\u95EE\u9898</h4><p>\u82E5\u8981\u8C03\u7528\u7236\u7C7B\u65B9\u6CD5\uFF0C\u5F3A\u70C8\u5EFA\u8BAE\u4F7F\u7528<code>super()</code>\u800C\u4E0D\u662F\u76F4\u63A5\u5199\u7236\u7C7B\u540D\uFF0C\u56E0\u4E3A\u5728\u591A\u7EE7\u627F\u4E2D\u8FD9\u4F1A\u6709\u95EE\u9898</p><p>\u9519\u8BEF\u4EE3\u7801\u793A\u4F8B</p><details class="custom-container details"><summary>\u70B9\u51FB\u67E5\u770B\u5B8C\u6574\u4EE3\u7801</summary><div class="language-python ext-py"><pre class="language-python"><code><span class="token comment">#!/usr/bin/env python</span>
<span class="token comment"># -*- coding:utf-8-*-</span>

<span class="token keyword">class</span> <span class="token class-name">Base</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Class Base.__init__ called&quot;</span><span class="token punctuation">)</span>


<span class="token keyword">class</span> <span class="token class-name">A</span><span class="token punctuation">(</span>Base<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        Base<span class="token punctuation">.</span>__init__<span class="token punctuation">(</span>self<span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Class A.__init__ called&quot;</span><span class="token punctuation">)</span>


<span class="token keyword">class</span> <span class="token class-name">B</span><span class="token punctuation">(</span>Base<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        Base<span class="token punctuation">.</span>__init__<span class="token punctuation">(</span>self<span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Class B.__init__ called&quot;</span><span class="token punctuation">)</span>


<span class="token keyword">class</span> <span class="token class-name">C</span><span class="token punctuation">(</span>A<span class="token punctuation">,</span> B<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        A<span class="token punctuation">.</span>__init__<span class="token punctuation">(</span>self<span class="token punctuation">)</span>
        B<span class="token punctuation">.</span>__init__<span class="token punctuation">(</span>self<span class="token punctuation">)</span>	<span class="token comment"># \u5E76\u4E14\uFF0CA\u548CB\u7684\u8C03\u7528\u987A\u5E8F\u4E5F\u6CA1\u6709\u9075\u5FAAMRO\u987A\u5E8F\uFF0C\u4E0D\u591F\u89C4\u8303</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Class C.__init__ called&quot;</span><span class="token punctuation">)</span>


c <span class="token operator">=</span> C<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># \u8F93\u51FA\u7ED3\u679C</span>
<span class="token comment"># Class Base.__init__ called</span>
<span class="token comment"># Class A.__init__ called</span>
<span class="token comment"># Class Base.__init__ called</span>
<span class="token comment"># Class B.__init__ called</span>
<span class="token comment"># Class C.__init__ called</span>

<span class="token comment"># \u53EF\u4EE5\u770B\u5230Base.__init__\u8C03\u7528\u4E862\u6B21\uFF01</span>
</code></pre></div></details><p>\u6B63\u786E\u4EE3\u7801\u793A\u4F8B</p><details class="custom-container details"><summary>\u70B9\u51FB\u67E5\u770B\u5B8C\u6574\u4EE3\u7801</summary><div class="language-python ext-py"><pre class="language-python"><code><span class="token comment">#!/usr/bin/env python</span>
<span class="token comment"># -*- coding:utf-8-*-</span>

<span class="token keyword">class</span> <span class="token class-name">Base</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Class Base.__init__ called&quot;</span><span class="token punctuation">)</span>


<span class="token keyword">class</span> <span class="token class-name">A</span><span class="token punctuation">(</span>Base<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token builtin">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Class A.__init__ called&quot;</span><span class="token punctuation">)</span>


<span class="token keyword">class</span> <span class="token class-name">B</span><span class="token punctuation">(</span>Base<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token builtin">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Class B.__init__ called&quot;</span><span class="token punctuation">)</span>


<span class="token keyword">class</span> <span class="token class-name">C</span><span class="token punctuation">(</span>A<span class="token punctuation">,</span> B<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token builtin">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Class C.__init__ called&quot;</span><span class="token punctuation">)</span>


c <span class="token operator">=</span> C<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># \u8F93\u51FA\u7ED3\u679C</span>
<span class="token comment"># Class Base.__init__ called</span>
<span class="token comment"># Class B.__init__ called</span>
<span class="token comment"># Class A.__init__ called</span>
<span class="token comment"># Class C.__init__ called</span>

<span class="token comment"># \u53EF\u4EE5\u770B\u5230Base.__init__\u8C03\u7528\u4E861\u6B21</span>
</code></pre></div></details><h4 id="\u7EE7\u627F\u76F8\u5173\u9B54\u6CD5\u65B9\u6CD5" tabindex="-1"><a class="header-anchor" href="#\u7EE7\u627F\u76F8\u5173\u9B54\u6CD5\u65B9\u6CD5" aria-hidden="true">#</a> \u7EE7\u627F\u76F8\u5173\u9B54\u6CD5\u65B9\u6CD5</h4><table><thead><tr><th>\u65B9\u6CD5</th><th>\u8BF4\u660E</th></tr></thead><tbody><tr><td><code>\u7C7B\u5BF9\u8C61.__base__</code></td><td>\u7C7B\u5BF9\u8C61\u7684\u7236\u7C7B\u5BF9\u8C61\uFF0C\u591A\u7EE7\u627F\u60C5\u51B5\u4E0B\u4E5F\u53EA\u663E\u793A\u4E00\u4E2A\uFF08\u6CE8\u610F\uFF1A\u5B9E\u4F8B\u5BF9\u8C61\u6CA1\u6709\u8FD9\u4E2A\u5C5E\u6027\uFF09</td></tr><tr><td><code>\u7C7B\u5BF9\u8C61.__bases__</code></td><td>\u7C7B\u5BF9\u8C61\u7684\u7236\u7C7B\u5BF9\u8C61\u5143\u7956\uFF0C\u591A\u7EE7\u627F\u60C5\u51B5\u4E0B\u663E\u793A\u6240\u6709\u7236\u7C7B\uFF08\u6CE8\u610F\uFF1A\u5B9E\u4F8B\u5BF9\u8C61\u6CA1\u6709\u8FD9\u4E2A\u5C5E\u6027\uFF09</td></tr><tr><td><code>\u7C7B\u5BF9\u8C61.__subclasses__</code></td><td>\u7C7B\u5BF9\u8C61\u7684\u5B50\u7C7B\u5BF9\u8C61\u5217\u8868\uFF0C\u4E0E<code>__bases__</code>\u76F8\u5BF9\u5E94\uFF08\u6CE8\u610F\uFF1A\u5B9E\u4F8B\u5BF9\u8C61\u6CA1\u6709\u8FD9\u4E2A\u5C5E\u6027\uFF09</td></tr><tr><td><code>\u7C7B\u5BF9\u8C61.__mro__</code> \u6216 <code>\u7C7B\u5BF9\u8C61.mro()</code></td><td>\u7C7B\u4E0E\u7C7B\u4E4B\u95F4\u7684\u5C5E\u6027\u67E5\u627E\u987A\u5E8F\uFF08\u524D\u9762\u5DF2\u7ECF\u8BB2\u8FC7\uFF09\uFF08\u6CE8\u610F\uFF1A\u5B9E\u4F8B\u5BF9\u8C61\u6CA1\u6709\u8FD9\u4E2A\u5C5E\u6027\uFF09</td></tr><tr><td><code>\u5B9E\u4F8B\u5BF9\u8C61.__class</code>__</td><td>\u5B9E\u4F8B\u6240\u5C5E\u7684\u7C7B\u5BF9\u8C61\uFF08\u672C\u7AE0\u6269\u5C55\u5185\u5BB9\uFF0C\u4E0E\u7EE7\u627F\u6CA1\u6709\u5173\u7CFB\uFF0C\u5355\u7EAF\u662F\u8BB0\u5F55\u4E00\u4E0B\uFF09</td></tr></tbody></table><h3 id="\u53CD\u5C04" tabindex="-1"><a class="header-anchor" href="#\u53CD\u5C04" aria-hidden="true">#</a> \u53CD\u5C04</h3><p>\u53CD\u5C04\u5C31\u662F\u901A\u8FC7<strong>\u5B57\u7B26\u4E32</strong>\u6620\u5C04\u51FA\u5BF9\u8C61\u7684\u65B9\u6CD5</p><p>\u5177\u6709\u53CD\u5C04\u80FD\u529B\u7684\u51FD\u6570\u5305\u62EC<code>type()</code>\u3001<code>isinstance()</code>\u3001<code>callable()</code>\u3001<code>dir</code>\u3001<code>getattr()</code>\u7B49</p><p>\u8FD9\u91CC\u4E3B\u8981\u8BF4\u4E00\u4E0B<code>getattr</code>\u7CFB\u5217\u7684\u51E0\u4E2A\u51FD\u6570</p><table><thead><tr><th>\u51FD\u6570</th><th>\u8BF4\u660E</th></tr></thead><tbody><tr><td>getattr(object, name, [default])</td><td>\u83B7\u53D6object.name\u5C5E\u6027\u503C\uFF0C\u5982\u679C\u5C5E\u6027\u4E0D\u5B58\u5728\u4E14\u672A\u8BBE\u7F6E<code>default</code>\uFF0C\u5219\u629B\u51FA<code>AttributeError</code>\uFF0Cname\u5FC5\u987B\u4E3A\u5B57\u7B26\u4E32</td></tr><tr><td>setattr(object, name, value)</td><td>\u8BBE\u7F6Eobject.name\u5C5E\u6027\u503C\uFF0C\u5982\u679C\u5B58\u5728\u5219\u8986\u76D6\u5426\u5219\u65B0\u589E\uFF0Cname\u5FC5\u987B\u4E3A\u5B57\u7B26\u4E32</td></tr><tr><td>hasattr(object, name)</td><td>\u5224\u65AD\u662F\u5426\u6709object.name\u5C5E\u6027\uFF0Cname\u5FC5\u987B\u4E3A\u5B57\u7B26\u4E32</td></tr><tr><td>delattr(object, name)</td><td>\u5220\u9664object.name\u5C5E\u6027\uFF0C\u5982\u679C\u5C5E\u6027\u4E0D\u5B58\u5728\u629B\u51FA<code>AttributeError</code>\uFF0Cname\u5FC5\u987B\u4E3A\u5B57\u7B26\u4E32</td></tr></tbody></table><p>\u4EE3\u7801\u793A\u4F8B</p><details class="custom-container details"><summary>\u70B9\u51FB\u67E5\u770B\u5B8C\u6574\u4EE3\u7801</summary><div class="language-python ext-py"><pre class="language-python"><code><span class="token comment">#!/usr/bin/env python</span>
<span class="token comment"># -*- coding:utf-8-*-</span>

<span class="token keyword">class</span> <span class="token class-name">Point</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>x <span class="token operator">=</span> x
        self<span class="token punctuation">.</span>y <span class="token operator">=</span> y


<span class="token keyword">def</span> <span class="token function">show</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>self<span class="token punctuation">.</span>x<span class="token punctuation">,</span> self<span class="token punctuation">.</span>y<span class="token punctuation">)</span>


<span class="token comment"># (1) \u76F4\u63A5\u7ED9\u7C7B\u589E\u52A0\u65B9\u6CD5\uFF0C\u53EF\u4EE5\u6B63\u5E38\u8C03\u7528\u8BE5\u65B9\u6CD5</span>
Point<span class="token punctuation">.</span>show <span class="token operator">=</span> show
p <span class="token operator">=</span> Point<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>p<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># (1, 2)</span>

<span class="token comment"># (2) \u4F7F\u7528setattr\u7ED9\u7C7B\u589E\u52A0\u65B9\u6CD5\uFF0C\uFF0C\u53EF\u4EE5\u6B63\u5E38\u8C03\u7528\u8BE5\u65B9\u6CD5</span>
<span class="token builtin">setattr</span><span class="token punctuation">(</span>Point<span class="token punctuation">,</span> <span class="token string">&quot;show&quot;</span><span class="token punctuation">,</span> show<span class="token punctuation">)</span>
p <span class="token operator">=</span> Point<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>p<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>     <span class="token comment"># (3, 4)</span>
<span class="token comment">#</span>
<span class="token comment"># # (3) \u7ED9\u5B9E\u4F8B\u589E\u52A0\u65B9\u6CD5\uFF0C\u9700\u8981\u5C06\u5B9E\u4F8B\u4F20\u5165\u5230show\u65B9\u6CD5\u4E2D</span>
p <span class="token operator">=</span> Point<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span>
<span class="token builtin">setattr</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span> <span class="token string">&quot;show&quot;</span><span class="token punctuation">,</span> show<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>p<span class="token punctuation">.</span>show<span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token comment"># \u8FD9\u91CC\u9700\u8981\u5C06\u5B9E\u4F8B\u4F20\u5165\u5230show\u65B9\u6CD5\u4E2D</span>

<span class="token comment"># (4) \u7ED9\u5B9E\u4F8B\u589E\u52A0\u65B9\u6CD5\uFF0C\u9700\u8981\u5C06\u5B9E\u4F8B\u4F20\u5165\u5230show\u65B9\u6CD5\u4E2D</span>
p <span class="token operator">=</span> Point<span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span>
p<span class="token punctuation">.</span>show <span class="token operator">=</span> show
<span class="token keyword">print</span><span class="token punctuation">(</span>p<span class="token punctuation">.</span>show<span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># \u8FD9\u91CC\u9700\u8981\u5C06\u5B9E\u4F8B\u4F20\u5165\u5230show\u65B9\u6CD5\u4E2D</span>
</code></pre></div></details><p>\u8F93\u51FA\u7ED3\u679C</p><div class="language-bash ext-sh"><pre class="language-bash"><code><span class="token punctuation">(</span><span class="token number">1</span>, <span class="token number">2</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">3</span>, <span class="token number">4</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">5</span>, <span class="token number">6</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token number">7</span>, <span class="token number">8</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="\u9B54\u6CD5\u65B9\u6CD5" tabindex="-1"><a class="header-anchor" href="#\u9B54\u6CD5\u65B9\u6CD5" aria-hidden="true">#</a> \u9B54\u6CD5\u65B9\u6CD5</h3><table><thead><tr><th>\u5206\u7C7B</th><th>\u9B54\u6CD5\u65B9\u6CD5</th><th>\u8BF4\u660E</th></tr></thead><tbody><tr><td>\u5B9E\u4F8B\u521B\u5EFA\u548C\u9500\u6BC1</td><td><code>__new__</code></td><td>\u521B\u5EFA\u7C7B\u5B9E\u4F8B\u5BF9\u8C61\u5E76\u8FD4\u56DE</td></tr><tr><td></td><td><code>__del__</code></td><td>\u5728\u5B9E\u4F8B\u5C06\u88AB\u9500\u6BC1\u65F6\u8C03\u7528</td></tr><tr><td>\u5C5E\u6027\u5B57\u5178</td><td><code>__dict__</code></td><td>\u5BF9\u8C61\u6240\u6709\u5C5E\u6027\u7EC4\u6210\u7684\u5B57\u5178</td></tr><tr><td>self[key]</td><td><code>__getitem__</code>\u3001<code>__setitem__</code>\u3001<code>__delitem__</code></td><td>\u901A\u8FC7<code>self[key]</code>\u8BBF\u95EE\u65F6\u8C03\u7528</td></tr><tr><td>\u53EF\u89C6\u5316</td><td><code>__repr__</code>\u3001<code>__str__</code>\u3001<code>__format__</code></td><td>\u53EF\u89C6\u5316</td></tr><tr><td>\u53EF\u8FED\u4EE3\u5BF9\u8C61\u548C\u8FED\u4EE3\u5668</td><td><code>__iter__</code>\u3001<code>__next__</code></td><td>\u53EF\u8FED\u4EE3\u5BF9\u8C61\u548C\u8FED\u4EE3\u5668</td></tr><tr><td>with\u4E0A\u4E0B\u6587\u7BA1\u7406</td><td><code>__enter__</code>\u3001<code>__exit__</code></td><td></td></tr><tr><td>\u5B9E\u4F8B\u5C5E\u6027\u67E5\u627E</td><td><code>__getattribute__</code></td><td></td></tr><tr><td>\u63CF\u8FF0\u5668</td><td><code>__get__</code>\u3001<code>__set__</code>\u3001<code>__delete__</code></td><td></td></tr><tr><td>\u8FD0\u7B97\u7B26\u91CD\u8F7D</td><td><code>__lt__</code></td><td>\u5C0F\u4E8E\uFF0C&lt;</td></tr><tr><td></td><td><code>__le__</code></td><td>\u5C0F\u4E8E\u7B49\u4E8E\uFF0C&lt;=</td></tr><tr><td></td><td><code>__eq__</code></td><td>\u7B49\u4E8E\uFF0C==</td></tr><tr><td></td><td><code>__gt__</code></td><td>\u5927\u4E8E\uFF0C&gt;</td></tr><tr><td></td><td><code>__ge__</code></td><td>\u5927\u4E8E\u7B49\u4E8E\uFF0C&gt;=</td></tr><tr><td></td><td><code>__ne__</code></td><td>\u4E0D\u7B49\u4E8E\uFF0C!=</td></tr><tr><td></td><td></td><td></td></tr><tr><td></td><td><code>__add__</code></td><td>\u52A0\uFF0C+</td></tr><tr><td></td><td><code>__sub__</code></td><td>\u51CF\uFF0C-</td></tr><tr><td></td><td>__<code>mul__</code></td><td>\u4E58\uFF0C*</td></tr><tr><td></td><td>__<code>truediv__</code></td><td>\u9664\uFF0C5 / 3 = 1.6666666666666667</td></tr><tr><td></td><td><code>__floordiv__</code></td><td>\u5730\u677F\u9664\uFF0C5 // 3 = 1</td></tr><tr><td></td><td><code>__mod__</code></td><td>\u53D6\u4F59\uFF0C%</td></tr><tr><td></td><td><code>__pow__</code></td><td>\u8BA1\u7B97\u6B21\u65B9\uFF0C 2 ** 3 = 2 * 2 * 2 = 8</td></tr><tr><td></td><td><code>__divmod__</code></td><td>\u7B49\u540C\u4E8E <code>(x//y, x%y)</code></td></tr><tr><td></td><td></td><td></td></tr><tr><td></td><td><code>__iadd__</code></td><td>+=</td></tr><tr><td></td><td><code>__isub__</code></td><td>-=</td></tr><tr><td></td><td><code>__imul__</code></td><td>*=</td></tr><tr><td></td><td><code>__itruediv__</code></td><td>/=</td></tr><tr><td></td><td><code>__imod__</code></td><td>%=</td></tr><tr><td></td><td><code>__ifloordiv__</code></td><td>//=</td></tr><tr><td></td><td><code>__ipow__</code></td><td>**=</td></tr></tbody></table><h4 id="new" tabindex="-1"><a class="header-anchor" href="#new" aria-hidden="true">#</a> <code>__new__</code></h4>`,49),fa=s("\u6587\u6863\uFF1A"),wa={href:"https://docs.python.org/zh-cn/3.10/reference/datamodel.html#object.__new__",target:"_blank",rel:"noopener noreferrer"},qa=s("https://docs.python.org/zh-cn/3.10/reference/datamodel.html#object."),xa=n("strong",null,"new",-1),va=p(`<p>\u521B\u5EFA\u7C7B\u5B9E\u4F8B\u5BF9\u8C61\u5E76\u8FD4\u56DE\uFF0C\u5B83\u53EF\u4EE5\u8BA9\u6211\u4EEC\u5B9A\u5236\u5B9E\u4F8B\u521B\u5EFA\u8FC7\u7A0B\uFF0C\u6BD4\u5982\u5B9E\u73B0<strong>\u5355\u4F8B\u6A21\u5F0F</strong></p><p>\u9ED8\u8BA4\u7684<code>__new__</code>\u884C\u4E3A</p><div class="language-python ext-py"><pre class="language-python"><code><span class="token comment">#!/usr/bin/env python</span>
<span class="token comment"># -*- coding:utf-8-*-</span>

<span class="token comment"># class Demo:</span>
<span class="token comment">#    pass</span>

<span class="token comment"># \u5C06\u4EE5\u4E0A\u4EE3\u7801\u5C55\u5F00\u7684\u8BDD\uFF0C\u5C31\u7B49\u540C\u4E8E\u5982\u4E0B\u4EE3\u7801</span>
<span class="token keyword">class</span> <span class="token class-name">Demo</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__new__</span><span class="token punctuation">(</span>cls<span class="token punctuation">,</span> <span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># return object.__new__(cls) # \u5199\u6CD51</span>
        <span class="token keyword">return</span> <span class="token builtin">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__new__<span class="token punctuation">(</span>cls<span class="token punctuation">)</span>  <span class="token comment"># \u5199\u6CD52</span>
</code></pre></div><p>\u4F7F\u7528<code>__new__</code>\u5B9E\u73B0\u7EBF\u7A0B\u5B89\u5168\u7684\u5355\u4F8B\u7C7B</p><details class="custom-container details"><summary>\u70B9\u51FB\u67E5\u770B\u5B8C\u6574\u4EE3\u7801</summary><div class="language-python ext-py"><pre class="language-python"><code><span class="token comment">#!/usr/bin/env python</span>
<span class="token comment"># -*- coding:utf-8-*-</span>

<span class="token keyword">import</span> threading

<span class="token keyword">class</span> <span class="token class-name">Single</span><span class="token punctuation">:</span>
    _instance_lock <span class="token operator">=</span> threading<span class="token punctuation">.</span>Lock<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">__new__</span><span class="token punctuation">(</span>cls<span class="token punctuation">,</span> <span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> <span class="token keyword">not</span> <span class="token builtin">hasattr</span><span class="token punctuation">(</span>cls<span class="token punctuation">,</span> <span class="token string">&quot;_instance&quot;</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">with</span> cls<span class="token punctuation">.</span>_instance_lock<span class="token punctuation">:</span>
                <span class="token keyword">if</span> <span class="token keyword">not</span> <span class="token builtin">hasattr</span><span class="token punctuation">(</span>cls<span class="token punctuation">,</span> <span class="token string">&quot;_instance&quot;</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                    cls<span class="token punctuation">.</span>_instance <span class="token operator">=</span> <span class="token builtin">object</span><span class="token punctuation">.</span>__new__<span class="token punctuation">(</span>cls<span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token builtin">getattr</span><span class="token punctuation">(</span>cls<span class="token punctuation">,</span> <span class="token string">&quot;_instance&quot;</span><span class="token punctuation">)</span>


<span class="token comment"># \u539F\u7406\u8BF4\u660E</span>
<span class="token comment">#   \u6BCF\u6B21\u521B\u5EFA\u3010\u7C7B\u5B9E\u4F8B\u5BF9\u8C61\u3011\u65F6\u5148\u68C0\u67E5\u3010\u7C7B\u5BF9\u8C61\u3011\u4E0A\u662F\u5426\u6709_instance\u5C5E\u6027\uFF0C</span>
<span class="token comment">#       \u5982\u679C\u6709\uFF0C\u8BF4\u660E\u5DF2\u7ECF\u5B9E\u4F8B\u5316\u8FC7\u4E86\uFF0C\u76F4\u63A5\u8FD4\u56DE\u7C7B\u5B9E\u4F8B\u5316\u5BF9\u8C61</span>
<span class="token comment">#       \u5982\u679C\u6CA1\u6709\uFF0C\u90A3\u4E48\u624D\u5F00\u59CB\u521B\u5EFA\u5B9E\u4F8B\u5BF9\u8C61</span>
<span class="token comment">#           \u83B7\u53D6\u9501</span>
<span class="token comment">#               \u7C7B\u5C5E\u6027_instance = \u7C7B\u5B9E\u4F8B\u5316\u5BF9\u8C61</span>
<span class="token comment">#           \u8FD4\u56DE\u7C7B\u5C5E\u6027_instance</span>
<span class="token comment">#</span>
<span class="token comment"># \u95EE: \u52A0\u9501\u4E4B\u540E\u4E3A\u4EC0\u4E48\u8FD8\u8981\u5224\u65AD\u6709\u6CA1\u6709_instance\u5C5E\u6027?</span>
<span class="token comment"># \u7B54: \u5982\u679C\u4E0D\u5224\u65AD\uFF0C\u90A3\u4E48\u7EBF\u7A0B1\u83B7\u53D6\u9501\u540E\uFF0C\u8FD8\u6CA1\u6267\u884C\u5B8C\uFF0C\u8FD9\u65F6\u5019\u7EBF\u7A0B2\u5DF2\u7ECF\u5728\u5C1D\u8BD5\u83B7\u53D6\u9501\u4E86\uFF0C\u7B49\u7EBF\u7A0B1\u6267\u884C\u5B8C\uFF0C\u5B9E\u9645\u4E0A\u5DF2\u7ECF\u662F\u5355\u4F8B\u4E86\uFF0C</span>
<span class="token comment">#     \u7EBF\u7A0B2\u53C8\u83B7\u53D6\u4E86\u4E00\u904D\u9501\uFF0C\u53C8\u751F\u6210\u4E00\u4E2A\u65B0\u5BF9\u8C61\uFF0C\u5B9E\u9645\u5C31\u5E76\u4E0D\u662F\u7EBF\u7A0B\u5B89\u5168\u4E86\u3002\u8FD9\u4E0E\u7EBF\u7A0B\u5B89\u5168\u7AE0\u8282\u7684queue\u9677\u9631\u7C7B\u4F3C\u3002</span>

<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    threading<span class="token punctuation">.</span>Thread<span class="token punctuation">(</span>target<span class="token operator">=</span><span class="token keyword">lambda</span><span class="token punctuation">:</span> <span class="token keyword">print</span><span class="token punctuation">(</span>Single<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div></details><h4 id="del" tabindex="-1"><a class="header-anchor" href="#del" aria-hidden="true">#</a> <code>__del__</code></h4>`,6),Ta=s("\u6587\u6863\uFF1A"),Ca={href:"https://docs.python.org/zh-cn/3.10/reference/datamodel.html#object.__del__",target:"_blank",rel:"noopener noreferrer"},Pa=s("https://docs.python.org/zh-cn/3.10/reference/datamodel.html#object."),Fa=n("strong",null,"del",-1),Na=p(`<p>\u5728\u5B9E\u4F8B\u5C06\u88AB\u9500\u6BC1\u65F6\u8C03\u7528\uFF0C\u6CE8\u610F\uFF1A<code>del x</code> \u5E76\u4E0D\u76F4\u63A5\u8C03\u7528 <code>x.__del__()</code> --- \u524D\u8005\u4F1A\u5C06 <code>x</code> \u7684\u5F15\u7528\u8BA1\u6570\u51CF\u4E00\uFF0C\u800C\u540E\u8005\u4EC5\u4F1A\u5728 <code>x</code> \u7684\u5F15\u7528\u8BA1\u6570\u53D8\u4E3A\u96F6\u65F6\u88AB\u8C03\u7528\u3002</p><p>\u4EE3\u7801\u793A\u4F8B</p><details class="custom-container details"><summary>\u70B9\u51FB\u67E5\u770B\u5B8C\u6574\u4EE3\u7801</summary><div class="language-python ext-py"><pre class="language-python"><code><span class="token comment">#!/usr/bin/env python</span>
<span class="token comment"># -*- coding:utf-8-*-</span>

<span class="token keyword">import</span> sys
<span class="token keyword">import</span> time

<span class="token keyword">class</span> <span class="token class-name">Demo</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__del__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;__del__ called&quot;</span><span class="token punctuation">)</span>


a <span class="token operator">=</span> Demo<span class="token punctuation">(</span><span class="token punctuation">)</span>
b <span class="token operator">=</span> a
c <span class="token operator">=</span> a

<span class="token keyword">print</span><span class="token punctuation">(</span>a <span class="token keyword">is</span> b <span class="token keyword">is</span> c<span class="token punctuation">)</span>  <span class="token comment"># True</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>sys<span class="token punctuation">.</span>getrefcount<span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>  <span class="token comment"># \u5F15\u7528\u8BA1\u6570\u4E3A3\uFF0C a\uFF0Cb,c</span>

<span class="token keyword">del</span> a  <span class="token comment"># del\u4F1A\u5C06\u5BF9\u8C61\u7684\u5F15\u7528\u8BA1\u6570-1\uFF0C\u53EA\u6709\u5F53\u5BF9\u8C61\u7684\u5F15\u7528\u8BA1\u6570\u4E3A0\u65F6\uFF0C\u624D\u4F1A\u8C03\u7528__del__\uFF0C\u6240\u4EE5\u8FD9\u91CC\u5E76\u4E0D\u4F1A\u6709\u4EFB\u4F55\u8F93\u51FA</span>

time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>

<span class="token comment"># \u7A0B\u5E8F\u5728\u7ED3\u675F\u65F6\uFF0C\u4F1A\u5C06\u5F15\u7528\u8BA1\u6570\u7F6E\u4E3A0\uFF0C\u5E76\u8C03\u7528\u4E00\u6B21__del__</span>
<span class="token comment"># __del__ called</span>


<span class="token comment"># \u8F93\u51FA\u7ED3\u679C</span>
<span class="token comment"># True</span>
<span class="token comment"># 3</span>
<span class="token comment"># __del__ called</span>
</code></pre></div></details><h4 id="dict" tabindex="-1"><a class="header-anchor" href="#dict" aria-hidden="true">#</a> <code>__dict__</code></h4>`,4),Ea=s("\u6587\u6863\uFF1A"),Aa={href:"https://docs.python.org/zh-cn/3.10/library/stdtypes.html#object.__dict__",target:"_blank",rel:"noopener noreferrer"},Ma=s("https://docs.python.org/zh-cn/3.10/library/stdtypes.html#object."),Oa=n("strong",null,"dict",-1),ja=p(`<p>\u8FD9\u4E2A\u592A\u91CD\u8981\u4E86\uFF0C\u540E\u9762\u4F1A\u7ECF\u5E38\u7528\u5230\uFF0C\u7ED9\u4E00\u4E2A\u7B80\u5355\u7684\u4F8B\u5B50</p><div class="language-python ext-py"><pre class="language-python"><code><span class="token comment">#!/usr/bin/env python</span>
<span class="token comment"># -*- coding:utf-8-*-</span>

<span class="token keyword">class</span> <span class="token class-name">Demo</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">&#39;&#39;&#39;\u6D4B\u8BD5Demo&#39;&#39;&#39;</span>

    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>name <span class="token operator">=</span> name
        self<span class="token punctuation">.</span>sex <span class="token operator">=</span> <span class="token string">&quot;man&quot;</span>


<span class="token keyword">print</span><span class="token punctuation">(</span>Demo<span class="token punctuation">.</span>__dict__<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>Demo<span class="token punctuation">(</span><span class="token string">&quot;Bob&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__dict__<span class="token punctuation">)</span>

<span class="token comment"># \u7B2C\u4E00\u6B21\u8F93\u51FA\u4E3A \u7C7B\u5B57\u5178</span>
<span class="token comment"># {&#39;__module__&#39;: &#39;__main__&#39;, &#39;__doc__&#39;: &#39;\u6D4B\u8BD5Demo&#39;, &#39;__init__&#39;: &lt;function Demo.__init__ at 0x00000229047F8C18&gt;, &#39;__dict__&#39;: &lt;attribute &#39;__dict__&#39; of &#39;Demo&#39; objects&gt;, &#39;__weakref__&#39;: &lt;attribute &#39;__weakref__&#39; of &#39;Demo&#39; objects&gt;}</span>

<span class="token comment"># \u7B2C\u4E8C\u6B21\u8F93\u51FA\u4E3A \u5B9E\u4F8B\u5B57\u5178</span>
<span class="token comment"># {&#39;name&#39;: &#39;Bob&#39;, &#39;sex&#39;: &#39;man&#39;}</span>
</code></pre></div><h4 id="self-key" tabindex="-1"><a class="header-anchor" href="#self-key" aria-hidden="true">#</a> <code>self[key]</code></h4>`,3),Ra={href:"https://docs.python.org/zh-cn/3.10/reference/datamodel.html#object.__getitem__",target:"_blank",rel:"noopener noreferrer"},za=s("\u6587\u6863\uFF1Ahttps://docs.python.org/zh-cn/3.10/reference/datamodel.html#object."),Ia=n("strong",null,"getitem",-1),Sa=p(`<p>\u4EE3\u7801\u793A\u4F8B</p><details class="custom-container details"><summary>\u70B9\u51FB\u67E5\u770B\u5B8C\u6574\u4EE3\u7801</summary><div class="language-python ext-py"><pre class="language-python"><code><span class="token comment">#!/usr/bin/env python</span>
<span class="token comment"># -*- coding:utf-8-*-</span>

<span class="token comment"># \u6D4B\u8BD51\uFF1A\u51C6\u5907\u51E0\u79CD\u4E0D\u540C\u7684\u6570\u636E\u7ED3\u6784</span>
l <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">300</span><span class="token punctuation">]</span>
d <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;bob&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;age&quot;</span><span class="token punctuation">:</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">:</span> <span class="token number">20</span><span class="token punctuation">}</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>l<span class="token punctuation">.</span>__getitem__<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># \u7B49\u540C\u4E8E l[0], \u5217\u8868\u6CA1\u6709key\uFF0C\u53EA\u6709\u7D22\u5F15\uFF0C\u6240\u4EE50\u4EE3\u8868\u7684\u662F\u7D22\u5F15</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>d<span class="token punctuation">.</span>__getitem__<span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># \u7B49\u540C\u4E8Ed[&quot;name&quot;]</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>d<span class="token punctuation">.</span>__getitem__<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># \u7B49\u540C\u4E8Ed[10]\uFF0C\u8FD9\u91CC\u867D\u7136\u662F\u6570\u5B57\uFF0C\u770B\u8D77\u6765\u50CF\u662F\u901A\u8FC7\u7D22\u5F15\u6765\u8BBF\u95EE\uFF08\u5176\u5B9E\u4E0D\u662F\uFF09\uFF0C\u672C\u8D28\u4E0A\u8FD8\u662F\u901A\u8FC7key</span>


<span class="token comment"># \u6D4B\u8BD52\uFF1A</span>
<span class="token keyword">class</span> <span class="token class-name">Demo</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> <span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>data <span class="token operator">=</span> <span class="token punctuation">{</span>
            <span class="token string">&quot;name&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;Demo&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;version&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;v1&quot;</span>
        <span class="token punctuation">}</span>

    <span class="token keyword">def</span> <span class="token function">__getitem__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> item<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;Called: __getitem__(</span><span class="token interpolation"><span class="token punctuation">{</span>item<span class="token punctuation">}</span></span><span class="token string">)&quot;</span></span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> self<span class="token punctuation">.</span>data<span class="token punctuation">[</span>item<span class="token punctuation">]</span>

    <span class="token keyword">def</span> <span class="token function">__setitem__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> key<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;Called: __setitem__(</span><span class="token interpolation"><span class="token punctuation">{</span>key<span class="token punctuation">}</span></span><span class="token string">, </span><span class="token interpolation"><span class="token punctuation">{</span>value<span class="token punctuation">}</span></span><span class="token string">)&quot;</span></span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>data<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> value

    <span class="token keyword">def</span> <span class="token function">__delitem__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;Called: __delitem__(</span><span class="token interpolation"><span class="token punctuation">{</span>key<span class="token punctuation">}</span></span><span class="token string">)&quot;</span></span><span class="token punctuation">)</span>
        <span class="token keyword">del</span> self<span class="token punctuation">.</span>data<span class="token punctuation">[</span>key<span class="token punctuation">]</span>


<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;-&quot;</span> <span class="token operator">*</span> <span class="token number">50</span><span class="token punctuation">)</span>
<span class="token comment"># (1)</span>
d <span class="token operator">=</span> Demo<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>d<span class="token punctuation">[</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token comment"># (2)</span>
d<span class="token punctuation">[</span><span class="token string">&quot;color&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&quot;red&quot;</span>

<span class="token comment"># (3)</span>
<span class="token keyword">del</span> d<span class="token punctuation">[</span><span class="token string">&quot;version&quot;</span><span class="token punctuation">]</span>
</code></pre></div></details><p>\u8F93\u51FA\u7ED3\u679C</p><div class="language-bash ext-sh"><pre class="language-bash"><code><span class="token number">100</span>
bob
<span class="token number">20</span>
--------------------------------------------------
Called: __getitem__<span class="token punctuation">(</span>name<span class="token punctuation">)</span>
Demo
Called: __setitem__<span class="token punctuation">(</span>color, red<span class="token punctuation">)</span>
Called: __delitem__<span class="token punctuation">(</span>version<span class="token punctuation">)</span>
</code></pre></div><h4 id="\u53EF\u89C6\u5316" tabindex="-1"><a class="header-anchor" href="#\u53EF\u89C6\u5316" aria-hidden="true">#</a> \u53EF\u89C6\u5316</h4>`,5),Ba=s("\u6587\u6863\uFF1A"),La={href:"https://docs.python.org/zh-cn/3.10/reference/datamodel.html#object.__repr__",target:"_blank",rel:"noopener noreferrer"},Da=s("https://docs.python.org/zh-cn/3.10/reference/datamodel.html#object."),Ua=n("strong",null,"repr",-1),Va=p(`<ul><li><p><code>__str__</code>\u548C<code>__repr__</code>\u4F5C\u7528\u7C7B\u4F3C\uFF0C\u63A8\u8350\u4E24\u4E2A\u5B9A\u4E49\u6210\u4E00\u6837\u7684\uFF0C\u5E76\u4E14\u4F18\u5148\u5B9A\u4E49<code>__repr__</code>\uFF08<code>__str__</code>\u4E5F\u53EF\u4EE5\u4E0D\u5B9A\u4E49\u4F1A\u81EA\u52A8\u8C03\u7528<code>__repr__</code>\uFF09</p></li><li><p><code>__str__</code>\u548C<code>__repr__</code>\u4E0D\u540C\u7684\u4F8B\u5B50\u53EF\u4EE5\u53C2\u8003<code>datetime</code>\u6A21\u5757\u5B9E\u73B0</p><div class="language-python ext-py"><pre class="language-python"><code><span class="token keyword">from</span> datetime <span class="token keyword">import</span> date
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>date<span class="token punctuation">.</span>today<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>   <span class="token comment"># 2022-04-08</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">repr</span><span class="token punctuation">(</span>date<span class="token punctuation">.</span>today<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># datetime.date(2022, 4, 8)</span>
</code></pre></div></li><li><p><code>__format__</code>\u7528\u7684\u5E76\u4E0D\u591A\uFF0C\u5F53\u9700\u8981\u4E00\u4E2A\u5BF9\u8C61\u53EF\u4EE5\u5C55\u793A\u591A\u79CD\u6837\u5F0F\u65F6\u53EF\u4EE5\u5B9A\u4E49\u8FD9\u4E2A\u65B9\u6CD5</p></li></ul><p>\u793A\u4F8B\u4EE3\u7801</p><details class="custom-container details"><summary>\u70B9\u51FB\u67E5\u770B\u5B8C\u6574\u4EE3\u7801</summary><div class="language-python ext-py"><pre class="language-python"><code><span class="token comment">#!/usr/bin/env python</span>
<span class="token comment"># -*- coding:utf-8-*-</span>

<span class="token keyword">class</span> <span class="token class-name">Person</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>name <span class="token operator">=</span> name


<span class="token keyword">class</span> <span class="token class-name">Person2</span><span class="token punctuation">(</span>Person<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__repr__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token string-interpolation"><span class="token string">f&#39;&lt;Person2 </span><span class="token interpolation"><span class="token punctuation">{</span>self<span class="token punctuation">.</span>name<span class="token punctuation">}</span></span><span class="token string">&gt;&#39;</span></span>


<span class="token comment"># \u9ED8\u8BA4\u60C5\u51B5\u4E0B\u7684\u8F93\u51FA</span>
bob <span class="token operator">=</span> Person<span class="token punctuation">(</span><span class="token string">&quot;Bob&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>bob<span class="token punctuation">)</span>  <span class="token comment"># &lt;__main__.Person object at 0x0000017AE21FD548&gt;</span>

<span class="token comment"># \u4F18\u5316\u9ED8\u8BA4\u8F93\u51FA</span>
jack <span class="token operator">=</span> Person2<span class="token punctuation">(</span><span class="token string">&quot;Jack&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>jack<span class="token punctuation">)</span>  <span class="token comment"># &lt;Person2 Jack&gt;</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;-&quot;</span> <span class="token operator">*</span> <span class="token number">50</span><span class="token punctuation">)</span>


<span class="token comment"># __format__\u53EF\u4EE5\u5B9A\u5236\u591A\u79CD\u8F93\u51FA\u683C\u5F0F</span>
<span class="token keyword">class</span> <span class="token class-name">Point</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> x<span class="token punctuation">:</span> <span class="token builtin">int</span><span class="token punctuation">,</span> y<span class="token punctuation">:</span> <span class="token builtin">int</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>x <span class="token operator">=</span> x
        self<span class="token punctuation">.</span>y <span class="token operator">=</span> y

    <span class="token keyword">def</span> <span class="token function">__repr__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token string-interpolation"><span class="token string">f&quot;&lt;Point (</span><span class="token interpolation"><span class="token punctuation">{</span>self<span class="token punctuation">.</span>x<span class="token punctuation">}</span></span><span class="token string">, </span><span class="token interpolation"><span class="token punctuation">{</span>self<span class="token punctuation">.</span>y<span class="token punctuation">}</span></span><span class="token string">)&gt;&quot;</span></span>

    <span class="token keyword">def</span> <span class="token function">__format__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> format_spec<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># \u663E\u793A\u683C\u5F0F\uFF0C\u4E5F\u53EF\u4EE5\u653E\u5230\u7C7B\u5916\u8FB9\u53BB\u5B9A\u4E49</span>
        FORMAT <span class="token operator">=</span> <span class="token punctuation">{</span>
            <span class="token string">&quot;default&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;&lt;Point ({}, {})&gt;&quot;</span><span class="token punctuation">,</span>  <span class="token comment"># \u9ED8\u8BA4\u663E\u793A\u683C\u5F0F</span>
            <span class="token string">&quot;parentheses&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;({}, {})&quot;</span><span class="token punctuation">,</span>  <span class="token comment"># \u5C0F\u62EC\u53F7\u663E\u793A\u683C\u5F0F</span>
            <span class="token string">&quot;dictionary&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;{{&#39;x&#39;:{}, &#39;y&#39;:{} }}&quot;</span><span class="token punctuation">,</span>  <span class="token comment"># \u5B57\u5178\u663E\u793A\u683C\u5F0F</span>
        <span class="token punctuation">}</span>

        <span class="token comment"># \u4E0D\u6307\u5B9A\u5219\u4F7F\u7528\u9ED8\u8BA4\u663E\u793A\u5F62\u5F0F</span>
        <span class="token keyword">if</span> format_spec <span class="token operator">==</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> self<span class="token punctuation">.</span>__repr__<span class="token punctuation">(</span><span class="token punctuation">)</span>

        <span class="token keyword">return</span> FORMAT<span class="token punctuation">[</span>format_spec<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>x<span class="token punctuation">,</span> self<span class="token punctuation">.</span>y<span class="token punctuation">)</span>


point <span class="token operator">=</span> Point<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;</span><span class="token interpolation"><span class="token punctuation">{</span>point<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>  <span class="token comment"># \u9ED8\u8BA4\u663E\u793A\u683C\u5F0F\uFF0C &lt;Point (100, 200)&gt;</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;</span><span class="token interpolation"><span class="token punctuation">{</span>point<span class="token punctuation">:</span><span class="token format-spec">parentheses</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>  <span class="token comment"># \u5C0F\u62EC\u53F7\u663E\u793A\u683C\u5F0F\uFF0C (100, 200)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;</span><span class="token interpolation"><span class="token punctuation">{</span>point<span class="token punctuation">:</span><span class="token format-spec">dictionary</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>  <span class="token comment"># \u5B57\u5178\u663E\u793A\u683C\u5F0F\uFF0C {&#39;x&#39;:100, &#39;y&#39;:200 }</span>
</code></pre></div></details><p>\u8F93\u51FA\u7ED3\u679C</p><div class="language-bash ext-sh"><pre class="language-bash"><code><span class="token operator">&lt;</span>__main__.Person object at 0x00000210C796590<span class="token operator"><span class="token file-descriptor important">8</span>&gt;</span>
<span class="token operator">&lt;</span>Person2 Jack<span class="token operator">&gt;</span>
--------------------------------------------------
<span class="token operator">&lt;</span>Point <span class="token punctuation">(</span><span class="token number">100</span>, <span class="token number">200</span><span class="token punctuation">)</span><span class="token operator">&gt;</span>
<span class="token punctuation">(</span><span class="token number">100</span>, <span class="token number">200</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span><span class="token string">&#39;x&#39;</span>:100, <span class="token string">&#39;y&#39;</span>:200 <span class="token punctuation">}</span>
</code></pre></div><h4 id="\u53EF\u8FED\u4EE3\u5BF9\u8C61\u548C\u8FED\u4EE3\u5668" tabindex="-1"><a class="header-anchor" href="#\u53EF\u8FED\u4EE3\u5BF9\u8C61\u548C\u8FED\u4EE3\u5668" aria-hidden="true">#</a> \u53EF\u8FED\u4EE3\u5BF9\u8C61\u548C\u8FED\u4EE3\u5668</h4>`,6),Wa=s("\u6587\u6863\uFF1A"),Ha={href:"https://docs.python.org/zh-cn/3.10/library/stdtypes.html#container.__iter__",target:"_blank",rel:"noopener noreferrer"},Ja=s("https://docs.python.org/zh-cn/3.10/library/stdtypes.html#container."),Ga=n("strong",null,"iter",-1),Ya=p(`<hr><p><strong>\uFF081\uFF09\u57FA\u7840\u77E5\u8BC6</strong></p><p>\u8BED\u6CD5\u5B9A\u4E49\uFF1A\u5B9E\u73B0\u4E86<code>__iter__</code>\u65B9\u6CD5\u7684\u5BF9\u8C61\u79F0\u4E3A\u53EF\u8FED\u4EE3\u5BF9\u8C61\uFF0C\u5B9E\u73B0\u4E86<code>__iter__</code>\u65B9\u6CD5\u548C<code>__next__</code>\u7684\u5BF9\u8C61\u79F0\u4E3A\u8FED\u4EE3\u5668</p><p>\u5305\u542B\u5173\u7CFB\uFF1A\u8FED\u4EE3\u5668\u662F\u53EF\u8FED\u4EE3\u5BF9\u8C61\uFF0C\u4F46\u662F\u53EF\u8FED\u4EE3\u5BF9\u8C61\u4E0D\u4E00\u5B9A\u662F\u8FED\u4EE3\u5668</p><br><p>\u76F8\u540C\u70B9\uFF1A\u90FD\u53EF\u4EE5\u4F7F\u7528<code>for xx in xx</code>\u8BED\u53E5</p><p>\u4E0D\u540C\u70B9\uFF1A</p><ul><li><p><strong>\u540C\u4E00\u4E2A\u8FED\u4EE3\u5668\u5BF9\u8C61</strong>\u53EA\u80FD\u4F7F\u7528<strong>\u4E00\u6B21</strong>for\u8BED\u53E5\u8FED\u4EE3</p></li><li><p><strong>\u540C\u4E00\u4E2A\u53EF\u8FED\u4EE3\u5BF9\u8C61</strong>\u53EF\u4EE5<strong>\u591A\u6B21</strong>\u4F7F\u7528for\u8BED\u53E5\u8FED\u4EE3\uFF0C\u539F\u56E0\u5728\u4E8E<code>__iter__</code>\u5FC5\u987B\u8981\u8FD4\u56DE\u4E00\u4E2A\u8FED\u4EE3\u5668\u5BF9\u8C61</p></li></ul><br><p>\u76F8\u5173\u5185\u5EFA\u51FD\u6570\uFF1A</p><ul><li><code>iter(\u53EF\u8FED\u4EE3\u5BF9\u8C61)</code> \u5C06\u53EF\u8FED\u4EE3\u5BF9\u8C61\u8F6C\u4E3A\u4E00\u4E2A\u65B0\u7684\u8FED\u4EE3\u5668\u8FD4\u56DE\uFF0C\u7B49\u540C\u4E8E\u8C03\u7528<code>\u53EF\u8FED\u4EE3\u5BF9\u8C61.__iter__()</code></li><li><code>next(\u8FED\u4EE3\u5668)</code>\u83B7\u53D6\u4E0B\u4E00\u6B21\u8FED\u4EE3\u7684\u503C\uFF0C\u8FED\u4EE3\u5B8C\u6210\u540E\u4F1A\u629B\u51FA<code>StopIteration</code>\u5F02\u5E38\uFF0Cfor\u8BED\u53E5\u4F1A\u81EA\u52A8\u5E2E\u6211\u4EEC\u6355\u83B7\uFF0C\u7136\u540E\u9000\u51FA\u5FAA\u73AF</li></ul><br><p>\u6570\u636E\u7C7B\u578B\u4E3E\u4F8B</p><ul><li>\u8FED\u4EE3\u5668\uFF1A\u751F\u6210\u5668</li><li>\u53EF\u8FED\u4EE3\u5BF9\u8C61\uFF1A\u5B57\u7B26\u4E32\u3001\u5217\u8868\u3001\u5143\u7EC4\u3001\u5B57\u5178\u7B49</li></ul><br><p><strong>\uFF082\uFF09\u8FED\u4EE3\u6B21\u6570\u4E0D\u540C\u793A\u4F8B</strong></p><details class="custom-container details"><summary>\u70B9\u51FB\u67E5\u770B\u5B8C\u6574\u4EE3\u7801</summary><div class="language-python ext-py"><pre class="language-python"><code><span class="token comment"># !/usr/bin/env python</span>
<span class="token comment"># -*- coding:utf-8-*-</span>

<span class="token keyword">import</span> warnings

warnings<span class="token punctuation">.</span>filterwarnings<span class="token punctuation">(</span><span class="token string">&quot;ignore&quot;</span><span class="token punctuation">)</span>  <span class="token comment"># \u5173\u7CFBcollections.abc\u7684\u8B66\u544A</span>

<span class="token keyword">from</span> collections <span class="token keyword">import</span> Iterable<span class="token punctuation">,</span> Iterator

<span class="token comment"># \u5B9A\u4E49\u6570\u636E</span>
l1 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">]</span>  <span class="token comment"># \u5217\u8868\u662F\u53EF\u8FED\u4EE3\u5BF9\u8C61\uFF0C\u4F46\u4E0D\u662F\u8FED\u4EE3\u5668</span>
l2 <span class="token operator">=</span> <span class="token builtin">iter</span><span class="token punctuation">(</span>l1<span class="token punctuation">)</span>  <span class="token comment"># \u4F7F\u7528iter(\u53EF\u8FED\u4EE3\u5BF9\u8C61)\u53EF\u4EE5\u5C06 \u53EF\u8FED\u4EE3\u5BF9\u8C61\u8F6C\u4E3A\u8FED\u4EE3\u5668</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;-&quot;</span> <span class="token operator">*</span> <span class="token number">25</span> <span class="token operator">+</span> <span class="token string">&quot; \u4E00\u4E2A\u53EF\u8FED\u4EE3\u5BF9\u8C61\u548C\u4E00\u4E2A\u8FED\u4EE3\u5668 &quot;</span> <span class="token operator">+</span> <span class="token string">&quot;-&quot;</span> <span class="token operator">*</span> <span class="token number">25</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;l1\u662F\u53EF\u8FED\u4EE3\u5BF9\u8C61: </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token builtin">isinstance</span><span class="token punctuation">(</span>l1<span class="token punctuation">,</span> Iterable<span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">, \u662F\u8FED\u4EE3\u5668: </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token builtin">isinstance</span><span class="token punctuation">(</span>l1<span class="token punctuation">,</span> Iterator<span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;l2\u662F\u53EF\u8FED\u4EE3\u5BF9\u8C61: </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token builtin">isinstance</span><span class="token punctuation">(</span>l2<span class="token punctuation">,</span> Iterable<span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">, \u662F\u8FED\u4EE3\u5668: </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token builtin">isinstance</span><span class="token punctuation">(</span>l2<span class="token punctuation">,</span> Iterator<span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;-&quot;</span> <span class="token operator">*</span> <span class="token number">25</span> <span class="token operator">+</span> <span class="token string">&quot;\u591A\u6B21\u8FED\u4EE3l1&quot;</span> <span class="token operator">+</span> <span class="token string">&quot;-&quot;</span> <span class="token operator">*</span> <span class="token number">25</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> l1<span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span>

<span class="token keyword">for</span> i <span class="token keyword">in</span> l1<span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;-&quot;</span> <span class="token operator">*</span> <span class="token number">25</span> <span class="token operator">+</span> <span class="token string">&quot;\u591A\u6B21\u8FED\u4EE3l2&quot;</span> <span class="token operator">+</span> <span class="token string">&quot;-&quot;</span> <span class="token operator">*</span> <span class="token number">25</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> l2<span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span>

<span class="token keyword">for</span> i <span class="token keyword">in</span> l2<span class="token punctuation">:</span>  <span class="token comment"># \u8FD9\u91CC\u518D\u8FED\u4EE3\uFF0C\u5DF2\u7ECF\u6CA1\u6709\u6570\u636E\u4E86</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span>

<span class="token comment"># \u9700\u8981\u6CE8\u610F\u7684\u662F\uFF1A\u4E0A\u9762\u6211\u4EEC\u90FD\u662F\u5728\u8FED\u4EE3\u540C\u4E00\u5BF9\u8C61\uFF0C\u5982\u679C\u662F\u4E0D\u540C\u5BF9\u8C61\uFF0C\u4E0D\u7BA1\u662F\u8FED\u4EE3\u5668\u8FD8\u662F\u53EF\u8FED\u4EE3\u5BF9\u8C61\uFF0C\u90FD\u53EF\u4EE5\u65E0\u9650\u4F7F\u7528for\u8BED\u53E5\uFF0C\u6BD4\u5982</span>
<span class="token comment"># for i in Range(10):   # Range\u662F\u4E00\u4E2A\u8FED\u4EE3\u5668</span>
<span class="token comment">#     print(i)</span>
<span class="token comment"># for i in Range(10):   # \u6CE8\u610F\u8FD9\u91CC\u53C8\u662F\u53E6\u5916\u4E00\u4E2ARange\u5BF9\u8C61\u4E86\uFF0C\u8DDF\u4E0A\u9762\u7684\u4E0D\u4E00\u6837\uFF0C\u6240\u4EE5\u53EF\u4EE5\u7EE7\u7EED\u8FED\u4EE3</span>
<span class="token comment">#     print(i)</span>
</code></pre></div></details><p>\u8F93\u51FA\u7ED3\u679C</p><div class="language-bash ext-sh"><pre class="language-bash"><code>------------------------- \u4E00\u4E2A\u53EF\u8FED\u4EE3\u5BF9\u8C61\u548C\u4E00\u4E2A\u8FED\u4EE3\u5668 -------------------------
l1\u662F\u53EF\u8FED\u4EE3\u5BF9\u8C61: True, \u662F\u8FED\u4EE3\u5668: False
l2\u662F\u53EF\u8FED\u4EE3\u5BF9\u8C61: True, \u662F\u8FED\u4EE3\u5668: True
-------------------------\u591A\u6B21\u8FED\u4EE3l1-------------------------
<span class="token number">100</span>
<span class="token number">200</span>
<span class="token number">100</span>
<span class="token number">200</span>
-------------------------\u591A\u6B21\u8FED\u4EE3l2-------------------------
<span class="token number">100</span>
<span class="token number">200</span>
</code></pre></div><br><br><p><strong>\uFF083\uFF09<code>__iter__</code>\u548C<code>__next__</code>\u65B9\u6CD5</strong></p><p><code>__iter__</code>\u5FC5\u987B\u8FD4\u56DE\u4E00\u4E2A\u8FED\u4EE3\u5668\uFF0C\u6B64\u65F6\u53EF\u4EE5\u6709\u4EE5\u4E0B\u51E0\u79CD\u8FD4\u56DE\u503C\uFF1A</p><ul><li>\u8FD4\u56DE\u5B9E\u4F8B\u672C\u8EAB(<code>self</code>)\uFF0C\u610F\u5473\u7740\u5B9E\u4F8B\u672C\u8EAB\u5C31\u662F\u8FED\u4EE3\u5668\uFF0C\u6240\u4EE5\u4E5F\u9700\u8981\u5B9E\u73B0<code>__next__</code>\u65B9\u6CD5</li><li>\u5C06\u53EF\u8FED\u4EE3\u5BF9\u8C61\u8F6C\u4E3A\u8FED\u4EE3\u5668\u5E76\u8FD4\u56DE\uFF0C<code>return iter(\u53EF\u8FED\u4EE3\u5BF9\u8C61)</code></li><li>\u8FD4\u56DE\u751F\u6210\u5668\uFF08\u751F\u6210\u5668\u662F\u8FED\u4EE3\u5668\u7684\u4E00\u79CD\uFF09</li></ul><p><code>__next__</code>\u65B9\u6CD5\u8FD4\u56DE\u4E0B\u4E00\u4E2A\u503C\uFF0C\u5982\u679C\u503C\u5DF2\u7ECF\u53D6\u5B8C\uFF0C\u629B\u51FA<code>StopIteration</code>\uFF0C<code>for</code>\u8BED\u53E5\u4F1A\u81EA\u52A8\u6355\u6349\u8FD9\u4E2A\u5F02\u5E38\uFF0C\u7136\u540E\u9000\u51FA\u5FAA\u73AF</p><p>\u793A\u4F8B\u4EE3\u7801 - \u4EFF<code>range</code></p><details class="custom-container details"><summary>\u70B9\u51FB\u67E5\u770B\u5B8C\u6574\u4EE3\u7801</summary><div class="language-python ext-py"><pre class="language-python"><code><span class="token comment">#!/usr/bin/env python</span>
<span class="token comment"># -*- coding:utf-8-*-</span>


<span class="token keyword">class</span> <span class="token class-name">Range</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> start<span class="token punctuation">,</span> stop<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> step<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>step <span class="token operator">=</span> step
        <span class="token comment"># \u4E00\u4E2A\u53C2\u6570, start = stop</span>
        <span class="token keyword">if</span> stop <span class="token keyword">is</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
            self<span class="token punctuation">.</span>start <span class="token operator">=</span> <span class="token operator">-</span> self<span class="token punctuation">.</span>step
            self<span class="token punctuation">.</span>stop <span class="token operator">=</span> start
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token comment"># \u4E24\u4E2A\u53C2\u6570</span>
            self<span class="token punctuation">.</span>start <span class="token operator">=</span> start <span class="token operator">-</span> self<span class="token punctuation">.</span>step
            self<span class="token punctuation">.</span>stop <span class="token operator">=</span> stop

    <span class="token keyword">def</span> <span class="token function">__iter__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> self

    <span class="token keyword">def</span> <span class="token function">__next__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>start <span class="token operator">+=</span> self<span class="token punctuation">.</span>step
        <span class="token keyword">if</span> self<span class="token punctuation">.</span>start <span class="token operator">&gt;=</span> self<span class="token punctuation">.</span>stop<span class="token punctuation">:</span>
            <span class="token keyword">raise</span> StopIteration
        <span class="token keyword">return</span> self<span class="token punctuation">.</span>start


<span class="token keyword">for</span> i <span class="token keyword">in</span> Range<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token builtin">list</span><span class="token punctuation">(</span>Range<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># True</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token builtin">list</span><span class="token punctuation">(</span>Range<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># True</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token builtin">list</span><span class="token punctuation">(</span>Range<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># True</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token builtin">list</span><span class="token punctuation">(</span>Range<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># True</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token builtin">list</span><span class="token punctuation">(</span>Range<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># True</span>
</code></pre></div></details><p>\u8F93\u51FA\u7ED3\u679C</p><div class="language-bash ext-sh"><pre class="language-bash"><code><span class="token number">10</span>
<span class="token number">13</span>
<span class="token number">16</span>
<span class="token number">19</span>
True
True
True
True
True
</code></pre></div><p><strong>\uFF084\uFF09\u8FED\u4EE3\u6D41\u7A0B\u6269\u5C55</strong></p><p>\u4E00\u4E2A\u5B8C\u6574\u7684\u8FED\u4EE3\u6D41\u7A0B\u5982\u4E0B\uFF1A</p><p>\u2460 \u68C0\u67E5\u5BF9\u8C61\u662F\u5426\u5B9E\u73B0\u4E86<code>__iter__</code>\u65B9\u6CD5\uFF0C\u5982\u679C\u5B9E\u73B0\u4E86\u5C31\u8C03\u7528\u5B83\uFF0C\u83B7\u53D6\u4E00\u4E2A\u8FED\u4EE3\u5668</p><p>\u2461 \u5982\u679C\u6CA1\u6709\u5B9E\u73B0<code>__iter__</code>\u65B9\u6CD5\uFF0C<strong>\u4F46\u662F\u5B9E\u73B0\u4E86<code> __getitem__</code> \u65B9\u6CD5\uFF0CPython\u4F1A\u521B\u5EFA\u4E00\u4E2A\u8FED\u4EE3\u5668\uFF0C\u5C1D\u8BD5\u6309\u987A\u5E8F\uFF08\u4ECE\u7D22\u5F15 0 \u5F00\u59CB\uFF09\u83B7\u53D6\u5143\u7D20</strong></p><p>\u200B \u5982\u679C\u5C1D\u8BD5\u5931\u8D25\uFF0CPython\u629B\u51FA <code>TypeError</code>\u5F02\u5E38\uFF0C\u901A\u5E38\u4F1A\u63D0\u793A<code>&quot;x object is not iterable&quot;</code></p><p>\u4E0D\u5B9E\u73B0<code>__iter__</code>\u4F46\u662F\u5B9E\u73B0<code>__getitem__</code>\u793A\u4F8B</p><details class="custom-container details"><summary>\u70B9\u51FB\u67E5\u770B\u5B8C\u6574\u4EE3\u7801</summary><div class="language-python ext-py"><pre class="language-python"><code><span class="token comment">#!/usr/bin/env python</span>
<span class="token comment"># -*- coding:utf-8-*-</span>

<span class="token keyword">import</span> warnings

warnings<span class="token punctuation">.</span>filterwarnings<span class="token punctuation">(</span><span class="token string">&quot;ignore&quot;</span><span class="token punctuation">)</span>  <span class="token comment"># \u5173\u7CFBcollections.abc\u7684\u8B66\u544A</span>

<span class="token keyword">from</span> collections <span class="token keyword">import</span> Iterable<span class="token punctuation">,</span> Iterator


<span class="token keyword">class</span> <span class="token class-name">Range</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>data <span class="token operator">=</span> <span class="token punctuation">[</span>x <span class="token keyword">for</span> x <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">]</span>

    <span class="token keyword">def</span> <span class="token function">__getitem__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> item<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> self<span class="token punctuation">.</span>data<span class="token punctuation">[</span>item<span class="token punctuation">]</span>


data <span class="token operator">=</span> Range<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token keyword">for</span> i <span class="token keyword">in</span> data<span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span>

<span class="token keyword">for</span> i <span class="token keyword">in</span> data<span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">isinstance</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> Iterable<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">isinstance</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> Iterator<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># \u603B\u7ED3\uFF1A</span>
<span class="token comment"># \u4EC5\u5229\u7528__getitem__\u5C31\u53EF\u4EE5\u5B9E\u73B0for\u8BED\u53E5\u8FED\u4EE3\uFF0C\u4F46\u662F\u5B83\u5E76\u4E0D\u662F\u53EF\u8FED\u4EE3\u5BF9\u8C61\uFF0C\u66F4\u4E0D\u662F\u8FED\u4EE3\u5668</span>
</code></pre></div></details><p>\u8F93\u51FA\u7ED3\u679C</p><div class="language-bash ext-sh"><pre class="language-bash"><code><span class="token number">5</span>
<span class="token number">6</span>
<span class="token number">7</span>
<span class="token number">5</span>
<span class="token number">6</span>
<span class="token number">7</span>
<span class="token number">5</span>
<span class="token number">6</span>
<span class="token number">7</span>
False
False
</code></pre></div><h4 id="with\u4E0A\u4E0B\u6587\u7BA1\u7406" tabindex="-1"><a class="header-anchor" href="#with\u4E0A\u4E0B\u6587\u7BA1\u7406" aria-hidden="true">#</a> with\u4E0A\u4E0B\u6587\u7BA1\u7406</h4><p>\u6587\u6863</p>`,40),Ka=s("\uFF081\uFF09"),Qa={href:"https://docs.python.org/zh-cn/3.10/reference/compound_stmts.html#the-with-statement",target:"_blank",rel:"noopener noreferrer"},$a=s("https://docs.python.org/zh-cn/3.10/reference/compound_stmts.html#the-with-statement"),Za=s("\uFF082\uFF09"),Xa={href:"https://docs.python.org/zh-cn/3.10/reference/datamodel.html#object.__enter__",target:"_blank",rel:"noopener noreferrer"},nt=s("https://docs.python.org/zh-cn/3.10/reference/datamodel.html#object."),st=n("strong",null,"enter",-1),at=p(`<p><strong>\u8BF4\u660E</strong></p><p><code>__enter__</code>\uFF1A</p><ul><li><strong>\u4F7F\u7528<code>with..as</code>\u8BED\u53E5\u65F6\uFF0C<code>__enter__</code>\u7684\u8FD4\u56DE\u503C\u5C31\u7B49\u4E8E<code>as</code>\u540E\u9762\u8DDF\u7684\u53D8\u91CF</strong></li><li>\u5982\u679C<code>__enter__</code>\u65B9\u6CD5\u53D1\u751F\u9519\u8BEF\uFF0C\u90A3\u4E48\u610F\u5473\u7740<code>with</code>\u8BED\u53E5\u5C1A\u672A\u5F00\u59CB\u6267\u884C\uFF0C<code>__exit__</code>\u81EA\u7136\u4E5F\u4E0D\u4F1A\u6267\u884C</li><li>\u5982\u679C<code>__enter__</code>\u65B9\u6CD5\u672A\u53D1\u751F\u9519\u8BEF\uFF0C\u90A3\u4E48<code>__exit__()</code> \u5C06\u603B\u662F\u88AB\u8C03\u7528</li></ul><p><code>__exit__</code>:</p><ul><li><code>with</code>\u8BED\u53E5\u6267\u884C\u5B8C\u6210\u540E\uFF0C\u4F1A\u81EA\u52A8\u6267\u884C<code>__exit__</code>\u65B9\u6CD5\uFF0C\u5373\u4F7F\u5728with\u4E0A\u4E0B\u6587\u4E2D\u9047\u5230\u5F02\u5E38\uFF0C<code>__exit__</code>\u4E5F\u4F1A\u88AB\u6267\u884C</li><li><strong><code>__exit__</code>\u7684\u8FD4\u56DE\u503C\u51B3\u5B9A<code>with</code>\u8BED\u53E5\u4E2D\u7684\u5F02\u5E38\u662F\u5426\u5411\u5916\u629B\u51FA\uFF08\u7B49\u6548\u4E8E<code>False</code>\u4E3A\u629B\u51FA\u5F02\u5E38\uFF0C\u7B49\u6548\u4E8E<code>True</code>\u4E3A\u538B\u5236\u5F02\u5E38\uFF09</strong></li></ul><p><strong>\u4E24\u79CD\u8C03\u7528\u65B9\u6CD5</strong></p><details class="custom-container details"><summary>\u70B9\u51FB\u67E5\u770B\u5B8C\u6574\u4EE3\u7801</summary><div class="language-python ext-py"><pre class="language-python"><code><span class="token comment">#!/usr/bin/env python</span>
<span class="token comment"># -*- coding:utf-8-*-</span>

<span class="token keyword">class</span> <span class="token class-name">Demo</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__enter__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&#39;__enter__ called&#39;</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> self

    <span class="token keyword">def</span> <span class="token function">__exit__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> exc_type<span class="token punctuation">,</span> exc_val<span class="token punctuation">,</span> exc_tb<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&#39;__exit__ called&#39;</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">demo</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> self


<span class="token comment"># \u4F7F\u7528\u5B9E\u4F8B\u7684\u65B9\u5F0F\u8C03\u7528</span>
<span class="token keyword">with</span> Demo<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Class test&quot;</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&#39;-&#39;</span> <span class="token operator">*</span> <span class="token number">50</span><span class="token punctuation">)</span>

<span class="token comment"># \u4F7F\u7528\u5B9E\u4F8B\u65B9\u6CD5\u8C03\u7528</span>
<span class="token keyword">with</span> Demo<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>demo<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">as</span> c<span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Func test&quot;</span><span class="token punctuation">)</span>
</code></pre></div></details><p>\u8F93\u51FA\u7ED3\u679C</p><div class="language-bash ext-sh"><pre class="language-bash"><code>__enter__ called
Class <span class="token builtin class-name">test</span>
__exit__ called
--------------------------------------------------
__enter__ called
Func <span class="token builtin class-name">test</span>
__exit__ called
</code></pre></div><p><strong>\u5F02\u5E38\u629B\u51FA\u4E0E\u538B\u5236</strong></p><details class="custom-container details"><summary>\u70B9\u51FB\u67E5\u770B\u5B8C\u6574\u4EE3\u7801</summary><div class="language-python ext-py"><pre class="language-python"><code><span class="token comment">#!/usr/bin/env python</span>
<span class="token comment"># -*- coding:utf-8-*-</span>

<span class="token keyword">class</span> <span class="token class-name">Demo</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__enter__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&#39;__enter__ called&#39;</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> self

    <span class="token keyword">def</span> <span class="token function">__exit__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> exc_type<span class="token punctuation">,</span> exc_val<span class="token punctuation">,</span> exc_tb<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&#39;__exit__ called&#39;</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token boolean">True</span>  <span class="token comment"># \u538B\u5236\u5F02\u5E38(\u5982\u679C\u6709)</span>
        <span class="token comment"># return False  # \u629B\u51FA\u5F02\u5E38(\u5982\u679C\u6709), \u8FD9\u53E5\u4E5F\u53EF\u4EE5\u4E0D\u5199\uFF0C\u9ED8\u8BA4return None\u5C31\u7B49\u6548\u4E8EFalse</span>


<span class="token comment"># \u4F7F\u7528\u5B9E\u4F8B\u7684\u65B9\u5F0F\u8C03\u7528</span>
<span class="token keyword">with</span> Demo<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">as</span> a<span class="token punctuation">:</span>
    <span class="token keyword">raise</span> Exception<span class="token punctuation">(</span><span class="token string">&quot;error&quot;</span><span class="token punctuation">)</span>
</code></pre></div></details><h4 id="\u5B9E\u4F8B\u5C5E\u6027\u67E5\u627E" tabindex="-1"><a class="header-anchor" href="#\u5B9E\u4F8B\u5C5E\u6027\u67E5\u627E" aria-hidden="true">#</a> \u5B9E\u4F8B\u5C5E\u6027\u67E5\u627E</h4>`,12),tt=s("\u6587\u6863\uFF1A"),pt={href:"https://docs.python.org/zh-cn/3.10/reference/datamodel.html#object.__getattribute__",target:"_blank",rel:"noopener noreferrer"},ot=s("https://docs.python.org/zh-cn/3.10/reference/datamodel.html#object."),et=n("strong",null,"getattribute",-1),ct=p(`<p><strong>\u5B9E\u4F8B\u5C5E\u6027\u67E5\u627E\u987A\u5E8F\u5982\u4E0B</strong></p><p>\uFF081\uFF09\u4E3B\u8981\u987A\u5E8F</p><p>\u2460 \u8C03\u7528<code>__getattribute__(item)</code> --&gt; \u8FD4\u56DE\uFF08\u8BA1\u7B97\u540E\u7684\uFF09\u6B63\u5E38\u503C</p><p>\u2461 \u8C03\u7528<code>__getattribute__(item)</code> --&gt; \u8FD4\u56DE\uFF08\u8BA1\u7B97\u540E\u7684\uFF09\u5F02\u5E38\u503C<code>AttributeError</code> --&gt; \u5982\u679C\u5B9A\u4E49\u4E86<code>__getattr__</code>\u5219\u8C03\u7528\uFF0C\u5426\u5219\u7EE7\u7EED\u629B\u51FA\u539F\u6765\u7684<code>AttributeError</code></p><blockquote><p>\u6211\u4EEC\u53EF\u4EE5\u79F0<code>__getattribute__</code>\u4E3A\u5C5E\u6027\u62E6\u622A\u5668</p></blockquote><br><p>\uFF082\uFF09\u8BA1\u7B97\u540E\u7684\u503C\u5982\u4F55\u83B7\u5F97\uFF1F \u5B9E\u4F8B\u5B57\u5178 --&gt; \u7C7B\u5B57\u5178 --&gt; ... --&gt; \u76F4\u5230<code>object</code>\u7C7B\u5B57\u5178 --&gt; <code>object</code>\u629B\u51FA<code>AttributeError</code></p><br><p>\uFF083\uFF09\u6CE8\u610F\u4E8B\u9879</p><p>\u2460 <code>__getattribute__(item)</code>\u65B9\u6CD5\u4E2D\u4E0D\u80FD\u518D\u4F7F\u7528<code>self.x</code>\u3001<code>self.__dict__</code>\u7B49\u5C5E\u6027\uFF0C\u56E0\u4E3A\u8FD9\u4F1A\u9020\u6210\u65E0\u9650\u9012\u5F52</p><p>\u2461 <code>__getattr__</code>\u4E2D\u4E0D\u80FD\u518D\u4F7F\u7528<code>self.\u4E0D\u5B58\u5728\u7684\u5C5E\u6027</code>\uFF0C\u56E0\u4E3A\u8FD9\u540C\u6837\u4F1A\u9020\u6210\u65E0\u9650\u9012\u5F52</p><p>\u2462 <code>object</code>\u5BF9\u8C61\u6CA1\u6709<code>__getattr__</code>\u65B9\u6CD5\uFF0C\u6240\u4EE5\u6211\u4EEC\u4E0D\u80FD\u8C03\u7528\u7236\u7C7B\u6216object\u7684<code>__getattr__</code>\u65B9\u6CD5</p><br><p><strong>\u5B9E\u4F8B\u5C5E\u6027\u67E5\u627E-\u6B63\u5E38\u503C\u793A\u4F8B</strong></p><details class="custom-container details"><summary>\u70B9\u51FB\u67E5\u770B\u5B8C\u6574\u4EE3\u7801</summary><div class="language-python ext-py"><pre class="language-python"><code><span class="token comment">#!/usr/bin/env python</span>
<span class="token comment"># -*- coding:utf-8-*-</span>

<span class="token keyword">class</span> <span class="token class-name">Person</span><span class="token punctuation">:</span>
    
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>name <span class="token operator">=</span> name

    <span class="token keyword">def</span> <span class="token function">getName</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> self<span class="token punctuation">.</span>name

    <span class="token keyword">def</span> <span class="token function">__getattribute__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> item<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;Called __getattribute__(</span><span class="token interpolation"><span class="token punctuation">{</span>item<span class="token punctuation">}</span></span><span class="token string">)&quot;</span></span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token builtin">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__getattribute__<span class="token punctuation">(</span>item<span class="token punctuation">)</span>


<span class="token comment"># \u5B9E\u4F8B\u5316\u5BF9\u8C61</span>
person <span class="token operator">=</span> Person<span class="token punctuation">(</span><span class="token string">&quot;bob&quot;</span><span class="token punctuation">)</span>

<span class="token comment"># \u5B9E\u4F8B\u5C5E\u6027\u67E5\u627E-1</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>person<span class="token punctuation">.</span>name<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;-&quot;</span> <span class="token operator">*</span> <span class="token number">30</span><span class="token punctuation">)</span>
<span class="token comment"># Called __getattribute__(name)</span>
<span class="token comment"># bob</span>

<span class="token comment"># \u5B9E\u4F8B\u5C5E\u6027\u67E5\u627E-2</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>person<span class="token punctuation">.</span>getName<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># Called __getattribute__(getName)</span>
<span class="token comment"># Called __getattribute__(name)</span>
<span class="token comment"># bob</span>
</code></pre></div></details><p><strong>\u5B9E\u4F8B\u5C5E\u6027\u67E5\u627E-AttributeError\u793A\u4F8B</strong></p><details class="custom-container details"><summary>\u70B9\u51FB\u67E5\u770B\u5B8C\u6574\u4EE3\u7801</summary><div class="language-python ext-py"><pre class="language-python"><code><span class="token comment">#!/usr/bin/env python</span>
<span class="token comment"># -*- coding:utf-8-*-</span>

<span class="token keyword">class</span> <span class="token class-name">Person</span><span class="token punctuation">:</span>

    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>name <span class="token operator">=</span> name

    <span class="token keyword">def</span> <span class="token function">getName</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> self<span class="token punctuation">.</span>name

    <span class="token keyword">def</span> <span class="token function">__getattribute__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> item<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;Called __getattribute__(</span><span class="token interpolation"><span class="token punctuation">{</span>item<span class="token punctuation">}</span></span><span class="token string">)&quot;</span></span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token builtin">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__getattribute__<span class="token punctuation">(</span>item<span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">__getattr__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> item<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># object\u5BF9\u8C61\u6CA1\u6709__getattr__\u65B9\u6CD5, \u4E0D\u80FD\u4F7F\u7528super</span>
        <span class="token keyword">return</span> <span class="token string-interpolation"><span class="token string">f&quot;\u5B9E\u4F8B\u5BF9\u8C61</span><span class="token interpolation"><span class="token punctuation">{</span>self<span class="token punctuation">.</span>__class__<span class="token punctuation">.</span>__name__<span class="token punctuation">}</span></span><span class="token string">\u4E0D\u5B58\u5728</span><span class="token interpolation"><span class="token punctuation">{</span>item<span class="token punctuation">}</span></span><span class="token string">\u5C5E\u6027&quot;</span></span>


<span class="token comment"># \u5B9E\u4F8B\u5316\u5BF9\u8C61</span>
person <span class="token operator">=</span> Person<span class="token punctuation">(</span><span class="token string">&quot;bob&quot;</span><span class="token punctuation">)</span>

<span class="token comment"># \u5B9E\u4F8B\u5C5E\u6027\u67E5\u627E</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>person<span class="token punctuation">.</span>abc<span class="token punctuation">)</span>
</code></pre></div></details><p>\u8F93\u51FA\u7ED3\u679C</p><div class="language-bash ext-sh"><pre class="language-bash"><code>Called __getattribute__<span class="token punctuation">(</span>abc<span class="token punctuation">)</span>
Called __getattribute__<span class="token punctuation">(</span>__class__<span class="token punctuation">)</span>
\u5B9E\u4F8B\u5BF9\u8C61Person\u4E0D\u5B58\u5728abc\u5C5E\u6027
</code></pre></div><h4 id="\u63CF\u8FF0\u5668" tabindex="-1"><a class="header-anchor" href="#\u63CF\u8FF0\u5668" aria-hidden="true">#</a> \u63CF\u8FF0\u5668</h4><h5 id="\u63CF\u8FF0\u5668\u5B9A\u4E49" tabindex="-1"><a class="header-anchor" href="#\u63CF\u8FF0\u5668\u5B9A\u4E49" aria-hidden="true">#</a> \u63CF\u8FF0\u5668\u5B9A\u4E49</h5><p>\u5982\u679C\u5B9E\u73B0\u4E86<code>__get__</code>\u3001<code>__set__</code> \u3001<code>__delete__</code>\u4E2D\u7684\u4EFB\u4F55\u4E00\u4E2A\uFF0C\u5C31\u5B9E\u73B0\u4E86\u63CF\u8FF0\u5668\u5B9A\u4E49</p><p>\u5982\u679C\u53EA\u5B9E\u73B0\u4E86<code>__get__</code>\uFF0C\u90A3\u4E48\u5C31\u662F\u975E\u6570\u636E\u63CF\u8FF0\u5668\uFF1B</p><p>\u5982\u679C\u5B9E\u73B0\u4E86<code>__get__</code>\u548C<code>__set__</code> \u6216 <code>__get__</code>\u548C<code>__delete__</code> \uFF0C\u90A3\u4E48\u5C31\u662F\u6570\u636E\u63CF\u8FF0\u5668</p><h5 id="\u975E\u6570\u636E\u63CF\u8FF0\u5668\u793A\u4F8B" tabindex="-1"><a class="header-anchor" href="#\u975E\u6570\u636E\u63CF\u8FF0\u5668\u793A\u4F8B" aria-hidden="true">#</a> \u975E\u6570\u636E\u63CF\u8FF0\u5668\u793A\u4F8B</h5><details class="custom-container details"><summary>\u70B9\u51FB\u67E5\u770B\u5B8C\u6574\u4EE3\u7801</summary><div class="language-python ext-py"><pre class="language-python"><code><span class="token comment">#!/usr/bin/env python</span>
<span class="token comment"># -*- coding:utf-8-*-</span>

<span class="token keyword">class</span> <span class="token class-name">A</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">&#39;&#39;&#39;\u63CF\u8FF0\u5668\u5B9A\u4E49&#39;&#39;&#39;</span>

    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Class A().__init__ called&quot;</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>x <span class="token operator">=</span> x

    <span class="token keyword">def</span> <span class="token function">__get__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> instance<span class="token punctuation">,</span> owner<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">&quot;&quot;&quot;
        self: A\u7684\u5B9E\u4F8B\u5BF9\u8C61
        instance: B\u7684\u5B9E\u4F8B\u5BF9\u8C61
        owner: B\u7C7B\u5BF9\u8C61
        &quot;&quot;&quot;</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Class A().__get__ called&quot;</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> instance<span class="token punctuation">,</span> owner<span class="token punctuation">)</span>
        <span class="token keyword">return</span> self


<span class="token keyword">class</span> <span class="token class-name">B</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">&quot;&quot;&quot;
    \u63CF\u8FF0\u5668\u4F7F\u7528
        \u7C7B\u5C5E\u6027\u4E3A \u53E6\u4E00\u4E2A\u7C7B\u7684\u5B9E\u4F8B\uFF0C\u4E14\u53E6\u4E00\u4E2A\u7C7B\u5B9A\u4E49\u4E86\u63CF\u8FF0\u5668
        \u4E0B\u9762\u7684 x \u5C31\u662F\u4E00\u4E2A\u63CF\u8FF0\u5668
    &quot;&quot;&quot;</span>
    x <span class="token operator">=</span> A<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Class B().__init__ called&quot;</span><span class="token punctuation">)</span>


<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&#39;--&gt; 1&#39;</span><span class="token punctuation">)</span>
b <span class="token operator">=</span> B<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&#39;--&gt; 2&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>b<span class="token punctuation">.</span>x<span class="token punctuation">)</span>
</code></pre></div></details><p>\u8F93\u51FA\u7ED3\u679C</p><div class="language-bash ext-sh"><pre class="language-bash"><code>Class A<span class="token punctuation">(</span><span class="token punctuation">)</span>.__init__ called
--<span class="token operator">&gt;</span> <span class="token number">1</span>
Class B<span class="token punctuation">(</span><span class="token punctuation">)</span>.__init__ called
--<span class="token operator">&gt;</span> <span class="token number">2</span>
Class A<span class="token punctuation">(</span><span class="token punctuation">)</span>.__get__ called
<span class="token operator">&lt;</span>__main__.A object at 0x000002AD2912EB4<span class="token operator"><span class="token file-descriptor important">8</span>&gt;</span> <span class="token operator">&lt;</span>__main__.B object at 0x000002AD2912EB8<span class="token operator"><span class="token file-descriptor important">8</span>&gt;</span> <span class="token operator">&lt;</span>class <span class="token string">&#39;__main__.B&#39;</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>__main__.A object at 0x000002AD2912EB4<span class="token operator"><span class="token file-descriptor important">8</span>&gt;</span>
</code></pre></div><h5 id="\u975E\u6570\u636E\u63CF\u8FF0\u5668\u5E94\u7528" tabindex="-1"><a class="header-anchor" href="#\u975E\u6570\u636E\u63CF\u8FF0\u5668\u5E94\u7528" aria-hidden="true">#</a> \u975E\u6570\u636E\u63CF\u8FF0\u5668\u5E94\u7528</h5><p>\u5B9E\u73B0<code>@classmethod</code>\u3001<code>@staticmethod</code>\u3001<code>@property</code>\u88C5\u9970\u5668</p><details class="custom-container details"><summary>\u70B9\u51FB\u67E5\u770B\u5B8C\u6574\u4EE3\u7801</summary><div class="language-python ext-py"><pre class="language-python"><code><span class="token comment">#!/usr/bin/env python</span>
<span class="token comment"># -*- coding:utf-8-*-</span>

<span class="token keyword">from</span> functools <span class="token keyword">import</span> partial


<span class="token keyword">class</span> <span class="token class-name">StaticMethod</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> fn<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>fn <span class="token operator">=</span> fn

    <span class="token keyword">def</span> <span class="token function">__get__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> instance<span class="token punctuation">,</span> owner<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> self<span class="token punctuation">.</span>fn


<span class="token keyword">class</span> <span class="token class-name">ClassMethod</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> fn<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>fn <span class="token operator">=</span> fn

    <span class="token keyword">def</span> <span class="token function">__get__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> instance<span class="token punctuation">,</span> owner<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> partial<span class="token punctuation">(</span>self<span class="token punctuation">.</span>fn<span class="token punctuation">,</span> owner<span class="token punctuation">)</span>


<span class="token keyword">class</span> <span class="token class-name">Property</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> fn<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>fn <span class="token operator">=</span> fn

    <span class="token keyword">def</span> <span class="token function">__get__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> instance<span class="token punctuation">,</span> owner<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> self<span class="token punctuation">.</span>fn<span class="token punctuation">(</span>instance<span class="token punctuation">)</span>


<span class="token keyword">class</span> <span class="token class-name">A</span><span class="token punctuation">:</span>
    <span class="token decorator annotation punctuation">@classmethod</span>
    <span class="token comment"># @ClassMethod  # c_method = ClassMethod(c_method)</span>
    <span class="token keyword">def</span> <span class="token function">class_methd</span><span class="token punctuation">(</span>cls<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;class method&quot;</span><span class="token punctuation">)</span>

    <span class="token comment"># @staticmethod</span>
    <span class="token decorator annotation punctuation">@StaticMethod</span>  <span class="token comment"># s_method = StaticMethod(s_method)</span>
    <span class="token keyword">def</span> <span class="token function">static_method</span><span class="token punctuation">(</span><span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;static method&quot;</span><span class="token punctuation">)</span>

    <span class="token comment"># @property</span>
    <span class="token decorator annotation punctuation">@Property</span>
    <span class="token keyword">def</span> <span class="token function">ping</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token string">&quot;pong&quot;</span>


A<span class="token punctuation">.</span>class_methd<span class="token punctuation">(</span><span class="token punctuation">)</span>
A<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>static_method<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>A<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>ping<span class="token punctuation">)</span>
</code></pre></div></details><p>\u8F93\u51FA\u7ED3\u679C</p><div class="language-bash ext-sh"><pre class="language-bash"><code>class method
static method
pongclass method
static method
</code></pre></div><h4 id="\u8FD0\u7B97\u7B26\u91CD\u8F7D" tabindex="-1"><a class="header-anchor" href="#\u8FD0\u7B97\u7B26\u91CD\u8F7D" aria-hidden="true">#</a> \u8FD0\u7B97\u7B26\u91CD\u8F7D</h4>`,34),lt=s("\u6587\u6863\uFF1A"),ut={href:"https://docs.python.org/zh-cn/3.10/reference/datamodel.html#emulating-numeric-types",target:"_blank",rel:"noopener noreferrer"},it=s("https://docs.python.org/zh-cn/3.10/reference/datamodel.html#emulating-numeric-types"),kt=p(`<p>\u793A\u4F8B</p><details class="custom-container details"><summary>\u70B9\u51FB\u67E5\u770B\u5B8C\u6574\u4EE3\u7801</summary><div class="language-python ext-py"><pre class="language-python"><code><span class="token comment">#!/usr/bin/env python</span>
<span class="token comment"># -*- coding:utf-8-*-</span>

<span class="token keyword">from</span> functools <span class="token keyword">import</span> total_ordering


<span class="token comment"># __lt__\u3001__le__\u3001__gt__\u3001__ge__\u5168\u90E8\u5199\u5B8C\u7684\u8BDD\u592A\u9EBB\u70E6\uFF0C\u4F7F\u7528total_ordering\u88C5\u9970\u5668\u540E\uFF0C\u53EA\u9700\u8981\u5B9E\u73B0\u5176\u4E2D\u4E00\u79CD\u5373\u53EF\uFF1B</span>
<span class="token comment"># \u4F46\u662F\u5982\u9700\u4E0D\u9700\u8981\u6700\u597D\u4E0D\u8981\u52A0\u8FD9\u4E2A\u88C5\u9970\u5668\uFF0C\u56E0\u4E3A\u53EF\u80FD\u5E26\u6765\u6027\u80FD\u95EE\u9898</span>

<span class="token decorator annotation punctuation">@total_ordering</span>
<span class="token keyword">class</span> <span class="token class-name">Point</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>x <span class="token operator">=</span> x
        self<span class="token punctuation">.</span>y <span class="token operator">=</span> y

    <span class="token keyword">def</span> <span class="token function">__hash__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token builtin">hash</span><span class="token punctuation">(</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>x<span class="token punctuation">,</span> self<span class="token punctuation">.</span>y<span class="token punctuation">)</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">__eq__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> other<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> self<span class="token punctuation">.</span>x <span class="token operator">==</span> other<span class="token punctuation">.</span>x <span class="token keyword">and</span> self<span class="token punctuation">.</span>y <span class="token operator">==</span> other<span class="token punctuation">.</span>y

    <span class="token keyword">def</span> <span class="token function">__repr__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token string-interpolation"><span class="token string">f&quot;&lt;Point (</span><span class="token interpolation"><span class="token punctuation">{</span>self<span class="token punctuation">.</span>x<span class="token punctuation">}</span></span><span class="token string">, </span><span class="token interpolation"><span class="token punctuation">{</span>self<span class="token punctuation">.</span>y<span class="token punctuation">}</span></span><span class="token string">)&gt;&quot;</span></span>

    <span class="token keyword">def</span> <span class="token function">__add__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> other<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> Point<span class="token punctuation">(</span>self<span class="token punctuation">.</span>x <span class="token operator">+</span> other<span class="token punctuation">.</span>x<span class="token punctuation">,</span> self<span class="token punctuation">.</span>y <span class="token operator">+</span> other<span class="token punctuation">.</span>y<span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">__iadd__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> other<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> Point<span class="token punctuation">(</span>self<span class="token punctuation">.</span>x <span class="token operator">+</span> other<span class="token punctuation">.</span>x<span class="token punctuation">,</span> self<span class="token punctuation">.</span>y <span class="token operator">+</span> other<span class="token punctuation">.</span>y<span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">__gt__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> other<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> self<span class="token punctuation">.</span>x <span class="token operator">&gt;</span> other<span class="token punctuation">.</span>x


<span class="token comment"># \u5B9E\u4F8B\u5316</span>
p1 <span class="token operator">=</span> Point<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
p2 <span class="token operator">=</span> Point<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>

<span class="token comment"># \u652F\u6301+ +=\u7B49\u8FD0\u7B97\u7B26</span>
p3 <span class="token operator">=</span> p1 <span class="token operator">+</span> p2
p1 <span class="token operator">+=</span> p2
<span class="token keyword">print</span><span class="token punctuation">(</span>p1 <span class="token operator">==</span> p3<span class="token punctuation">)</span>

<span class="token comment"># \u53EF\u54C8\u5E0C,\u53EF\u4F5C\u4E3Adict/set\u7B49\u7684key</span>
d <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
d<span class="token punctuation">[</span>p3<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&quot;p3&quot;</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span>
</code></pre></div></details><p>\u8F93\u51FA\u7ED3\u679C</p><div class="language-bash ext-sh"><pre class="language-bash"><code>True
<span class="token punctuation">{</span><span class="token operator">&lt;</span>Point <span class="token punctuation">(</span><span class="token number">2</span>, <span class="token number">5</span><span class="token punctuation">)</span><span class="token operator">&gt;</span>: <span class="token string">&#39;p3&#39;</span><span class="token punctuation">}</span>
</code></pre></div><p><strong>pathlib\u4E2D\u7684\u8FD0\u7B97\u7B26\u91CD\u8F7D</strong></p><div class="language-python ext-py"><pre class="language-python"><code><span class="token comment">#!/usr/bin/env python</span>
<span class="token comment"># -*- coding:utf-8-*-</span>

<span class="token keyword">from</span> pathlib <span class="token keyword">import</span> Path

host1 <span class="token operator">=</span> Path<span class="token punctuation">(</span><span class="token string">&quot;C:\\Windows\\System32\\drivers\\etc&quot;</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token string">&quot;hosts&quot;</span>
host2 <span class="token operator">=</span> Path<span class="token punctuation">(</span><span class="token string">&quot;C:\\Windows\\System32\\drivers\\etc&quot;</span><span class="token punctuation">)</span> <span class="token operator">/</span> Path<span class="token punctuation">(</span><span class="token string">&quot;hosts&quot;</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>host1<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>host1<span class="token punctuation">.</span>exists<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>host2<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>host2<span class="token punctuation">.</span>exists<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># C:\\Windows\\System32\\drivers\\etc\\hosts</span>
<span class="token comment"># True</span>
<span class="token comment"># C:\\Windows\\System32\\drivers\\etc\\hosts</span>
<span class="token comment"># True</span>
</code></pre></div><h3 id="\u5143\u7C7B" tabindex="-1"><a class="header-anchor" href="#\u5143\u7C7B" aria-hidden="true">#</a> \u5143\u7C7B</h3><p><strong>\u6587\u6863</strong></p>`,8),rt=s("\uFF081\uFF09"),dt={href:"https://docs.python.org/zh-cn/3.10/library/functions.html#type",target:"_blank",rel:"noopener noreferrer"},mt=s("https://docs.python.org/zh-cn/3.10/library/functions.html#type"),gt=s("\uFF082\uFF09"),ht={href:"https://docs.python.org/zh-cn/3.10/reference/datamodel.html#metaclasses",target:"_blank",rel:"noopener noreferrer"},yt=s("https://docs.python.org/zh-cn/3.10/reference/datamodel.html#metaclasses"),_t=p(`<p>\u5143\u7C7B\u5C31\u662F\u521B\u5EFA\u7C7B\u7684\u7C7B\uFF0Ctype\u9664\u4E86\u53EF\u4EE5\u67E5\u770B\u5BF9\u8C61\u7C7B\u578B\uFF0C\u8FD8\u662F\u5185\u7F6E\u7684\u5143\u7C7B</p><p><strong>\u4F7F\u7528\u5185\u7F6E\u5143\u7C7Btype\u521B\u5EFA\u7C7B</strong></p><p>\u793A\u4F8B\u4EE3\u7801</p><details class="custom-container details"><summary>\u70B9\u51FB\u67E5\u770B\u5B8C\u6574\u4EE3\u7801</summary><div class="language-python ext-py"><pre class="language-python"><code><span class="token comment">#!/usr/bin/env python</span>
<span class="token comment"># -*- coding:utf-8-*-</span>


<span class="token comment"># \u65B9\u5F0F\u4E00\uFF1A\u4F7F\u7528class\u5B9A\u4E49\u7C7B</span>
<span class="token keyword">class</span> <span class="token class-name">A</span><span class="token punctuation">:</span>
    x <span class="token operator">=</span> <span class="token number">800</span>


<span class="token comment"># \u65B9\u5F0F\u4E8C\uFF1A\u4F7F\u7528type\u7C7B\u521B\u5EFA\u7C7B</span>
<span class="token comment"># \u8BED\u6CD5\uFF1Atype(\u7C7B\u540D\uFF0C\u7EE7\u7EED\u7684\u7236\u7C7B\u5143\u7EC4(\u53EF\u4EE5\u4E3A\u7A7A)\uFF0C \u5C5E\u6027\u5B57\u5178)</span>
B <span class="token operator">=</span> <span class="token builtin">type</span><span class="token punctuation">(</span><span class="token string">&quot;B&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token string">&quot;x&quot;</span><span class="token punctuation">:</span> <span class="token number">800</span><span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>A<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>B<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token punctuation">(</span>A<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token punctuation">(</span>B<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>A<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>x<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>B<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>x<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>A<span class="token punctuation">.</span>mro<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>B<span class="token punctuation">.</span>mro<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div></details><p>\u8F93\u51FA\u7ED3\u679C</p><div class="language-bash ext-sh"><pre class="language-bash"><code><span class="token operator">&lt;</span>class <span class="token string">&#39;__main__.A&#39;</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>class <span class="token string">&#39;__main__.B&#39;</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>class <span class="token string">&#39;type&#39;</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>class <span class="token string">&#39;type&#39;</span><span class="token operator">&gt;</span>
<span class="token number">800</span>
<span class="token number">800</span>
<span class="token punctuation">[</span><span class="token operator">&lt;</span>class <span class="token string">&#39;__main__.A&#39;</span><span class="token operator">&gt;</span>, <span class="token operator">&lt;</span>class <span class="token string">&#39;object&#39;</span><span class="token operator">&gt;</span><span class="token punctuation">]</span>
<span class="token punctuation">[</span><span class="token operator">&lt;</span>class <span class="token string">&#39;__main__.B&#39;</span><span class="token operator">&gt;</span>, <span class="token operator">&lt;</span>class <span class="token string">&#39;object&#39;</span><span class="token operator">&gt;</span><span class="token punctuation">]</span>
</code></pre></div><p><strong>\u81EA\u5B9A\u4E49\u5143\u7C7B</strong></p><details class="custom-container details"><summary>\u70B9\u51FB\u67E5\u770B\u5B8C\u6574\u4EE3\u7801</summary><div class="language-python ext-py"><pre class="language-python"><code><span class="token comment">#!/usr/bin/env python</span>
<span class="token comment"># -*- coding:utf-8-*-</span>


<span class="token comment"># \u4E0B\u9762\u4E24\u6BB5\u4EE3\u7801\u5176\u5B9E\u662F\u4E00\u6837\u7684\uFF08\u9664\u4E86\u7C7B\u540D\u4E0D\u4E00\u6837\uFF09\uFF0Cmetaclass\u6307\u5B9A\u4E86\u5143\u7C7B\u662F\u8C01</span>
<span class="token comment"># class A:</span>
<span class="token comment">#     x = 800</span>
<span class="token comment">#</span>
<span class="token comment">#</span>
<span class="token comment"># class B(metaclass=type):</span>
<span class="token comment">#     x = 800</span>


<span class="token comment"># \u5B9A\u4E49\u81EA\u5DF1\u7684\u5143\u7C7B</span>
<span class="token keyword">class</span> <span class="token class-name">MetaClass</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># \u81EA\u5B9A\u4E49\u5143\u7C7B\u5FC5\u987B\u8981\u7EE7\u627Ftype</span>
    <span class="token keyword">def</span> <span class="token function">__new__</span><span class="token punctuation">(</span>cls<span class="token punctuation">,</span> name<span class="token punctuation">,</span> bases<span class="token punctuation">,</span> attrs<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Metaclass.__new__ called&quot;</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token builtin">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__new__<span class="token punctuation">(</span>cls<span class="token punctuation">,</span> name<span class="token punctuation">,</span> bases<span class="token punctuation">,</span> attrs<span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> name<span class="token punctuation">,</span> bases<span class="token punctuation">,</span> attrs<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Metaclass.__init__ called&quot;</span><span class="token punctuation">)</span>
        <span class="token builtin">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span>name<span class="token punctuation">,</span> bases<span class="token punctuation">,</span> attrs<span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">__call__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> <span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Metaclass.__call__ called&quot;</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token builtin">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__call__<span class="token punctuation">(</span><span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span>


<span class="token keyword">class</span> <span class="token class-name">B</span><span class="token punctuation">(</span>metaclass<span class="token operator">=</span>MetaClass<span class="token punctuation">)</span><span class="token punctuation">:</span>
    f <span class="token operator">=</span> <span class="token string">&quot;2&quot;</span>

    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;B.__init__ called&quot;</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>name <span class="token operator">=</span> name


b <span class="token operator">=</span> B<span class="token punctuation">(</span><span class="token string">&quot;\u5C0FB&quot;</span><span class="token punctuation">)</span>
</code></pre></div></details><p>\u8F93\u51FA\u7ED3\u679C</p><div class="language-python ext-py"><pre class="language-python"><code>Metaclass<span class="token punctuation">.</span>__new__ called
Metaclass<span class="token punctuation">.</span>__init__ called
Metaclass<span class="token punctuation">.</span>__call__ called
B<span class="token punctuation">.</span>__init__ called
</code></pre></div><p><strong>\u4F7F\u7528\u5143\u7C7B\u521B\u5EFA\u5355\u4F8B\u7C7B</strong></p><details class="custom-container details"><summary>\u70B9\u51FB\u67E5\u770B\u5B8C\u6574\u4EE3\u7801</summary><div class="language-python ext-py"><pre class="language-python"><code><span class="token comment">#!/usr/bin/env python</span>
<span class="token comment"># -*- coding:utf-8-*-</span>


<span class="token keyword">import</span> threading
<span class="token keyword">import</span> time


<span class="token keyword">class</span> <span class="token class-name">MetaSingle</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    _instance_lock <span class="token operator">=</span> threading<span class="token punctuation">.</span>Lock<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">__call__</span><span class="token punctuation">(</span>cls<span class="token punctuation">,</span> <span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">&#39;&#39;&#39;
        \u4E0B\u9762Single\u7C7B\u5B9E\u4F8B\u5316\u8FC7\u7A0B\u5176\u5B9E\u5C31\u7B49\u4E8E\u5143\u7C7B\u7684__call__\u8C03\u7528\u8FC7\u7A0B\uFF0C\u539F\u7406\u5982\u4E0B\uFF1A

            \uFF081\uFF09Single   = MetaSingle(&quot;Single&quot;, (), {})
            \uFF082\uFF09Single() = MetaSingle(&quot;Single&quot;, (), {})()
        &#39;&#39;&#39;</span>
        <span class="token keyword">if</span> <span class="token keyword">not</span> <span class="token builtin">hasattr</span><span class="token punctuation">(</span>cls<span class="token punctuation">,</span> <span class="token string">&quot;_instance&quot;</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">with</span> cls<span class="token punctuation">.</span>_instance_lock<span class="token punctuation">:</span>
                time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">0.1</span><span class="token punctuation">)</span>  <span class="token comment"># \u8FD9\u91CC\u662F\u4E3A\u4E86\u6D4B\u8BD5\u4F7F\u7528</span>
                <span class="token keyword">if</span> <span class="token keyword">not</span> <span class="token builtin">hasattr</span><span class="token punctuation">(</span>cls<span class="token punctuation">,</span> <span class="token string">&quot;_instance&quot;</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                    cls<span class="token punctuation">.</span>_instance <span class="token operator">=</span> <span class="token builtin">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__call__<span class="token punctuation">(</span><span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span>
        <span class="token keyword">return</span> cls<span class="token punctuation">.</span>_instance


<span class="token keyword">class</span> <span class="token class-name">Single</span><span class="token punctuation">(</span>metaclass<span class="token operator">=</span>MetaSingle<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>name <span class="token operator">=</span> name


<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    threading<span class="token punctuation">.</span>Thread<span class="token punctuation">(</span>target<span class="token operator">=</span><span class="token keyword">lambda</span><span class="token punctuation">:</span> <span class="token keyword">print</span><span class="token punctuation">(</span>Single<span class="token punctuation">(</span><span class="token string">&quot;a&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div></details><p>\u8F93\u51FA\u7ED3\u679C</p><div class="language-bash ext-sh"><pre class="language-bash"><code><span class="token operator">&lt;</span>__main__.Single object at 0x000001D92436EE4<span class="token operator"><span class="token file-descriptor important">8</span>&gt;</span>
<span class="token operator">&lt;</span>__main__.Single object at 0x000001D92436EE4<span class="token operator"><span class="token file-descriptor important">8</span>&gt;</span>
<span class="token operator">&lt;</span>__main__.Single object at 0x000001D92436EE4<span class="token operator"><span class="token file-descriptor important">8</span>&gt;</span>
<span class="token operator">&lt;</span>__main__.Single object at 0x000001D92436EE4<span class="token operator"><span class="token file-descriptor important">8</span>&gt;</span>
<span class="token operator">&lt;</span>__main__.Single object at 0x000001D92436EE4<span class="token operator"><span class="token file-descriptor important">8</span>&gt;</span>
<span class="token operator">&lt;</span>__main__.Single object at 0x000001D92436EE4<span class="token operator"><span class="token file-descriptor important">8</span>&gt;</span>
<span class="token operator">&lt;</span>__main__.Single object at 0x000001D92436EE4<span class="token operator"><span class="token file-descriptor important">8</span>&gt;</span>
<span class="token operator">&lt;</span>__main__.Single object at 0x000001D92436EE4<span class="token operator"><span class="token file-descriptor important">8</span>&gt;</span>
<span class="token operator">&lt;</span>__main__.Single object at 0x000001D92436EE4<span class="token operator"><span class="token file-descriptor important">8</span>&gt;</span>
<span class="token operator">&lt;</span>__main__.Single object at 0x000001D92436EE4<span class="token operator"><span class="token file-descriptor important">8</span>&gt;</span>
</code></pre></div><h3 id="\u62BD\u8C61\u7C7B" tabindex="-1"><a class="header-anchor" href="#\u62BD\u8C61\u7C7B" aria-hidden="true">#</a> \u62BD\u8C61\u7C7B</h3><p>\u62BD\u8C61\u7C7B\u5C31\u662F\u63D0\u53D6\u4E00\u5BF9\u7C7B\u7684\u5171\u540C\u7279\u5F81\uFF0C\u62BD\u8C61\u79F0\u4E00\u4E2A\u7C7B</p><p>\u62BD\u8C61\u7C7B\u4E0D\u80FD\u5355\u72EC\u5B9E\u4F8B\u5316\u3001\u6267\u884C\uFF0C\u5FC5\u987B\u7531\u5176\u4ED6\u7C7B\u7EE7\u627F</p><p>\u6240\u6709\u7C7B\u90FD\u8981\u7EE7\u627F\u81EA\u62BD\u8C61\u7C7B\uFF0C\u62BD\u8C61\u7C7B\u63D0\u4F9B\u7684\u65B9\u6CD5\u5FC5\u987B\u5B9E\u73B0\uFF0C\u5426\u5219\u4F1A\u62A5\u9519</p><p>\u793A\u4F8B\u4EE3\u7801</p><div class="language-python ext-py"><pre class="language-python"><code><span class="token comment">#!/usr/bin/env python</span>
<span class="token comment"># -*- coding:utf-8-*-</span>

<span class="token keyword">from</span> abc <span class="token keyword">import</span> ABCMeta<span class="token punctuation">,</span> abstractmethod


<span class="token keyword">class</span> <span class="token class-name">A</span><span class="token punctuation">(</span>metaclass<span class="token operator">=</span>ABCMeta<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token decorator annotation punctuation">@abstractmethod</span>
    <span class="token keyword">def</span> <span class="token function">read</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">pass</span>

    <span class="token decorator annotation punctuation">@abstractmethod</span>
    <span class="token keyword">def</span> <span class="token function">write</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">pass</span>


<span class="token keyword">class</span> <span class="token class-name">B</span><span class="token punctuation">(</span>A<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">&#39;&#39;&#39;\u5FC5\u987B\u5B9E\u73B0read\u548Cwrite\u65B9\u6CD5\uFF0C\u5426\u5219\u4F1A\u62A5\u9519, \u6BD4\u5982\uFF1A TypeError: Can&#39;t instantiate abstract class B with abstract methods write&#39;&#39;&#39;</span>

    <span class="token keyword">def</span> <span class="token function">read</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">pass</span>

    <span class="token keyword">def</span> <span class="token function">write</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">pass</span>


b <span class="token operator">=</span> B<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div>`,20);function bt(ft,wt){const a=e("ExternalLinkIcon");return c(),l("div",null,[i,n("p",null,[k,n("a",r,[d,t(a)])]),m,n("p",null,[g,n("a",h,[y,t(a)])]),_,b,f,w,n("p",null,[q,n("a",x,[v,t(a)])]),T,n("p",null,[C,n("a",P,[F,t(a)])]),N,n("p",null,[E,n("a",A,[M,t(a)])]),O,n("p",null,[j,n("a",R,[z,t(a)])]),I,n("table",null,[S,n("tbody",null,[n("tr",null,[B,L,n("td",null,[n("a",D,[U,t(a)])]),V]),n("tr",null,[W,H,n("td",null,[n("a",J,[G,t(a)])]),Y]),n("tr",null,[K,Q,n("td",null,[n("a",$,[Z,t(a)])]),X]),n("tr",null,[nn,sn,n("td",null,[n("a",an,[tn,t(a)]),pn,n("a",on,[en,t(a)])]),cn])])]),ln,un,n("p",null,[kn,n("a",rn,[dn,t(a)])]),mn,n("p",null,[gn,n("a",hn,[yn,t(a)])]),_n,n("p",null,[bn,n("a",fn,[wn,t(a)])]),n("p",null,[qn,n("a",xn,[vn,t(a)])]),Tn,n("p",null,[Cn,n("a",Pn,[Fn,t(a)])]),Nn,n("p",null,[En,n("a",An,[Mn,t(a)])]),On,n("p",null,[jn,n("a",Rn,[zn,t(a)])]),In,n("p",null,[Sn,n("a",Bn,[Ln,t(a)])]),Dn,n("p",null,[Un,n("a",Vn,[Wn,t(a)])]),Hn,n("p",null,[Jn,n("a",Gn,[Yn,t(a)])]),Kn,n("p",null,[Qn,n("a",$n,[Zn,t(a)])]),Xn,n("p",null,[ns,n("a",ss,[as,t(a)])]),ts,n("p",null,[ps,n("a",os,[es,t(a)])]),cs,n("p",null,[ls,n("a",us,[is,ks,rs,ds,ms,t(a)])]),gs,n("p",null,[hs,n("a",ys,[_s,t(a)])]),bs,n("p",null,[fs,n("a",ws,[qs,t(a)])]),xs,n("p",null,[vs,n("a",Ts,[Cs,t(a)])]),n("p",null,[Ps,n("a",Fs,[Ns,t(a)]),Es,As,Ms]),Os,js,Rs,n("p",null,[zs,n("a",Is,[Ss,t(a)])]),Bs,n("p",null,[Ls,n("a",Ds,[Us,t(a)])]),Vs,n("p",null,[Ws,n("a",Hs,[Js,t(a)])]),Gs,n("p",null,[Ys,n("a",Ks,[Qs,t(a)]),$s]),Zs,Xs,na,sa,n("p",null,[aa,n("a",ta,[pa,t(a)]),oa]),ea,n("p",null,[ca,n("a",la,[ua,t(a)])]),ia,n("p",null,[ka,n("a",ra,[da,t(a)]),ma]),ga,n("p",null,[ha,n("a",ya,[_a,t(a)])]),ba,n("p",null,[fa,n("a",wa,[qa,xa,t(a)])]),va,n("p",null,[Ta,n("a",Ca,[Pa,Fa,t(a)])]),Na,n("p",null,[Ea,n("a",Aa,[Ma,Oa,t(a)])]),ja,n("p",null,[n("a",Ra,[za,Ia,t(a)])]),Sa,n("p",null,[Ba,n("a",La,[Da,Ua,t(a)])]),Va,n("p",null,[Wa,n("a",Ha,[Ja,Ga,t(a)])]),Ya,n("p",null,[Ka,n("a",Qa,[$a,t(a)])]),n("p",null,[Za,n("a",Xa,[nt,st,t(a)])]),at,n("p",null,[tt,n("a",pt,[ot,et,t(a)])]),ct,n("p",null,[lt,n("a",ut,[it,t(a)])]),kt,n("p",null,[rt,n("a",dt,[mt,t(a)])]),n("p",null,[gt,n("a",ht,[yt,t(a)])]),_t])}var xt=o(u,[["render",bt],["__file","Python.html.vue"]]);export{xt as default};
